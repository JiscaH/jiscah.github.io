<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • sequoia</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo_s.png"><meta property="og:image:alt" content="sequoia hexlogo"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@HuismanJisca"><meta name="twitter:site" content="@HuismanJisca"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.8.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href=".././index.html">
    <span class="fas fa fas fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/sequoia.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_main/book/background.html">Main vignette: User guide</a>
    <a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a>
    <a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a>
    <a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a>
    <a class="dropdown-item" href="../articles/performance_stats.html">Performance Stats</a>
    <a class="dropdown-item" href="../reference/figures/Poster_sequoia_ESEB2017.pdf">poster</a>
    <a class="dropdown-item" href="../reference/figures/Slideshow_sequoia_background.pdf">slideshow with background info</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../news/index.html">Change log</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-help">Help</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-help">
    <a class="dropdown-item" href="../articles/help.html">Need help?</a>
    <a class="dropdown-item" href="../articles/pedigree_consultancy.html">Consultancy</a>
    <a class="dropdown-item" href="../articles/want_to_help.html">Want to help?</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa fas fa-envelope"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JiscaH/sequoia">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca">
    <span class="fab fa fab fa-mastodon"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Changelog</h1>
      
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.8.3" id="sequoia-283">sequoia 2.8.3<a class="anchor" aria-label="anchor" href="#sequoia-283"></a></h2><p class="text-muted">CRAN release: 2023-12-19</p>
<ul><li>fixes bugs introduced since version 2.5, plus various other edits in source code to improve assignment rate</li>
<li>fix bug in <code>CalcMaxMismatch</code>: OH with both parents counts as 2 mismatches (was 1)</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.7.3" id="sequoia-273">sequoia 2.7.3<a class="anchor" aria-label="anchor" href="#sequoia-273"></a></h2>
<ul><li>fix bug causing some negative parental LLRs, and possibly some non-assignments</li>
<li>speed increase for lower call rates</li>
<li>add OutFormat ‘ped’ to <code>GenoConvert</code>, and fix bug with OutFormat ‘col’</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.7.2" id="sequoia-272">sequoia 2.7.2<a class="anchor" aria-label="anchor" href="#sequoia-272"></a></h2><p class="text-muted">CRAN release: 2023-09-06</p>
<ul><li>change <code>EstConf</code> example to nSim=1 to ensure runtime &lt; 5 sec to pass CRAN check</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.7.1" id="sequoia-271">sequoia 2.7.1<a class="anchor" aria-label="anchor" href="#sequoia-271"></a></h2>
<ul><li>add <code>mtSame</code>: specify if individuals have the same or different mitochondrial haplotype</li>
<li>improved parentage assignment performance when there are many genetically similar candidate parents</li>
<li>fixes CRAN issue ‘cannot use Fortran’s random number generator’</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.6.0" id="sequoia-260">sequoia 2.6.0<a class="anchor" aria-label="anchor" href="#sequoia-260"></a></h2>
<ul><li>add specification of assumed genotyping error rate via length 3 vector: hom|hom, het|hom, hom|het</li>
<li>expand <code>CalcPairLL</code> helpfile</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.5.6" id="sequoia-256">sequoia 2.5.6<a class="anchor" aria-label="anchor" href="#sequoia-256"></a></h2><p class="text-muted">CRAN release: 2023-04-22</p>
<ul><li>fixes CRAN pretest NOTES, including broken links in vignette</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.5.4" id="sequoia-254">sequoia 2.5.4<a class="anchor" aria-label="anchor" href="#sequoia-254"></a></h2>
<ul><li>add updated vignettes (main + age); accidentally included old versions in 2.5.3</li>
<li>fixed bug in <code>CalcBYprobs</code>, which caused Year.last to be ignored</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.5.3" id="sequoia-253">sequoia 2.5.3<a class="anchor" aria-label="anchor" href="#sequoia-253"></a></h2><p class="text-muted">CRAN release: 2023-03-21</p>
<ul><li>fixes CRAN error ‘DLL requires the use of native symbols’</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.5.1" id="sequoia-251">sequoia 2.5.1<a class="anchor" aria-label="anchor" href="#sequoia-251"></a></h2>
<div class="section level4">
<h4 id="bug-fixes--minor-changes-2-5-1">Bug fixes &amp; minor changes<a class="anchor" aria-label="anchor" href="#bug-fixes--minor-changes-2-5-1"></a></h4>
<ul><li>fix error ‘sibship number out of bounds’</li>
<li>fix error when <code>LifeHistData$Sex</code> includes <code>NA</code>
</li>
<li>fix several minor bugs affecting rare cases</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.5.0" id="sequoia-250">sequoia 2.5.0<a class="anchor" aria-label="anchor" href="#sequoia-250"></a></h2>
<div class="section level4">
<h4 id="new-features--major-changes-2-5-0">New features &amp; major changes<a class="anchor" aria-label="anchor" href="#new-features--major-changes-2-5-0"></a></h4>
<ul><li>improved performance when a large proportion of birth years is not exactly known</li>
<li>optional column <code>Year.last</code> added to <code>LifeHistData</code> (last possible offspring birth year)</li>
<li>New functions <code>GetAncestors</code> and <code>GetDescendants</code>
</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes--minor-changes-2-5-0">Bug fixes &amp; minor changes<a class="anchor" aria-label="anchor" href="#bug-fixes--minor-changes-2-5-0"></a></h4>
<ul><li>New parameter <code>MinAgeParent</code> for <code><a href="../reference/MakeAgePrior.html">MakeAgePrior()</a></code>
</li>
<li>New parameter <code>StrictGenoCheck</code>, <code>Strict</code> for <code><a href="../reference/CheckGeno.html">CheckGeno()</a></code> ; update msgs</li>
<li>update <code>CheckLH</code>, now flexible column order in LifeHistData.</li>
<li>changed maxmismatch from <code>qntl = 0.999^(1/nrow(GenoM))</code> to <code>0.9999^(1/nrow(GenoM))</code> in all functions calling <code>CalcMaxMismatch</code>
</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.4.2" id="sequoia-242">sequoia 2.4.2<a class="anchor" aria-label="anchor" href="#sequoia-242"></a></h2>
<div class="section level4">
<h4 id="bug-fixes--minor-changes-2-4-2">Bug fixes &amp; minor changes<a class="anchor" aria-label="anchor" href="#bug-fixes--minor-changes-2-4-2"></a></h4>
<ul><li>checks up to 6 generations back when making assignment to avoid individual being its own ancestor (was 5)</li>
<li>fix bug in <code><a href="../reference/SnpStats.html">SnpStats()</a></code> when AF=0 or SNP is missing for all individuals.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.4.1" id="sequoia-241">sequoia 2.4.1<a class="anchor" aria-label="anchor" href="#sequoia-241"></a></h2><p class="text-muted">CRAN release: 2023-01-08</p>
<div class="section level4">
<h4 id="new-features--major-changes-2-4-1">New features &amp; major changes<a class="anchor" aria-label="anchor" href="#new-features--major-changes-2-4-1"></a></h4>
<ul><li>R markdown file to create (or serve as a first draft of) a summary report of input and output, called via <code>sequoia_report()</code>
</li>
<li>
<code><a href="../reference/PedCompare.html">PedCompare()</a></code> parameter <code>minSibSize</code> (minimum sibship size for which the non-genotyped parent is considered ‘dummyfiable’) changed default value from <code>2sib</code> (2 genotyped siblings) to <code>1sib1GP</code>. This reflects the increased success of reconstructing grandoffspring-grandparent pairs in newest version, which make the output of <code>PedCompare(,minSibSize='2sib')</code> confusing. This also affects <code><a href="../reference/EstConf.html">EstConf()</a></code>.</li>
<li>
<code><a href="../reference/GetRelM.html">GetRelM()</a></code> now allows input of Pedigree AND Pairs. This a.o. allows <code><a href="../reference/PlotRelPairs.html">PlotRelPairs()</a></code> with both inferred pedigree plus <code><a href="../reference/GetMaybeRel.html">GetMaybeRel()</a></code> output.</li>
</ul></div>
<div class="section level4">
<h4 id="minor-changes-2-4-1">Minor changes<a class="anchor" aria-label="anchor" href="#minor-changes-2-4-1"></a></h4>
<ul><li>switch from library xlsx to openxlsx in <code><a href="../reference/writeSeq.html">writeSeq()</a></code> (easier to install)</li>
<li>adds purl=FALSE to vignette chunks &amp; include <code>SeqOUT_HSg5</code> for quicker vignette compilation</li>
<li>include additional griffin example data: <code>Geno_griffin</code>, <code>Conf_griffin</code> (output from <code><a href="../reference/EstConf.html">EstConf()</a></code>) and <code>MaybeRel_griffin</code> (output from <code><a href="../reference/GetMaybeRel.html">GetMaybeRel()</a></code>), as well as the script used to create these (<code>mk_griffin_data.R</code>)</li>
<li>many examples are rewritten, for clarification &amp; to speed up package check</li>
<li>the plotting function of <code><a href="../reference/SummarySeq.html">SummarySeq()</a></code> was internal and is now exported (<code><a href="../reference/PlotSeqSum.html">PlotSeqSum()</a></code>)</li>
<li>output from <code><a href="../reference/sequoia.html">sequoia()</a></code> now includes <code>args.AP</code>.</li>
<li>in <code><a href="../reference/SummarySeq.html">SummarySeq()</a></code>, if <code>Pedigree</code> is provided rather than <code>SeqList</code> and <code>SNPd=NULL</code>, all individuals are categorised as <code>Observed</code> (was: <code>Genotyped</code>).</li>
<li>
<code><a href="../reference/PedPolish.html">PedPolish()</a></code> now has arguments to specify whether to drop extra columns (besides id-dam-sire) and whether to keep rows with non-unique or NA ids.</li>
<li>
<code><a href="../reference/SnpStats.html">SnpStats()</a></code> now includes HWE tests</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-2-4-1">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-4-1"></a></h4>
<ul><li>fixes several memory issues identified by CRAN</li>
<li>fixes various bugs in <code><a href="../reference/SimGeno.html">SimGeno()</a></code> for non-autosomal inheritance; this option is still experimental and non-autosomal SNPs are not supported by the pedigree reconstruction.</li>
<li>fixes <code>cannot allocate vector of size ...</code> issue in <code><a href="../reference/GetRelM.html">GetRelM()</a></code> with very large pedigrees, which affected <code><a href="../reference/MakeAgePrior.html">MakeAgePrior()</a></code> and thereby <code><a href="../reference/sequoia.html">sequoia()</a></code>.</li>
<li>
<code><a href="../reference/EstConf.html">EstConf()</a></code> <code>$ConfProb</code> used the wrong denominator, namely the number of parents in the reference pedigree rather than in the inferred pedigree.</li>
<li>fixes bug resulting in LL(FA)=777 (‘impossible’) for pairs with all 4 parents unknown. Likely only affected <code><a href="../reference/CalcPairLL.html">CalcPairLL()</a></code>, as LL(HS)=LL(GP)=LL(FA) for these pairs. Origin time unknown.</li>
<li>fixes bug in <code><a href="../reference/GenoConvert.html">GenoConvert()</a></code> when <code>Informat='single'</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.3.5" id="sequoia-235">sequoia 2.3.5<a class="anchor" aria-label="anchor" href="#sequoia-235"></a></h2><p class="text-muted">CRAN release: 2021-05-22</p>
<ul><li>fixes bug: OH count was always zero when there was no co-parent</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.3.4" id="sequoia-234">sequoia 2.3.4<a class="anchor" aria-label="anchor" href="#sequoia-234"></a></h2><p class="text-muted">CRAN release: 2021-05-15</p>
<ul><li>fixes bug in <code><a href="../reference/CalcPairLL.html">CalcPairLL()</a></code> HS likelihood when conditioning on pedigree was incorrect. No/minimal effect on pedigree reconstruction.</li>
<li>fixes bug in <code><a href="../reference/DuplicateCheck.html">DuplicateCheck()</a></code> (always automatically called by <code><a href="../reference/sequoia.html">sequoia()</a></code>) that on very rare occasions caused R to crash</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.3.3" id="sequoia-233">sequoia 2.3.3<a class="anchor" aria-label="anchor" href="#sequoia-233"></a></h2><p class="text-muted">CRAN release: 2021-05-02</p>
<p>fixes minor bugs identified by CRAN valgrind and gcc-ASAN</p>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.3.2" id="sequoia-232">sequoia 2.3.2<a class="anchor" aria-label="anchor" href="#sequoia-232"></a></h2><p class="text-muted">CRAN release: 2021-04-29</p>
<p>minor edits to vignette to comply with CRAN precheck</p>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.3.1" id="sequoia-231">sequoia 2.3.1<a class="anchor" aria-label="anchor" href="#sequoia-231"></a></h2>
<div class="section level4">
<h4 id="new-features--major-changes-2-3-1">New features &amp; major changes<a class="anchor" aria-label="anchor" href="#new-features--major-changes-2-3-1"></a></h4>
<ul><li>Hermaphrodites: dummy individuals with offspring as both dam and as sire now have prefix ‘H’; closer links between the two ‘clonal’ sibship parts during pedigree reconstruction for improved performance</li>
<li>Assignment of sibship grandparents moved to before check &amp; assignment of additional parents; this proved to increase correct assignments without increasing incorrect assignments.</li>
<li>new function <code><a href="../reference/CalcBYprobs.html">CalcBYprobs()</a></code> to estimate the probability that individual i is born in year y.</li>
</ul></div>
<div class="section level4">
<h4 id="minor-changes-2-3-1">Minor changes<a class="anchor" aria-label="anchor" href="#minor-changes-2-3-1"></a></h4>
<ul><li>various edits to Fortran code improving general performance.</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-2-3-1">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-3-1"></a></h4>
<ul><li>fixed inconsistent rounding in <code><a href="../reference/EstConf.html">EstConf()</a></code> output</li>
<li>bug in <code><a href="../reference/GenoConvert.html">GenoConvert()</a></code> regarding InData vs InFile</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.3.0" id="sequoia-230">sequoia 2.3.0<a class="anchor" aria-label="anchor" href="#sequoia-230"></a></h2>
<div class="section level4">
<h4 id="major-bug-fixes-2-3-0">Major bug fixes<a class="anchor" aria-label="anchor" href="#major-bug-fixes-2-3-0"></a></h4>
<ul><li>now possible to run with assumed genotyping error rate <code>Err=0</code>
</li>
<li>further improvements when a large proportion of birth years are missing</li>
<li>various bugs related to hermaphrodites</li>
</ul></div>
<div class="section level4">
<h4 id="reduced-computational-time-2-3-0">Reduced computational time<a class="anchor" aria-label="anchor" href="#reduced-computational-time-2-3-0"></a></h4>
<ul><li>Sibship clustering etc. now done from oldest to youngest individual instead of in order of occurrence in genotype file, giving quicker convergence to final high likelihood pedigree.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.2.2" id="sequoia-222">sequoia 2.2.2<a class="anchor" aria-label="anchor" href="#sequoia-222"></a></h2>
<div class="section level4">
<h4 id="new-features--major-changes-2-2-2">New features &amp; major changes<a class="anchor" aria-label="anchor" href="#new-features--major-changes-2-2-2"></a></h4>
<ul><li>hermaphrodites: re-implemented and greatly improved sibship clustering. Specification of hermaphrodite vs diocious is now separate input parameter <code>Herm</code> instead of specified via <code>Complex</code>. New output list element <code>DummyClones</code>
</li>
<li>improved performance when a large proportion of birth years are missing</li>
<li>new function <code><a href="../reference/CalcRped.html">CalcRped()</a></code> to calculate pedigree relatedness. Uses package <code>kinship2</code>.</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-2-2-2">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-2-2"></a></h4>
<p>Various smaller bugs have been fixed, some affecting assignment rate</p>
</div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.1.0" id="sequoia-210">sequoia 2.1.0<a class="anchor" aria-label="anchor" href="#sequoia-210"></a></h2>
<div class="section level4">
<h4 id="new-features--major-changes-2-1-0">New features &amp; major changes<a class="anchor" aria-label="anchor" href="#new-features--major-changes-2-1-0"></a></h4>
<ul><li>parameter ‘maxSibIter’ (-9/-1/0/&gt;0) deprecated and replaced by ‘Module’ (pre/dup/par/ped).</li>
<li>
<code><a href="../reference/sequoia.html">sequoia()</a></code>: Option <code>FindMaybeRel</code> has been deprecated; call <code><a href="../reference/GetMaybeRel.html">GetMaybeRel()</a></code> directly instead.</li>
<li>new function <code><a href="../reference/CalcPairLL.html">CalcPairLL()</a></code>, returns likelihoods for each of the 7 considered relationships (PO, FS, HS, GP, FA, HA, U) for each specified pair of individuals</li>
<li>new function <code>RelPlot()</code> for Colony-like visualisation of pairwise relationships (automatically called by <code><a href="../reference/ComparePairs.html">ComparePairs()</a></code>)</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-2-1-0">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-1-0"></a></h4>
<ul><li>
<code><a href="../reference/sequoia.html">sequoia()</a></code>: fixed error <code>object 'ErrM' not found</code> when re-using output from a previous sequoia run. Circumvent this bug in version 2.0.7 by fooling the program to think it’s output from an older version: <code>names(ParOUT$Specs)[match("MaxMismatchOH", names(ParOUT$Specs))] &lt;- "foo"</code>.</li>
<li>
<code><a href="../reference/sequoia.html">sequoia()</a></code>: fixed bug causing genotyped parents to not always be monogamous when <code>Complx='mono'</code>.</li>
<li>various functions: fixed error when dummy prefixes have different number of characters (<code>Error in data.frame(id = c(dID[s(nd[1]), 1], dID[s(nd[2]), 2]), VtoM(TMP$dumparrf,  : arguments imply differing number of rows)</code> )</li>
<li>
<code><a href="../reference/GetMaybeRel.html">GetMaybeRel()</a></code>: fixed error <code>(subscript) logical subscript too long</code> when input pedigree contains dummies</li>
<li>
<code><a href="../reference/GetMaybeRel.html">GetMaybeRel()</a></code>: fixed error causing likely GP pairs not to be included output</li>
<li>
<code><a href="../reference/PedCompare.html">PedCompare()</a></code>: fixed id.dam.cat and id.sire.cat being ‘NANA’ instead of XD, XG or XX when Symmetrical=TRUE</li>
<li>
<code><a href="../reference/PlotAgePrior.html">PlotAgePrior()</a></code>: Avoid using <code><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">grDevices::hcl.colors()</a></code> in R versions &lt;3.6, where this function is not yet available</li>
<li>
<code><a href="../reference/ComparePairs.html">ComparePairs()</a></code>: fixed bug when <code>Pairs2</code> but not <code>Ped2</code> is specified</li>
<li>
<code><a href="../reference/MakeAgePrior.html">MakeAgePrior()</a></code>: fixed bug when there are no FS pairs in the input pedigree</li>
<li>
<code><a href="../reference/MakeAgePrior.html">MakeAgePrior()</a></code>: <code>MaxAgeParent</code> was ignored when a pedigree with overlapping generations was supplied</li>
</ul></div>
<div class="section level4">
<h4 id="minor-changes-2-1-0">Minor changes<a class="anchor" aria-label="anchor" href="#minor-changes-2-1-0"></a></h4>
<ul><li>most examples are now set to <code>\donttest</code> instead of <code>\dontrun</code>, so that they can be run using <code><a href="https://rdrr.io/r/utils/example.html" class="external-link">example()</a></code>. Note that some can be quite time consuming, especially <code><a href="../reference/EstConf.html">EstConf()</a></code>.</li>
<li>new function <code><a href="../reference/PlotPedComp.html">PlotPedComp()</a></code> to visualise <code><a href="../reference/PedCompare.html">PedCompare()</a></code> output</li>
<li>
<code><a href="../reference/SimGeno.html">SimGeno()</a></code>: deprecated input parameters (since v 1.3.1) are dropped completely</li>
<li>
<code><a href="../reference/getAssignCat.html">getAssignCat()</a></code> no longer drops additional columns from input pedigree</li>
<li>Speed increase for <code>CalcOHLLR(, CalcLLR = FALSE)</code>
</li>
<li>More thorough input checks, which are more consistent across different functions</li>
<li>
<code><a href="../reference/PedCompare.html">PedCompare()</a></code> output element <code>DummyMatch</code> now also include output class of matched individual’s parents &amp; offspring</li>
<li>Duplicate check in <code><a href="../reference/sequoia.html">sequoia()</a></code> now only returns pairs for which LL_duplicate - max(LL_{not duplicate}) &gt; T_filter; when call rates are low this may be a substantially shorter list than in previous versions, where all pairs with fewer than MaxMismatchDUP differences were listed.</li>
<li>
<code><a href="../reference/ComparePairs.html">ComparePairs()</a></code> can now be called for a single pedigree, as well as to compare two pedigrees</li>
<li>If the plotting window in Rstudio is too small and <code>Plot=TRUE</code>, all functions will print a message and return results as usual, instead of throwing an error and not returning results.</li>
<li>
<code><a href="../reference/MakeAgePrior.html">MakeAgePrior()</a></code>: more consistent implementation; is now called by <code><a href="../reference/sequoia.html">sequoia()</a></code> with only lifehistory data of genotyped individuals.</li>
<li>
<code><a href="../reference/EstConf.html">EstConf()</a></code> now also returns the full <code>Counts</code> table from <code><a href="../reference/PedCompare.html">PedCompare()</a></code>; <code>$RunParams</code> now holds the evaluated input paramters, instead of e.g. <code>V[i]</code> when called from inside a loop.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.0.7" id="sequoia-207">sequoia 2.0.7<a class="anchor" aria-label="anchor" href="#sequoia-207"></a></h2><p class="text-muted">CRAN release: 2020-05-18</p>
<div class="section level4">
<h4 id="new-features-2-0-7">New features<a class="anchor" aria-label="anchor" href="#new-features-2-0-7"></a></h4>
<ul><li>The genotyping error matrix (probability of observed genotype conditional on actual) is now fully customisable in all relevant functions, see help file of new function <code>ErrToM</code>. The default has changed very slightly from version 1.3.</li>
<li>new function <code><a href="../reference/CalcOHLLR.html">CalcOHLLR()</a></code> to calculate Mendelian errors and parental log-likelihood ratios for any pedigree</li>
<li>new function <code>getAssignable()</code> to flag genotyped and ‘dummifiable’ individuals in any pedigree</li>
<li>new function <code><a href="../reference/ComparePairs.html">ComparePairs()</a></code> to compare pairwise relationships between 2 pedigrees; replaces now-deprecated <code>DyadCompare</code>.</li>
<li>function <code><a href="../reference/PedPolish.html">PedPolish()</a></code> is now user available.</li>
</ul></div>
<div class="section level4">
<h4 id="major-changes-2-0-7">Major changes<a class="anchor" aria-label="anchor" href="#major-changes-2-0-7"></a></h4>
<ul><li>Deprecated option <code>MaxMismatch</code> of function <code>sequoia</code>, now calculated internally by new function <code>CalcMaxMismatch</code> based on number of SNPs, presumed genotyping error rate, and minor allele frequencies</li>
<li>function <code><a href="../reference/EstConf.html">EstConf()</a></code> now also estimates confidence for parent-pairs; output has changed considerably.</li>
<li>rewrote function <code><a href="../reference/PedCompare.html">PedCompare()</a></code> to increase clarity of code for easier maintenance; changed output format somewhat.</li>
<li>Added a vignette about the ageprior, and rewrote sections of the main vignette to incorporate new functions</li>
<li>In the Fortran part, re-implemented how (candidate) (grand)parent-pairs are filtered and assigned</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-2-0-7">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-2-0-7"></a></h4>
<ul><li>
<code><a href="../reference/GenoConvert.html">GenoConvert()</a></code> skipped first individual when reading .raw file. Circumvent this bug in earlier versions by using option <code>header=FALSE</code> (then header row is removed only once…)</li>
<li>
<code>ConfProb()</code> expected input parameter <code>nSim</code> to be strictly integer, now relaxed to any value convertible to a whole number</li>
<li>fixed <code>ERROR! ***Invalid ParProb!***</code> triggered when some SNPs are monomorphic</li>
<li>fixed <code>SEGFAULT</code> triggered when some SNPs have very high missingness (&gt;80%); possibly sibship size out of bounds</li>
<li>fixed <code>Error arguments imply differing number of rows</code> when there are dummy parents of 1 sex only</li>
<li>fixed various mostly minor bugs in the Fortran code</li>
<li>fixed bugs regarding ‘link time optimisation’</li>
</ul></div>
<div class="section level4">
<h4 id="minor-changes-2-0-7">Minor changes<a class="anchor" aria-label="anchor" href="#minor-changes-2-0-7"></a></h4>
<ul><li>
<code>LifeHistData</code> may have 2 additional columns, with minimum and maximum possible birth year</li>
<li>second example pedigree (<code>Ped_griffin</code>) to illustrate overlapping generations, used in age vignette</li>
<li>
<code><a href="../reference/SummarySeq.html">SummarySeq()</a></code>: added a pedigree summary table identical to a subset of the table returned by R package <code>pedantics</code>’ <code>pedStatSummary</code>; that package has been archived on CRAN. Added option <code>Panels</code> to only plot (a) specific panel(s).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.3.3" id="sequoia-133">Sequoia 1.3.3<a class="anchor" aria-label="anchor" href="#sequoia-133"></a></h2><p class="text-muted">CRAN release: 2019-06-20</p>
<div class="section level4">
<h4 id="bug-fixes-1-3-3">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-3-3"></a></h4>
<ul><li>fixes bug that caused R to crash (Fortran array indexing out-of-bounds)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.3.1" id="sequoia-131">Sequoia 1.3.1<a class="anchor" aria-label="anchor" href="#sequoia-131"></a></h2><p class="text-muted">CRAN release: 2019-06-14</p>
<div class="section level4">
<h4 id="new-features-1-3-1">New features<a class="anchor" aria-label="anchor" href="#new-features-1-3-1"></a></h4>
<ul><li>several functions have become user-visible: <code><a href="../reference/CheckGeno.html">CheckGeno()</a></code>, <code><a href="../reference/MkGenoErrors.html">MkGenoErrors()</a></code>, <code><a href="../reference/GetMaybeRel.html">GetMaybeRel()</a></code>, <code>GetRelCat()</code>
</li>
<li>plotting functions added: <code><a href="../reference/PlotAgePrior.html">PlotAgePrior()</a></code> and <code><a href="../reference/SummarySeq.html">SummarySeq()</a></code>
</li>
<li>function <code><a href="../reference/SimGeno.html">SimGeno()</a></code> input parameters have changed, old ones will be deprecated</li>
</ul></div>
<div class="section level4">
<h4 id="minor-changes-1-3-1">Minor changes<a class="anchor" aria-label="anchor" href="#minor-changes-1-3-1"></a></h4>
<ul><li>extended vignette with function overview &amp; FAQ</li>
<li>numerous edits to fortran source code to better handle certain (rarer) types of relatives</li>
</ul></div>
<div class="section level4">
<h4 id="bug-fixes-1-3-1">Bug fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-3-1"></a></h4>
<ul><li>various bug fixes in fortran source code</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.1.1" id="sequoia-111">sequoia 1.1.1<a class="anchor" aria-label="anchor" href="#sequoia-111"></a></h2><p class="text-muted">CRAN release: 2018-08-13</p>
<div class="section level4">
<h4 id="major-changes-1-1-1">Major changes<a class="anchor" aria-label="anchor" href="#major-changes-1-1-1"></a></h4>
<ul><li>possibly.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.0.0" id="sequoia-100">sequoia 1.0.0<a class="anchor" aria-label="anchor" href="#sequoia-100"></a></h2><p class="text-muted">CRAN release: 2018-03-29</p>
<div class="section level4">
<h4 id="new-features-1-0-0">New features<a class="anchor" aria-label="anchor" href="#new-features-1-0-0"></a></h4>
<ul><li>added functions <code>EstConf</code>, <code>SnpStats</code>
</li>
</ul></div>
<div class="section level4">
<h4 id="major-changes-1-0-0">Major changes<a class="anchor" aria-label="anchor" href="#major-changes-1-0-0"></a></h4>
<ul><li>considerable changes in Fortran code</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.9.2" id="sequoia-092">sequoia 0.9.2<a class="anchor" aria-label="anchor" href="#sequoia-092"></a></h2><p class="text-muted">CRAN release: 2017-07-17</p>
<div class="section level4">
<h4 id="new-features-0-9-2">New features<a class="anchor" aria-label="anchor" href="#new-features-0-9-2"></a></h4>
<ul><li>added functionality for hermaphrodites (in silico cloned into male + female)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7.2" id="sequoia-072">sequoia 0.7.2<a class="anchor" aria-label="anchor" href="#sequoia-072"></a></h2><p class="text-muted">CRAN release: 2017-02-13</p>
<p>First version on CRAN!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

