<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Matrix with Pairwise Relationships — GetRelM • sequoia</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Matrix with Pairwise Relationships — GetRelM"><meta name="description" content="Generate a matrix or 3D array with all pairwise relationships
  from a pedigree or dataframe with pairs."><meta property="og:description" content="Generate a matrix or 3D array with all pairwise relationships
  from a pedigree or dataframe with pairs."><meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo.png"><meta property="og:image:alt" content="sequoia hexlogo"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@HuismanJisca"><meta name="twitter:site" content="@HuismanJisca"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href=".././index.html" aria-label="home"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/sequoia.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_main/book/background.html">Main vignette: User guide</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a></li>
    <li><a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a></li>
    <li><a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/performance_stats.html">Performance Stats</a></li>
    <li><a class="dropdown-item" href="../reference/figures/Poster_sequoia_ESEB2017.pdf">poster</a></li>
    <li><a class="dropdown-item" href="../reference/figures/Slideshow_sequoia_background.pdf">slideshow with background info</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change log</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help"><li><a class="dropdown-item" href="../articles/help.html">Need help?</a></li>
    <li><a class="dropdown-item" href="../articles/want_to_help.html">Want to help?</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../mailto:jisca.huisman@gmail.com" aria-label="email"><span class="fa fas fa-envelope"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JiscaH/sequoia" aria-label="github"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca" aria-label="mastodon"><span class="fa fab fa-mastodon"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/" aria-label="linkedin"><span class="fa fab fa-linkedin-in"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Matrix with Pairwise Relationships</h1>

      <div class="d-none name"><code>GetRelM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate a matrix or 3D array with all pairwise relationships
  from a pedigree or dataframe with pairs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GetRelM</span><span class="op">(</span></span>
<span>  Pedigree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Pairs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  GenBack <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  patmat <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  directed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Return <span class="op">=</span> <span class="st">"Matrix"</span>,</span>
<span>  Pairs_suffix <span class="op">=</span> <span class="st">"?"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pedigree">Pedigree<a class="anchor" aria-label="anchor" href="#arg-pedigree"></a></dt>
<dd><p>dataframe with columns id - dam - sire.</p></dd>


<dt id="arg-pairs">Pairs<a class="anchor" aria-label="anchor" href="#arg-pairs"></a></dt>
<dd><p>dataframe with columns ID1 - ID2 - Rel, e.g. as returned by
<code><a href="GetMaybeRel.html">GetMaybeRel</a></code>. Combining <code>Pedigree</code> and <code>Pairs</code> works
best if the relationships are coded as listed below.</p></dd>


<dt id="arg-genback">GenBack<a class="anchor" aria-label="anchor" href="#arg-genback"></a></dt>
<dd><p>number of generations back to consider; 1 returns
parent-offspring and sibling relationships, 2 also returns grand-parental,
avuncular and first cousins.</p></dd>


<dt id="arg-patmat">patmat<a class="anchor" aria-label="anchor" href="#arg-patmat"></a></dt>
<dd><p>logical, distinguish between paternal versus maternal relative
pairs? For avuncular pairs, the distinction is never made.</p></dd>


<dt id="arg-directed">directed<a class="anchor" aria-label="anchor" href="#arg-directed"></a></dt>
<dd><p>logical, distinguish between e.g. ID1=offspring, ID2=mother
('M') and ID1=mother, ID2=offspring ('O')? Defaults to TRUE; if FALSE both
are are scored as 'PO', as are father-offspring pairs, and all
grandparent– grand-offspring pairs are scored as 'GPO', and avuncular
pairs as 'FNA' and 'HNA'. Not (currently) compatible with <code>patmat</code>.
When <code>Return</code>='List', each pair is included twice (as ID1-ID2 &amp;
ID2-ID1)</p></dd>


<dt id="arg-return">Return<a class="anchor" aria-label="anchor" href="#arg-return"></a></dt>
<dd><p>'Matrix', 'Array', or 'List'. 'Matrix' returns an N x N matrix
with the closest relationship between each pair. 'Array' returns an N x N x
R array with for each of the R considered relationships whether it exists
between the pair (1) or not (0). See Details below. 'List' returns a list
with for each of the R considered relationships a 2-column matrix with the
IDs of the pairs having such a relationship. The size of the list (in Mb)
is much smaller than for the matrix or array, and this is therefore the
only format suitable for pedigrees with many thousands of individuals. If
<code>Pairs</code> is specified, the only possible return type is 'Matrix'.</p></dd>


<dt id="arg-pairs-suffix">Pairs_suffix<a class="anchor" aria-label="anchor" href="#arg-pairs-suffix"></a></dt>
<dd><p>symbol added to the relationship abbreviations derived
from <code>Pairs</code>, when both <code>Pedigree</code> and <code>Pairs</code> are provided.
Can be an empty string.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>Return='Matrix'</code>, an N x N square matrix, with N equal to
  the number of rows in <code>Pedigree</code> (after running
  <code><a href="PedPolish.html">PedPolish</a></code>) or the number of unique individuals in
  <code>Pairs</code>. If <code>Return='Array'</code>, an N x N x R array is returned,
  with R, the number of different relationships, determined by <code>GenBack</code>
  and <code>patmat</code>.</p>
<p>The following abbreviations are used within the returned <code>Matrix</code>, or
 as names of the 3rd dimension in the <code>Array</code> or of the <code>List</code>:</p>
<dl><dt>S</dt>
<dd><p>Self</p></dd>

   <dt>M</dt>
<dd><p>Mother</p></dd>

   <dt>P</dt>
<dd><p>Father</p></dd>

   <dt>MP</dt>
<dd><p>Mother or Father (<code>patmat=FALSE</code>)</p></dd>

   <dt>O</dt>
<dd><p>Offspring</p></dd>

   <dt>FS</dt>
<dd><p>Full sibling</p></dd>

   <dt>MHS</dt>
<dd><p>Maternal half-sibling</p></dd>

   <dt>PHS</dt>
<dd><p>Paternal half-sibling</p></dd>

   <dt>XHS</dt>
<dd><p>other half-sibling (hermaphrodites)</p></dd>

   <dt>HS</dt>
<dd><p>half-sibling (<code>patmat=FALSE</code>)</p></dd>

   <dt>MGM</dt>
<dd><p>Maternal grandmother</p></dd>

   <dt>MGF</dt>
<dd><p>Maternal grandfather</p></dd>

   <dt>PGM</dt>
<dd><p>Paternal grandmother</p></dd>

   <dt>PGF</dt>
<dd><p>Paternal grandfather</p></dd>

   <dt>GP</dt>
<dd><p>Grandparent (<code>patmat=FALSE</code>)</p></dd>

   <dt>GO</dt>
<dd><p>Grand-offspring</p></dd>

   <dt>FA</dt>
<dd><p>Full avuncular; maternal or paternal aunt or uncle.</p></dd>

   <dt>FN</dt>
<dd><p>Full nephew/niece</p></dd>

   <dt>HA</dt>
<dd><p>Half avuncular</p></dd>

   <dt>HN</dt>
<dd><p>Half nephew/niece</p></dd>

   <dt>DFC1</dt>
<dd><p>Double full first cousin</p></dd>

   <dt>FC1</dt>
<dd><p>Full first cousin</p></dd>

   <dt>U</dt>
<dd><p>Unrelated (or otherwise related)</p></dd>

   <dt>X</dt>
<dd><p>Unknown, e.g. when only <code>Pairs</code> is provided and does not
     include this pair</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Double relationships are ignored when <code>Return='Matrix'</code>, but
  not when <code>Return='Array'</code>. For example, when A and B are both
  mother-offspring and paternal siblings (A mated with her father to produce
  B), only the mother-offspring relationship will be indicated when
  <code>Return='Matrix'</code>.</p>
<p>Note that full siblings are the exception to this rule: in the <code>Array</code>
  they will be indicated as 'FS' only, and not as 'MHS' or 'PHS'. Similarly,
  full avuncular pairs are not indicated as 'HA'. Double half-avuncular
  relationships are indicated as both FA and HA.</p>
<p>When <code>Pairs</code> is provided, <code>GenBack</code> and <code>patmat</code> are
  ignored, and no check is performed if the abbreviations are compatible with
  other functions.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ComparePairs.html">ComparePairs</a></code> for comparing pairwise relationships
  between two pedigrees; <code><a href="PlotRelPairs.html">PlotRelPairs</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">Rel.griffin</span> <span class="op">&lt;-</span> <span class="fu">GetRelM</span><span class="op">(</span><span class="va">Ped_griffin</span>, directed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># few categories</span></span></span>
<span class="r-in"><span><span class="va">Rel.griffin</span> <span class="op">&lt;-</span> <span class="fu">GetRelM</span><span class="op">(</span><span class="va">Ped_griffin</span>, patmat<span class="op">=</span><span class="cn">TRUE</span>, GenBack<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  <span class="co"># many cat.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Rel.griffin</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    FA   FC1    FN    FS    GO    HA    HN     M   MGF   MGM   MHS     O     P </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    45     6    45    10   511   957   953   167   132   138   422   330   163 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PGF   PGM   PHS     S     U </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   120   121   308   200 35372 </span>
<span class="r-in"><span><span class="co"># turning matrix into vector first makes table() much faster</span></span></span>
<span class="r-in"><span><span class="fu"><a href="PlotRelPairs.html">PlotRelPairs</a></span><span class="op">(</span><span class="va">Rel.griffin</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="GetRelM-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

