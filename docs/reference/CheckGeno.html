<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Check Genotype Matrix — CheckGeno • sequoia</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Check Genotype Matrix — CheckGeno" />
<meta property="og:description" content="Check that the provided genotype matrix is in the correct
  format, and check for low call rate samples and SNPs." />
<meta property="og:image" content="/reference/figures/sequoia_hexlogo_s.png" />
<meta property="og:image:alt" content="sequoia hexlogo" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sequoia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href=".././index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_main/book/sec-Background.html">Main vignette: User guide</a>
    </li>
    <li>
      <a href="../articles/vignette_age/book/index.html">Age prior vignette</a>
    </li>
    <li>
      <a href="../articles/index.html">Examples</a>
    </li>
    <li>
      <a href="../articles/index.html">More info on ...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a href="../articles/help.html">Help</a>
</li>
<li>
  <a href="../articles/performance_stats.html">Stats</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/HuismanJisca">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/JiscaH/sequoia">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Check Genotype Matrix</h1>
    
    <div class="hidden name"><code>CheckGeno.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Check that the provided genotype matrix is in the correct
  format, and check for low call rate samples and SNPs.</p>
    </div>

    <pre class="usage"><span class='fu'>CheckGeno</span><span class='op'>(</span>
  <span class='va'>GenoM</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  Plot <span class='op'>=</span> <span class='cn'>FALSE</span>,
  Return <span class='op'>=</span> <span class='st'>"GenoM"</span>,
  DumPrefix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"F0"</span>, <span class='st'>"M0"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>GenoM</th>
      <td><p>the genotype matrix.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>suppress messages.</p></td>
    </tr>
    <tr>
      <th>Plot</th>
      <td><p>display the plots of <code><a href='SnpStats.html'>SnpStats</a></code>.</p></td>
    </tr>
    <tr>
      <th>Return</th>
      <td><p>either 'GenoM' to return the cleaned-up genotype matrix, or
'excl' to return a list with excluded SNPs and individuals (see Value).</p></td>
    </tr>
    <tr>
      <th>DumPrefix</th>
      <td><p>length 2 vector, to check if these don't occur among
genotyped individuals.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>Return='excl'</code> a list with, if any are found:</p>
<dt>ExcludedSNPs</dt><dd><p>SNPs scored for &lt;10<!-- % of individuals; automatically -->
   excluded when running <code><a href='sequoia.html'>sequoia</a></code></p></dd>
 <dt>ExcludedSnps-mono</dt><dd><p>monomorphic (fixed) SNPs; automatically excluded
   when running <code><a href='sequoia.html'>sequoia</a></code>. This includes nearly-fixed SNPs with
   MAF \(= 1/2N\). Column numbers are *after* removal of
   <code>ExcludedSNPs</code>, if any.</p></dd>
 <dt>ExcludedIndiv</dt><dd><p>Individuals scored for &lt;5<!-- % of SNPs; these cannot be -->
   reliably included during pedigree reconstruction. Individual call rate is
   calculated after removal of 'Excluded SNPs'</p></dd>
 <dt>Snps-LowCallRate</dt><dd><p>SNPs scored for 10<!-- % -- 50% of individuals; strongly -->
   recommended to be filtered out</p></dd>
 <dt>Indiv-LowCallRate</dt><dd><p>individuals scored for &lt;50<!-- % of SNPs; strongly -->
   recommended to be filtered out</p></dd>

When Return='excl' the return is <a href='https://rdrr.io/r/base/invisible.html'>invisible</a>, i.e. a check
is run and warnings or errors are always displayed, but nothing may be
returned.

    <h2 class="hasAnchor" id="thresholds"><a class="anchor" href="#thresholds"></a>Thresholds</h2>

    <p>Appropriate call rate thresholds for SNPs and
  individuals depend on the total number of SNPs, distribution of call rates,
  genotyping errors, and the proportion of candidate parents that are SNPd
  (sibship clustering is more prone to false positives). Note that filtering
  first on SNP call rate tends to keep more individuals in.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='SnpStats.html'>SnpStats</a></code> to calculate SNP call rates;
  <code><a href='CalcOHLLR.html'>CalcOHLLR</a></code> to count the number of SNPs scored in both focal
  individual and parent.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Ped_HSg5</span><span class='op'>)</span>
<span class='va'>GenoM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SimGeno.html'>SimGeno</a></span><span class='op'>(</span><span class='va'>Ped_HSg5</span>, nSnp<span class='op'>=</span><span class='fl'>400</span>, CallRate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>400</span>, <span class='fl'>0.2</span>, <span class='fl'>0.8</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># quick alternative:</span>
<span class='va'>GenoM.checked</span> <span class='op'>&lt;-</span> <span class='fu'>CheckGeno</span><span class='op'>(</span><span class='va'>GenoM</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning:  There are 198 SNPs scored for &lt;50% of individuals, it is strongly </span>
#&gt; <span class='warning'> advised to exclude those </span></div><div class='output co'>#&gt; <span class='warning'>Warning:  There are 425 individuals scored for &lt;50% of SNPs, it is strongly </span>
#&gt; <span class='warning'> advised to exclude those </span></div><div class='output co'>#&gt; <span class='message'>There are  920  individuals and  400  SNPs.</span></div><div class='input'>
<span class='co'># user supervised alternative:</span>
<span class='va'>Excl</span> <span class='op'>&lt;-</span> <span class='fu'>CheckGeno</span><span class='op'>(</span><span class='va'>GenoM</span>, Return <span class='op'>=</span> <span class='st'>"excl"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning:  There are 198 SNPs scored for &lt;50% of individuals, it is strongly </span>
#&gt; <span class='warning'> advised to exclude those </span></div><div class='output co'>#&gt; <span class='warning'>Warning:  There are 425 individuals scored for &lt;50% of SNPs, it is strongly </span>
#&gt; <span class='warning'> advised to exclude those </span></div><div class='output co'>#&gt; <span class='message'>There are  920  individuals and  400  SNPs.</span></div><div class='input'><span class='va'>GenoM.orig</span> <span class='op'>&lt;-</span> <span class='va'>GenoM</span>   <span class='co'># make a 'backup' copy</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='st'>"ExcludedSnps"</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>Excl</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>GenoM</span> <span class='op'>&lt;-</span> <span class='va'>GenoM</span><span class='op'>[</span>, <span class='op'>-</span><span class='va'>Excl</span><span class='op'>[[</span><span class='st'>"ExcludedSnps"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>]</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='st'>"ExcludedInd"</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>Excl</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>GenoM</span> <span class='op'>&lt;-</span> <span class='va'>GenoM</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>GenoM</span><span class='op'>)</span> <span class='op'>%in%</span> <span class='va'>Excl</span><span class='op'>[[</span><span class='st'>"ExcludedInd"</span><span class='op'>]</span><span class='op'>]</span>, <span class='op'>]</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='st'>"ExcludedIndiv"</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>Excl</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>GenoM</span> <span class='op'>&lt;-</span> <span class='va'>GenoM</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>GenoM</span><span class='op'>)</span> <span class='op'>%in%</span> <span class='va'>Excl</span><span class='op'>[[</span><span class='st'>"ExcludedIndiv"</span><span class='op'>]</span><span class='op'>]</span>, <span class='op'>]</span>

<span class='co'># warning about  SNPs scored for &lt;50% of individuals ?</span>
<span class='va'>SnpCallRate</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>GenoM</span>, MARGIN<span class='op'>=</span><span class='fl'>2</span>,
                     FUN <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>!=</span><span class='op'>-</span><span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>GenoM</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>SnpCallRate</span>, breaks<span class='op'>=</span><span class='fl'>50</span>, col<span class='op'>=</span><span class='st'>"grey"</span><span class='op'>)</span>
</div><div class='img'><img src='CheckGeno-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>GenoM</span> <span class='op'>&lt;-</span> <span class='va'>GenoM</span><span class='op'>[</span>, <span class='va'>SnpCallRate</span> <span class='op'>&gt;</span> <span class='fl'>0.6</span><span class='op'>]</span>

<span class='co'># to be on the safe side, filter out low call rate individuals</span>
<span class='va'>IndivCallRate</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>GenoM</span>, MARGIN<span class='op'>=</span><span class='fl'>1</span>,
                       FUN <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>!=</span><span class='op'>-</span><span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>GenoM</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>IndivCallRate</span>, breaks<span class='op'>=</span><span class='fl'>50</span>, col<span class='op'>=</span><span class='st'>"grey"</span><span class='op'>)</span>
</div><div class='img'><img src='CheckGeno-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>GoodSamples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>GenoM</span><span class='op'>)</span><span class='op'>[</span> <span class='va'>IndivCallRate</span> <span class='op'>&gt;</span> <span class='fl'>0.8</span><span class='op'>]</span>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


