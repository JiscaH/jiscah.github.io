<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Birth year probabilities — CalcBYprobs • sequoia</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Birth year probabilities — CalcBYprobs"><meta name="description" content="Estimate the probability that an individual with unknown birth
  year is born in year y, based on BirthYears or BY.min
  and/or BY.max of its parents, offspring, and siblings, combined with
  AgePrior (the age distribution of other parent-offspring pairs),
  and/or Year.last of its parents."><meta property="og:description" content="Estimate the probability that an individual with unknown birth
  year is born in year y, based on BirthYears or BY.min
  and/or BY.max of its parents, offspring, and siblings, combined with
  AgePrior (the age distribution of other parent-offspring pairs),
  and/or Year.last of its parents."><meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo.png"><meta property="og:image:alt" content="sequoia hexlogo"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@HuismanJisca"><meta name="twitter:site" content="@HuismanJisca"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href=".././index.html" aria-label="home"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/sequoia.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_main/book/background.html">Main vignette: User guide</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a></li>
    <li><a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a></li>
    <li><a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/performance_stats.html">Performance Stats</a></li>
    <li><a class="dropdown-item" href="../reference/figures/Poster_sequoia_ESEB2017.pdf">poster</a></li>
    <li><a class="dropdown-item" href="../reference/figures/Slideshow_sequoia_background.pdf">slideshow with background info</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change log</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help"><li><a class="dropdown-item" href="../articles/help.html">Need help?</a></li>
    <li><a class="dropdown-item" href="../articles/want_to_help.html">Want to help?</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../mailto:jisca.huisman@gmail.com" aria-label="email"><span class="fa fas fa-envelope"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JiscaH/sequoia" aria-label="github"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca" aria-label="mastodon"><span class="fa fab fa-mastodon"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/" aria-label="linkedin"><span class="fa fab fa-linkedin-in"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Birth year probabilities</h1>

      <div class="d-none name"><code>CalcBYprobs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate the probability that an individual with unknown birth
  year is born in year <code>y</code>, based on <code>BirthYears</code> or <code>BY.min</code>
  and/or <code>BY.max</code> of its parents, offspring, and siblings, combined with
  <code>AgePrior</code> (the age distribution of other parent-offspring pairs),
  and/or <code>Year.last</code> of its parents.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CalcBYprobs</span><span class="op">(</span>Pedigree <span class="op">=</span> <span class="cn">NULL</span>, LifeHistData <span class="op">=</span> <span class="cn">NULL</span>, AgePrior <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pedigree">Pedigree<a class="anchor" aria-label="anchor" href="#arg-pedigree"></a></dt>
<dd><p>dataframe with columns id-dam-sire.</p></dd>


<dt id="arg-lifehistdata">LifeHistData<a class="anchor" aria-label="anchor" href="#arg-lifehistdata"></a></dt>
<dd><p>data.frame with up to 6 columns:</p><dl><dt>ID</dt>
<dd><p>max. 30 characters long</p></dd>

 <dt>Sex</dt>
<dd><p>1 = female, 2 = male, 3 = unknown, 4 = hermaphrodite,
           other numbers or NA = unknown</p></dd>

<dt>BirthYear </dt>
<dd><p>birth or hatching year, integer, with missing values as NA
  or any negative number.</p></dd>

<dt>BY.min</dt>
<dd><p>minimum birth year, only used if BirthYear is missing</p></dd>

<dt>BY.max</dt>
<dd><p>maximum birth year, only used if BirthYear is missing</p></dd>

<dt>Year.last</dt>
<dd><p>Last year in which individual could have had offspring. Can
  e.g. in mammals be the year before death for females, and year after death
  for males.</p></dd>

</dl><p>"Birth year" may be in any arbitrary discrete time unit relevant to the
species (day, month, decade), as long as parents are never born in the same
time unit as their offspring, and only integers are used. Individuals do not
need to be in the same order as in `GenoM', nor do all genotyped individuals
need to be included.</p></dd>


<dt id="arg-ageprior">AgePrior<a class="anchor" aria-label="anchor" href="#arg-ageprior"></a></dt>
<dd><p>a matrix with probability ratios for individuals with age
difference A to have relationship R, as generated by
<code><a href="MakeAgePrior.html">MakeAgePrior</a></code>. If <code>NULL</code>, <code><a href="MakeAgePrior.html">MakeAgePrior</a></code> is
called using its default values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix with for each individual (rows) in the pedigree that has a missing
  birth year in <code>LifeHistData</code>, or that is not included in
  <code>LifeHistData</code>, the probability that it is born in <code>y</code> (columns).
  Probabilities are rounded to 3 decimal points and may therefore not sum
  exactly to 1.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function assists in estimating birth years of individuals for
  which these are unknown, provided they have at least one parent or one
  offspring in the pedigree. It is not a substitute for field-based estimates
  of age, only a method to summarise the pedigree + birth year based
  information.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">WARNING<a class="anchor" aria-label="anchor" href="#warning"></a></h2>


<p>Any errors in the pedigree or lifehistory data will cause errors in the
 birth year probabilities of their parents and offspring, and putatively also
 of more distant ancestors and descendants. If the ageprior is based on the
 same erroneous pedigree and lifehistory data, all birth year probabilities
 will be affected.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MakeAgePrior.html">MakeAgePrior</a></code> to estimate effect of age on
  relationships.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># exclude 20 random individuals from LH_griffin, then estimate their birth</span></span></span>
<span class="r-in"><span><span class="co"># years from the birth years of their parents and/or offspring:</span></span></span>
<span class="r-in"><span><span class="va">BYprobs</span> <span class="op">&lt;-</span> <span class="fu">CalcBYprobs</span><span class="op">(</span>Pedigree <span class="op">=</span> <span class="va">Ped_griffin</span>,</span></span>
<span class="r-in"><span>                       LifeHistData <span class="op">=</span> <span class="va">LH_griffin</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span>, <span class="fl">20</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Transferring input pedigree ...</span>
<span class="r-in"><span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BYprobs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             1997 1998  1999  2000  2001  2002  2003  2004 2005 2006 2007 2008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i004_2001_F    0    0 0.026 0.053 0.363 0.558 0.000 0.000    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i005_2001_F    0    0 0.000 0.245 0.755 0.000 0.000 0.000    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i024_2002_M    0    0 0.000 0.000 0.000 0.791 0.209 0.000    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i034_2002_F    0    0 0.000 0.000 0.000 1.000 0.000 0.000    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i043_2003_M    0    0 0.000 0.000 0.000 0.000 0.891 0.109    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i044_2003_F    0    0 0.000 0.000 0.000 0.389 0.611 0.000    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             2009 2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i004_2001_F    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i005_2001_F    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i024_2002_M    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i034_2002_F    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i043_2003_M    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i044_2003_F    0    0</span>
<span class="r-in"><span><span class="co"># For some individuals, the most-likely birth year will not be the actual</span></span></span>
<span class="r-in"><span><span class="co"># birth year. But with sufficient quantity and quality of information, the</span></span></span>
<span class="r-in"><span><span class="co"># actual birth year will be among the plausible ones, and be close to the</span></span></span>
<span class="r-in"><span><span class="co"># most-likely birth year.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># heatmap</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">BYprobs</span><span class="op">)</span>, aspect<span class="op">=</span><span class="st">"fill"</span>, col.regions<span class="op">=</span><span class="va">hcl.colors</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

