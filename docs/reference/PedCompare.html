<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compare an inferred pedigree (Ped2) to a previous or simulated
  pedigree (Ped1), including comparison of sibship clusters and sibship
  grandparents."><title>Compare Two Pedigrees — PedCompare • sequoia</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare Two Pedigrees — PedCompare"><meta property="og:description" content="Compare an inferred pedigree (Ped2) to a previous or simulated
  pedigree (Ped1), including comparison of sibship clusters and sibship
  grandparents."><meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo_s.png"><meta property="og:image:alt" content="sequoia hexlogo"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@HuismanJisca"><meta name="twitter:site" content="@HuismanJisca"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.8.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href=".././index.html">
    <span class="fas fa fas fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/sequoia.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_main/book/background.html">Main vignette: User guide</a>
    <a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a>
    <a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a>
    <a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a>
    <a class="dropdown-item" href="../articles/performance_stats.html">Performance Stats</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Change log</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-help">Help</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-help">
    <a class="dropdown-item" href="../articles/help.html">Need help?</a>
    <a class="dropdown-item" href="../articles/pedigree_consultancy.html">Consultancy</a>
    <a class="dropdown-item" href="../articles/want_to_help.html">Want to help?</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa fas fa-envelope"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JiscaH/sequoia">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca">
    <span class="fab fa fab fa-mastodon"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/HuismanJisca">
    <span class="fab fa fab fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compare Two Pedigrees</h1>
      
      <div class="d-none name"><code>PedCompare.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compare an inferred pedigree (Ped2) to a previous or simulated
  pedigree (Ped1), including comparison of sibship clusters and sibship
  grandparents.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PedCompare</span><span class="op">(</span></span>
<span>  Ped1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Ped2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  DumPrefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F0"</span>, <span class="st">"M0"</span><span class="op">)</span>,</span>
<span>  SNPd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Symmetrical <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  minSibSize <span class="op">=</span> <span class="st">"1sib1GP"</span>,</span>
<span>  Plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>Ped1</dt>
<dd><p>first (e.g. original) pedigree, dataframe with columns
id-dam-sire; only the first 3 columns will be used.</p></dd>


<dt>Ped2</dt>
<dd><p>second pedigree, e.g. newly inferred <code>SeqOUT$Pedigree</code> or
<code>SeqOUT$PedigreePar</code>, with columns id-dam-sire.</p></dd>


<dt>DumPrefix</dt>
<dd><p>character vector with the prefixes identifying dummy
individuals in <code>Ped2</code>. Use 'F0' ('M0') to avoid matching to regular
individuals with IDs starting with 'F' ('M'), provided <code>Ped2</code> has
fewer than 999 dummy females (males).</p></dd>


<dt>SNPd</dt>
<dd><p>character vector with IDs of genotyped individuals. If
<code>NULL</code>, defaults to the IDs occurring in both <code>Ped1</code> and
<code>Ped2</code> and not starting with any of the prefixes in <code>DumPrefix</code>.</p></dd>


<dt>Symmetrical</dt>
<dd><p>when determining the category of individuals
(Genotyped/Dummy/X), use the 'highest' category across the two pedigrees
(<code>TRUE</code>, default) or only consider <code>Ped1</code> (<code>Symmetrical =
FALSE</code>).</p></dd>


<dt>minSibSize</dt>
<dd><p>minimum requirements to be considered 'dummifiable',
 passed to <code><a href="getAssignCat.html">getAssignCat</a></code>:</p><ul><li><p>'1sib' : sibship of size 1, with or without grandparents. The
    latter aren't really a sibship, but can be useful in some situations.</p></li>
<li><p>'1sib1GP': sibship of size 1 with at least 1 grandparent (default)</p></li>
<li><p>'2sib': at least 2 siblings, with or without grandparents
      (default prior to version 2.4)</p></li>
</ul></dd>


<dt>Plot</dt>
<dd><p>show square Venn diagrams of counts?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with</p>
<dl><dt>Counts</dt>
<dd><p>A 7 x 5 x 2 named numeric array with the
  number of matches and mismatches, see below</p></dd>

<dt>Counts.detail</dt>
<dd><p>a large numeric array with number of matches and
  mismatches, with more detail for all possible combination of categories</p></dd>

<dt>MergedPed</dt>
<dd><p>A dataframe with side-by-side comparison of the two
  pedigrees</p></dd>

<dt>ConsensusPed</dt>
<dd><p>A consensus pedigree, with Pedigree 2 taking priority
  over Pedigree 1</p></dd>

<dt>DummyMatch</dt>
<dd><p>Dataframe with all dummy IDs in Pedigree 2 (id.2), and the
best-matching individual in Pedigree 1 (id.1). Also includes the class of the
dam &amp; sire, as well as counts of offspring per outcome class (off.Match,
off.Mismatch, etc.)</p></dd>

<dt>Mismatch</dt>
<dd><p>A subset of MergedPed with mismatches between Ped1 and Ped2,
 as defined below</p></dd>

<dt>Ped1only</dt>
<dd><p>as Mismatches, with parents in Ped1 that were not assigned
  in Ped2</p></dd>

<dt>Ped2only</dt>
<dd><p>as Mismatches, with parents in Ped2 that were missing in
  Ped1</p></dd>


</dl><p>'MergedPed', 'Mismatch', 'Ped1only' and 'Ped2only' provide the following
columns:</p>
<dl><dt>id</dt>
<dd><p>All ids in both Pedigree 1 and 2. For dummy individuals, this is
the id <em>in pedigree 2</em></p></dd>

<dt>dam.1, sire.1</dt>
<dd><p>parents in Pedigree 1</p></dd>

<dt>dam.2, sire.2</dt>
<dd><p>parents in Pedigree 2</p></dd>

<dt>id.r, dam.r, sire.r</dt>
<dd><p>The <em>real</em> id of dummy individuals or parents
in Pedigree 2, i.e. the best-matching non-genotyped individual in Pedigree 1,
or "nomatch". If a sibship in Pedigree 1 is divided over 2 sibships in
Pedigree 2, the smaller one will be denoted as "nomatch"</p></dd>

<dt>id.dam.cat, id.sire.cat</dt>
<dd><p>the category of the individual (first letter)
and <em>highest category</em> of the dam (sire) in Pedigree 1 or 2:
G=Genotyped, D=(potential) dummy, X=none. Individual, one-letter categories
are generated by <code><a href="getAssignCat.html">getAssignCat</a></code>. Using the 'best' category from
both pedigrees makes comparison between two inferred pedigrees symmetrical
and more intuitive.</p></dd>

<dt>dam.class, sire.class</dt>
<dd><p>classification of dam and sire: Match, Mismatch,
P1only, P2only, or '_' when no parent is assigned in either pedigree</p></dd>


</dl><p>The first dimension of <code>Counts</code> denotes the following categories:</p>
<dl><dt>GG</dt>
<dd><p>Genotyped individual, assigned a genotyped parent in either
  pedigree</p></dd>

<dt>GD</dt>
<dd><p>Genotyped individual, assigned a dummy parent, or at least 1
  genotyped sibling or a genotyped grandparent in Pedigree 1)</p></dd>

<dt>GT</dt>
<dd><p>Genotyped individual, total</p></dd>

<dt>DG</dt>
<dd><p>Dummy individual, assigned a genotyped parent (i.e., grandparent
   of the sibship in Pedigree 2)</p></dd>

<dt>DD</dt>
<dd><p>Dummy individual, assigned a dummy parent (i.e., avuncular
  relationship between sibships in Pedigree 2)</p></dd>

<dt>DT</dt>
<dd><p>Dummy total</p></dd>

<dt>TT</dt>
<dd><p>Total total, includes all genotyped individuals, plus
  non-genotyped individuals in Pedigree 1, plus non-replaced dummy
  individuals (see below) in Pedigree 2</p></dd>


</dl><p>The second dimension of <code>Counts</code> gives the outcomes:</p>
<dl><dt>Total</dt>
<dd><p>The total number of individuals with a parent assigned in
   either or both pedigrees</p></dd>

<dt>Match</dt>
<dd><p>The same parent is assigned in both pedigrees (non-missing).
     For dummy parents, it is considered a match if the inferred sibship
     which contains the most offspring of a non-genotyped parent, consists
     for more than half of this individual's offspring.</p></dd>

<dt>Mismatch</dt>
<dd><p>Different parents assigned in the two pedigrees. When
   a sibship according to Pedigree 1 is split over two sibships in Pedigree
   2, the smaller fraction is included in the count here.</p></dd>

<dt>P1only</dt>
<dd><p>Parent in Pedigree 1 but not 2; includes non-assignable
    parents (e.g. not genotyped and no genotyped offspring).</p></dd>

<dt>P2only</dt>
<dd><p>Parent in Pedigree 2 but not 1.</p></dd>


</dl><p>The third dimension <code>Counts</code> separates between maternal and paternal
assignments, where e.g. paternal 'DT' is the assignment of fathers to both
maternal and paternal sibships (i.e., to dummies of both sexes).</p>


<p>In 'ConsensusPed', the priority used is parent.r (if not "nomatch") &gt;
  parent.2 &gt; parent.1. The columns 'id.cat', dam.cat' and 'sire.cat' have two
  additional levels compared to 'MergedPed':</p>
<dl><dt>G</dt>
<dd><p>Genotyped</p></dd>

  <dt>D</dt>
<dd><p>Dummy individual (in Pedigree 2)</p></dd>

  <dt>R</dt>
<dd><p>Dummy individual in pedigree 2 replaced by best matching
    non-genotyped individual in pedigree 1</p></dd>

  <dt>U</dt>
<dd><p>Ungenotyped, Unconfirmed (parent in Pedigree 1, with no dummy
    match in Pedigree 2)</p></dd>

  <dt>X</dt>
<dd><p>No parent in either pedigree</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The comparison is divided into different classes of `assignable'
  parents (<code><a href="getAssignCat.html">getAssignCat</a></code>). This includes cases where the focal
  individual and parent according to Ped1 are both Genotyped (G-G), as well
  as cases where the non-genotyped parent according to Ped1 can be lined up
  with a sibship Dummy parent in Ped2 (G-D), or where the non-genotyped focal
  individual in Ped1 can be matched to a dummy individual in Ped2 (D-G and
  D-D). If SNPd is NULL (the default), and DumPrefix is set to NULL, the
  intersect between the IDs in Pedigrees 1 and 2 is taken as the vector of
  genotyped individuals.</p>
    </div>
    <div class="section level2">
    <h2 id="assignable">Assignable<a class="anchor" aria-label="anchor" href="#assignable"></a></h2>
    

<p>Note that 'assignable' may be overly optimistic. Some parents from
  <code>Ped1</code> indicated as assignable may never be assigned by sequoia, for
  example parent-offspring pairs where it cannot be determined which is the
  older of the two, or grandparents that are indistinguishable from full
  avuncular (i.e. genetics inconclusive because the candidate has no parent
  assigned, and ageprior inconclusive).</p>
    </div>
    <div class="section level2">
    <h2 id="dummifiable">Dummifiable<a class="anchor" aria-label="anchor" href="#dummifiable"></a></h2>
    

<p>Considered as potential dummy individuals are all non-genotyped individuals
  in Pedigree 1 who have, according to either pedigree, at least 2 genotyped
  offspring, or at least one genotyped offspring and a genotyped parent.</p>
    </div>
    <div class="section level2">
    <h2 id="mismatches">Mismatches<a class="anchor" aria-label="anchor" href="#mismatches"></a></h2>
    

<p>Perhaps unexpectedly, cases where all siblings are correct but a dummy
  parent rather than the genotyped Ped1-parent are assigned, are classified
  as a mismatch (for each of the siblings). These are typically due to a too
  low assumed genotyping error rate, a wrong parental birth year, or some
  other issue that requires user inspection. To identify these cases,
  <code><a href="ComparePairs.html">ComparePairs</a></code> may be of help.</p>
    </div>
    <div class="section level2">
    <h2 id="genotyped-mystery-samples-">Genotyped 'mystery samples'<a class="anchor" aria-label="anchor" href="#genotyped-mystery-samples-"></a></h2>
    

<p>If Pedigree 2 includes samples for which the ID is unknown, the behaviour of
 <code>PedCompare</code> depends on whether the temporary IDs for these samples are
 included in <code>SNPd</code>. If they are included, matching (actual) IDs in
 Pedigree 1 will be flagged as mismatches (because the IDs differ). If they
 are not included in <code>SNPd</code>, or <code>SNPd</code> is not explicitly provided,
 matches are accepted, as the situation is indistinguishable from comparing
 dummy parents across pedigrees.</p>
<p>This is of course all conditional on relatives of the mystery sample being
 assigned in Pedigree 2.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ComparePairs.html">ComparePairs</a></code> for comparison of all pairwise
  relationships in 2 pedigrees; <code><a href="EstConf.html">EstConf</a></code> for repeated
  simulate-reconstruct-compare; <code><a href="getAssignCat.html">getAssignCat</a></code> for all parents in
  the reference pedigree that could have been assigned;
  <code><a href="CalcOHLLR.html">CalcOHLLR</a></code> to check how well an 'old' pedigree fits with the
  SNP data.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jisca Huisman, <a href="mailto:jisca.huisman@gmail.com">jisca.huisman@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="fu">PedCompare</span><span class="op">(</span><span class="va">Ped_griffin</span>, <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">Pedigree</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PedCompare-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">Counts</span><span class="op">[</span><span class="st">"TT"</span>,,<span class="op">]</span>  <span class="co"># totals only; 45 dams &amp; 47 sires non-assigned</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class      dam sire</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total    167  163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Match    122  116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mismatch   0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P1only    45   47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P2only     0    0</span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">Counts</span><span class="op">[</span>,,<span class="st">"dam"</span><span class="op">]</span>  <span class="co"># dams only</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat  Total Match Mismatch P1only P2only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GG    65    65        0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GD    56    41        0     15      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GT   125   106        0     19      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DG    23    12        0     11      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DD    12     4        0      8      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DT    39    16        0     23      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TT   167   122        0     45      0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inspect non-assigned in Ped2, id genotyped, dam might-be-dummy</span></span></span>
<span class="r-in"><span><span class="va">PedM</span> <span class="op">&lt;-</span> <span class="va">compare</span><span class="op">$</span><span class="va">MergedPed</span>  <span class="co"># for brevity</span></span></span>
<span class="r-in"><span><span class="va">PedM</span><span class="op">[</span><span class="va">PedM</span><span class="op">$</span><span class="va">id.dam.cat</span><span class="op">==</span><span class="st">'GD'</span> <span class="op">&amp;</span> <span class="va">PedM</span><span class="op">$</span><span class="va">dam.class</span><span class="op">==</span><span class="st">'P1only'</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              id       dam.1      sire.1 dam.2      sire.2        id.r dam.r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  i028_2002_M i005_2001_F        &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt; i028_2002_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  i033_2002_F i013_2001_F        &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt; i033_2002_F  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  i034_2002_F i011_2001_F        &lt;NA&gt;  &lt;NA&gt;        &lt;NA&gt; i034_2002_F  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53  i044_2003_F i011_2001_F i019_2001_M  &lt;NA&gt;        &lt;NA&gt; i044_2003_F  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61  i055_2003_M i012_2001_F i040_2002_M  &lt;NA&gt; i040_2002_M i055_2003_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  i059_2003_M i013_2001_F i036_2002_M  &lt;NA&gt; i036_2002_M i059_2003_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  i062_2004_M i012_2001_F i058_2003_M  &lt;NA&gt;        &lt;NA&gt; i062_2004_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68  i067_2004_F i005_2001_F i029_2002_M  &lt;NA&gt; i029_2002_M i067_2004_F  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72  i072_2004_M i048_2003_F i010_2001_M  &lt;NA&gt;        &lt;NA&gt; i072_2004_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73  i073_2004_M i060_2003_F i003_2001_M  &lt;NA&gt;        &lt;NA&gt; i073_2004_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102 i113_2006_M i087_2005_F i053_2003_M  &lt;NA&gt;        &lt;NA&gt; i113_2006_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103 i114_2006_M i060_2003_F i090_2005_M  &lt;NA&gt;        &lt;NA&gt; i114_2006_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111 i126_2007_F i100_2005_F i120_2006_M  &lt;NA&gt;       M0007 i126_2007_F  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112 i127_2007_M i087_2005_F i085_2005_M  &lt;NA&gt;        &lt;NA&gt; i127_2007_M  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132 i157_2008_F i125_2007_F i082_2005_M  &lt;NA&gt;        &lt;NA&gt; i157_2008_F  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sire.r id.dam.cat id.sire.cat dam.class sire.class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         &lt;NA&gt;         GD          GX    P1only          _</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         &lt;NA&gt;         GD          GX    P1only          _</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         &lt;NA&gt;         GD          GX    P1only          _</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         &lt;NA&gt;         GD          GD    P1only     P1only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61         &lt;NA&gt;         GD          GG    P1only      Match</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63         &lt;NA&gt;         GD          GG    P1only      Match</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         &lt;NA&gt;         GD          GD    P1only     P1only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68         &lt;NA&gt;         GD          GG    P1only      Match</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72         &lt;NA&gt;         GD          GD    P1only     P1only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73         &lt;NA&gt;         GD          GX    P1only     P1only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102        &lt;NA&gt;         GD          GD    P1only     P1only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103        &lt;NA&gt;         GD          GD    P1only     P1only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111 i120_2006_M         GD          GD    P1only      Match</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112        &lt;NA&gt;         GD          GD    P1only     P1only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132        &lt;NA&gt;         GD          GD    P1only     P1only</span>
<span class="r-in"><span><span class="co"># zoom in on specific dam</span></span></span>
<span class="r-in"><span><span class="va">PedM</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">PedM</span><span class="op">$</span><span class="va">dam.1</span><span class="op">==</span><span class="st">"i011_2001_F"</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             id       dam.1      sire.1 dam.2 sire.2        id.r dam.r sire.r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 i034_2002_F i011_2001_F        &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt; i034_2002_F  &lt;NA&gt;   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 i044_2003_F i011_2001_F i019_2001_M  &lt;NA&gt;   &lt;NA&gt; i044_2003_F  &lt;NA&gt;   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id.dam.cat id.sire.cat dam.class sire.class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46         GD          GX    P1only          _</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53         GD          GD    P1only     P1only</span>
<span class="r-in"><span><span class="co"># no sire for 'i034_2002_F' -&gt; impossible to tell if half-sibs or avuncular</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># overview of all non-genotyped -- dummy matches</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">DummyMatch</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id.2        id.1 Sex dam.class sire.class off.Match off.Mismatch off.P1only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 F0001 i101_2006_F   1     Match      Match        11            0          3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 F0002 i155_2008_F   1     Match      Match         3            0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 F0003 i115_2006_F   1    P1only     P1only         4            0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 F0004 i167_2009_F   1     Match      Match         2            0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 F0005 i140_2007_F   1     Match     P1only         2            0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 F0006 i032_2002_F   1         _     P1only         3            0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   off.P2only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># success of paternity assignment, if genotyped mother correctly assigned</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">compare</span><span class="op">$</span><span class="va">Counts.detail</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $id.cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "G" "D" "X"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dam.cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "G" "D" "X"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sire.cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "G" "D" "X"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dam.class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Match"    "Mismatch" "P1only"   "P2only"   "_"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sire.class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Match"    "Mismatch" "P1only"   "P2only"   "_"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">compare</span><span class="op">$</span><span class="va">Counts.detail</span><span class="op">[</span><span class="st">"G"</span>,<span class="st">"G"</span>,,<span class="st">"Match"</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sire.class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sire.cat Match Mismatch P1only P2only  _</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        G    41        0      0      0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        D    12        0      9      0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        X     0        0      1      0  2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># default before version 3.5: minSibSize = '2sib'</span></span></span>
<span class="r-in"><span><span class="va">compare_2s</span> <span class="op">&lt;-</span> <span class="fu">PedCompare</span><span class="op">(</span><span class="va">Ped_griffin</span>, <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">Pedigree</span>,</span></span>
<span class="r-in"><span>                         minSibSize <span class="op">=</span> <span class="st">'2sib'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PedCompare-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">compare_2s</span><span class="op">$</span><span class="va">Counts</span><span class="op">[</span>,,<span class="st">"dam"</span><span class="op">]</span>  <span class="co"># note decrease in Total 'dummies</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat  Total Match Mismatch P1only P2only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GG    65    65        0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GD    51    39        0     12      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GT   125   106        0     19      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DG     9     8        0      1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DD     7     4        0      3      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DT    17    12        0      5      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TT   167   122        0     45      0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">compare_2s</span><span class="op">$</span><span class="va">MergedPed</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">id.dam.cat</span>, <span class="va">dam.class</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           dam.class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> id.dam.cat Match P1only  _</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DD     4      3  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DG     8      1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         DX     0      1 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         GD    39     12  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         GG    65      0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         GX     2      7 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         XD     0      4  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         XG     4     11  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         XX     0      6  6</span>
<span class="r-in"><span><span class="co"># some with id.cat = 'X' or dam.cat='X' are nonetheless dam.class='Match'</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

