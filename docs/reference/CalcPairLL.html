<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate Likelihoods for Alternative Relationships — CalcPairLL • sequoia</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate Likelihoods for Alternative Relationships — CalcPairLL" />
<meta property="og:description" content="For each specified pair of individuals, calculate the
  log10-likelihoods of being PO, FS, HS, GP, FA, HA, U (see Details).
  Individuals must be genotyped or have at least one genotyped offspring.
NOTE values \(&amp;gt;0\) are various NA types, see 'Likelihood
  special codes' in 'Value' section below." />
<meta property="og:image" content="/reference/figures/sequoia_hexlogo_s.png" />
<meta property="og:image:alt" content="sequoia hexlogo" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sequoia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_main/_book/sec-Background.html">Main vignette: User guide</a>
    </li>
    <li>
      <a href="../articles/vignette_age/_book/index.html">Age prior vignette</a>
    </li>
    <li>
      <a href="../articles/index.html">Examples</a>
    </li>
    <li>
      <a href="../articles/index.html">More info on ...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a href="../articles/help.html">Help</a>
</li>
<li>
  <a href="../articles/_performance_stats.html">Stats</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/HuismanJisca">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/JiscaH/sequoia">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate Likelihoods for Alternative Relationships</h1>
    
    <div class="hidden name"><code>CalcPairLL.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For each specified pair of individuals, calculate the
  log10-likelihoods of being PO, FS, HS, GP, FA, HA, U (see Details).
  Individuals must be genotyped or have at least one genotyped offspring.</p>
<p><strong>NOTE</strong> values \(&gt;0\) are various <code>NA</code> types, see 'Likelihood
  special codes' in 'Value' section below.</p>
    </div>

    <pre class="usage"><span class='fu'>CalcPairLL</span><span class='op'>(</span>
  Pairs <span class='op'>=</span> <span class='cn'>NULL</span>,
  GenoM <span class='op'>=</span> <span class='cn'>NULL</span>,
  Pedigree <span class='op'>=</span> <span class='cn'>NULL</span>,
  LifeHistData <span class='op'>=</span> <span class='cn'>NULL</span>,
  AgePrior <span class='op'>=</span> <span class='cn'>TRUE</span>,
  SeqList <span class='op'>=</span> <span class='cn'>NULL</span>,
  Complex <span class='op'>=</span> <span class='st'>"full"</span>,
  Herm <span class='op'>=</span> <span class='st'>"no"</span>,
  Err <span class='op'>=</span> <span class='fl'>1e-04</span>,
  ErrFlavour <span class='op'>=</span> <span class='st'>"version2.0"</span>,
  Tassign <span class='op'>=</span> <span class='fl'>0.5</span>,
  Tfilter <span class='op'>=</span> <span class='op'>-</span><span class='fl'>2</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  Plot <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Pairs</th>
      <td><p>dataframe with columns <code>ID1</code> and <code>ID2</code>, and
 optionally</p><dl>
<dt>Sex1</dt><dd><p>Sex of ID1, 1=female, 2=male, 3=unknown, or <code>NA</code> to take
  from <code>LifeHistData</code>. The sex of individuals occurring as parent in
  <code>Pedigree</code> cannot be altered.</p></dd>
<dt>Sex2</dt><dd><p>Sex of ID2</p></dd>
<dt>AgeDif</dt><dd><p>Age difference in whole time units, BirthYear1 - BirthYear2
  (i.e. positive if ID2 is born before ID1). If <code>NA</code>, calculated from
  <code>LifeHistData</code>. Use '999' to explicitly specify 'unknown'.</p></dd>
<dt>focal</dt><dd><p>relationship character abbreviation; PO, FS, HS, GP or U. See
Details for its effect and explanation of abbreviations. Default: U</p></dd>
<dt>patmat</dt><dd><p>1=maternal relatives, 2=paternal relatives. Only relevant for
  HS &amp; GP, for which it defaults to Sex1, or 1 if Sex1=3, but is currently
  only predictably implemented for pairs of two genotyped individuals.
  Always equal to Sex2 for PO pairs when Sex2 is known.</p></dd>
<dt>dropPar1</dt><dd><p>Drop the parents of <code>ID1</code> before calculating the pair
likelihood, rather than conditioning on them; choose from 'none', 'dam',
'sire', or 'both'. See example. If e.g. the pair shares a common mother,
'none' and 'sire' will condition on this shared mother and not calculate the
likelihood that they are maternal siblings, while dropPar1='dam' or 'both'
will calculate that likelihood, and the other likelihoods as if the mother
of ID1 were unknown.</p></dd>
<dt>dropPar2</dt><dd><p>as <code>dropPar1</code>, for <code>ID2</code></p></dd>

</dl></td>
    </tr>
    <tr>
      <th>GenoM</th>
      <td><p>numeric matrix with genotype data: One row per individual, and
one column per SNP, coded as 0, 1, 2 or -9 (missing). See also
<code><a href='GenoConvert.html'>GenoConvert</a></code>.</p></td>
    </tr>
    <tr>
      <th>Pedigree</th>
      <td><p>dataframe with columns id-dam-sire; likelihoods will be
calculated conditional on the pedigree. May include non-genotyped
individuals, which will be treated as dummy individuals.</p></td>
    </tr>
    <tr>
      <th>LifeHistData</th>
      <td><p>dataframe with 3 columns (optionally 5):</p><dl>
 <dt>ID</dt><dd><p>max. 30 characters long</p></dd>
 <dt>Sex</dt><dd><p>1 = female, 2 = male, 3 = unknown, 4 = hermaphrodite,
           other numbers or NA = unknown</p></dd>
<dt>BirthYear </dt><dd><p>birth or hatching year, integer, with missing values as NA
  or any negative value.</p></dd>
<dt>BY.min</dt><dd><p>minimum birth year, only used if BirthYear is missing</p></dd>
<dt>BY.max</dt><dd><p>maximum birth year, only used if BirthYear is missing</p></dd> 
</dl><p>If the species has multiple generations per year, use an integer coding such
that the candidate parents' `Birth year' is at least one smaller than their
putative offspring's. Column names are ignored, so ensure column order is ID
- sex - birth year (- BY.min - BY.max). Individuals do not need to be in the
same order as in `GenoM', nor do all genotyped individuals need to be
included.</p></td>
    </tr>
    <tr>
      <th>AgePrior</th>
      <td><p>logical (<code>TRUE/FALSE</code>) whether to estimate the ageprior
from <code>Pedigree</code> and <code>LifeHistData</code>, or a matrix as generated by
<code><a href='MakeAgePrior.html'>MakeAgePrior</a></code> and included in the <code><a href='sequoia.html'>sequoia</a></code>
output. The <code>AgePrior</code> affects which relationships are considered
possible: only those where \(P(A|R) / P(A) &gt; 0\).  When <code>TRUE</code>,
<code><a href='MakeAgePrior.html'>MakeAgePrior</a></code> is called using its default values. When
<code>FALSE</code>, all relationships are considered possible for all age
differences, except that parent-offspring pairs cannot have age difference
zero, and grand-parental pairs have an age difference of at least two.</p></td>
    </tr>
    <tr>
      <th>SeqList</th>
      <td><p>list with output from <code><a href='sequoia.html'>sequoia</a></code>. If input
parameter <code>Pedigree=NULL</code>, <code>SeqList$Pedigree</code> will be used if
present, and <code>SeqList$PedigreePar</code> otherwise. If <code>SeqList$Specs</code>
is present, input parameters with the same name as its items are ignored.
The list elements 'LifeHist', 'AgePriors', and 'ErrM' are also used if
present, and override the corresponding input parameters.</p></td>
    </tr>
    <tr>
      <th>Complex</th>
      <td><p>Breeding system complexity. Either "full" (default), "simp"
(simplified, no explicit consideration of inbred relationships), "mono"
(monogamous).</p></td>
    </tr>
    <tr>
      <th>Herm</th>
      <td><p>Hermaphrodites, either "no", "A" (distinguish between dam and
sire role, default if at least 1 individual with sex=4), or "B" (no
distinction between dam and sire role). Both of the latter deal with
selfing.</p></td>
    </tr>
    <tr>
      <th>Err</th>
      <td><p>estimated genotyping error rate, as a single number or 3x3 matrix.
Details below. The error rate is presumed constant across SNPs, and
missingness is presumed random with respect to actual genotype.</p></td>
    </tr>
    <tr>
      <th>ErrFlavour</th>
      <td><p>function that takes <code>Err</code> (single number) as input,
and returns a 3x3 matrix of observed (columns) conditional on actual (rows)
genotypes, or choose from inbuilt options 'version2.0', 'version1.3', or
'version1.1', referring to the sequoia version in which they were the
default. Ignored if <code>Err</code> is a matrix. See <code><a href='ErrToM.html'>ErrToM</a></code>.</p></td>
    </tr>
    <tr>
      <th>Tassign</th>
      <td><p>minimum LLR required for acceptance of proposed relationship,
relative to next most likely relationship. Higher values result in more
conservative assignments. Must be zero or positive.</p></td>
    </tr>
    <tr>
      <th>Tfilter</th>
      <td><p>threshold log10-likelihood ratio (LLR) between a proposed
relationship versus unrelated, to select candidate relatives. Typically a
negative value, related to the fact that unconditional likelihoods are
calculated during the filtering steps. More negative values may decrease
non-assignment, but will increase computational time.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>logical, suppress messages</p></td>
    </tr>
    <tr>
      <th>Plot</th>
      <td><p>logical, display scatter plots by <code><a href='PlotPairLL.html'>PlotPairLL</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>Pairs</code> dataframe including all optional columns listed
  above, plus the additional columns:</p>
<dt>LL_xx</dt><dd><p>Log10-Likelihood of this pair having relationship xx, with xx
   being one of PO, FS, etc. as detailed below.</p></dd>
 <dt>TopRel</dt><dd><p>Abbreviation of most likely relationship</p></dd>
 <dt>LLR</dt><dd><p>Likelihood ratio between most-likely and second most likely
   relationships</p></dd>

Relationship abbreviations:
  <dt>PO</dt><dd><p>Parent - offspring</p></dd>
  <dt>FS</dt><dd><p>Full siblings</p></dd>
  <dt>HS</dt><dd><p>Half siblings</p></dd>
  <dt>GP</dt><dd><p>Grandparent</p></dd>
  <dt>FA</dt><dd><p>Full avuncular</p></dd>
  <dt>HA</dt><dd><p>Half avuncular and other 3rd degree relationships</p></dd>
  <dt>U</dt><dd><p>Unrelated</p></dd>
  <dt>2nd</dt><dd><p>Unclear which type of 2nd degree relatives
    (HS, GP, or FA)</p></dd>
  <dt>??</dt><dd><p>Unclear which type of 1st, 2nd or 3rd degree
    relatives</p></dd>

Likelihood special codes:
  <dt>222</dt><dd><p>Maybe (via) other parent (e.g. focal="GP", but as likely to be
    maternal as paternal grandparent, and therefore not assignable)</p></dd>
  <dt>333</dt><dd><p>Excluded from comparison (shouldn't occur)</p></dd>
  <dt>444</dt><dd><p>Not implemented (e.g. would create an odd double/triple
    relationship in combination with the provided pedigree)</p></dd>
  <dt>777</dt><dd><p>Impossible (e.g. cannot be both full sibling and grandparent)</p></dd>
  <dt>888</dt><dd><p>Already assigned in the provided pedigree (see <code>dropPar</code>
    arguments)</p></dd>
  <dt>999</dt><dd><p>NA</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The same pair may be included multiple times, e.g. with different
  sex, age difference, or focal relationship, to explore their effect on the
  likelihoods. Likelihoods are only calculated for relationships that are
  possible given the age difference, e.g. PO (parent-offspring) is not
  calculated for pairs with an age difference of 0.</p>
<p>Non-genotyped individuals can be included if they have at least one
  genotyped offspring and can be turned into a dummy (see
  <code><a href='getAssignCat.html'>getAssignCat</a></code>); to establish this a pedigree must be provided.</p>
<p><strong>Warning 1</strong>: There is no check whether the input pedigree is genetically
  sensible, it is simply conditioned upon. Checking whether a pedigree is
  compatible with the SNP data can be done with <code><a href='CalcOHLLR.html'>CalcOHLLR</a></code>.</p>
<p><strong>Warning 2</strong>: Conditioning on a <code>Pedigree</code> can make computation
  orders of magnitude slower.</p>
    <h2 class="hasAnchor" id="double-relationships-amp-focal-relationship"><a class="anchor" href="#double-relationships-amp-focal-relationship"></a>Double relationships &amp; focal relationship</h2>

    

<p>Especially when Complex='full', not only the seven relationship
  alternatives listed above are considered, but a whole range of possible
  double and even triple relationships. For example, mother A and offspring B
  (PO) may also be paternal half-siblings (HS, A and A's mother mated with
  same male), grandmother and grand-offspring (GP, B's father is A's son), or
  paternal aunt (B's father is a full or half sib of A).</p>
<p>The likelihood reported as 'LL_PO' is the most-likely one of the possible
  alternatives, among those that are not impossible due to age differences or
  due to the pedigree (as reconstructed up to that point). Whether e.g. the
  likelihood to be both PO &amp; HS is counted as PO or as HS, depends on the
  situation and is determined by the variable 'focal': During parentage
  assignment, it is counted as PO but not HS, while during sibship
  clustering, it is counted as HS but not PO -- not omitting from the
  alternative relationship would result in a deadlock.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='PlotPairLL.html'>PlotPairLL</a></code> to plot alternative relationship pairs from
  the output; <code><a href='CalcOHLLR.html'>CalcOHLLR</a></code> to calculate LLR for parents &amp;
  parent-pairs in a pedigree; <code><a href='GetRelM.html'>GetRelM</a></code> to find all pairwise
  relatives according to the pedigree; <code><a href='GetMaybeRel.html'>GetMaybeRel</a></code> to get
  likely relative pairs not in the pedigree.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># likelihoods underlying parent LLR in pedigree:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>LH_HSg5</span>, <span class='va'>SimGeno_example</span><span class='op'>)</span>
<span class='va'>Seq.HSg5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sequoia.html'>sequoia</a></span><span class='op'>(</span><span class='va'>SimGeno_example</span>, <span class='va'>LH_HSg5</span>, Module<span class='op'>=</span><span class='st'>"par"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Genotype matrix looks OK! There are  214  individuals and  200  SNPs.</span></div><div class='output co'>#&gt; <span class='message'>Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 2,2</span></div><div class='img'><img src='CalcPairLL-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>~~~ Duplicate check ~~~</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>~~~ Parentage assignment ~~~</span></div><div class='output co'>#&gt; Parentage ...
#&gt; Initial total LL :
#&gt; [1] -18301.9
#&gt; Post-parentage total LL :
#&gt; [1] -13795.2
#&gt; Estimating birth years ...
#&gt; Calculating parental LLR ...</div><div class='output co'>#&gt; <span class='message'>assigned 123 dams and 159 sires to 214 individuals</span></div><div class='img'><img src='CalcPairLL-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='CalcPairLL-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>Seq.HSg5</span><span class='op'>$</span><span class='va'>PedigreePar</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         id    dam   sire LLRdam LLRsire LLRpair OHdam OHsire MEpair
#&gt; 209 b01187   &lt;NA&gt; b00008     NA    3.43      NA    NA      0     NA
#&gt; 210 b01188   &lt;NA&gt; b00008     NA    3.99      NA    NA      0     NA
#&gt; 211 a01189   &lt;NA&gt; b00007     NA    0.63      NA    NA      0     NA
#&gt; 212 a01190 a00012 b00007   4.51    4.34    7.27     0      0      0
#&gt; 213 b01191 a00012 b00007   0.98    4.16    3.89     0      0      1
#&gt; 214 a01192 a00012 b00007   0.95    2.92    3.83     0      0      1</div><div class='input'><span class='co'># take bottom 3 individuals:</span>
<span class='va'>Pairs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a01190"</span>, <span class='st'>"b01191"</span>, <span class='st'>"a01192"</span><span class='op'>)</span>,
                    ID2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a00012"</span>, <span class='st'>"b00007"</span><span class='op'>)</span>, each<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>,
                    AgeDif <span class='op'>=</span> <span class='fl'>1</span>, focal <span class='op'>=</span> <span class='st'>"PO"</span><span class='op'>)</span>
<span class='co'># LLRdam &amp; LLRsire:</span>
<span class='fu'>CalcPairLL</span><span class='op'>(</span><span class='va'>Pairs</span>, <span class='va'>SimGeno_example</span><span class='op'>)</span>
</div><div class='img'><img src='CalcPairLL-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;      ID1    ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2      PO      FS
#&gt; 1 a01190 a00012    3    3      1    PO      1     none     none -158.11 -163.01
#&gt; 2 b01191 a00012    3    3      1    PO      1     none     none -161.38 -162.95
#&gt; 3 a01192 a00012    3    3      1    PO      1     none     none -160.99 -163.28
#&gt; 4 a01190 b00007    3    3      1    PO      1     none     none -156.58 -162.32
#&gt; 5 b01191 b00007    3    3      1    PO      1     none     none -154.75 -159.60
#&gt; 6 a01192 b00007    3    3      1    PO      1     none     none -154.58 -157.55
#&gt;        HS  GP  FA      HA       U TopRel  LLR
#&gt; 1 -162.10 777 777 -162.10 -172.83     PO 3.99
#&gt; 2 -161.62 777 777 -161.62 -172.02     PO 0.24
#&gt; 3 -161.37 777 777 -161.37 -171.09     PO 0.38
#&gt; 4 -160.92 777 777 -160.92 -168.60     PO 4.34
#&gt; 5 -158.91 777 777 -158.91 -167.79     PO 4.16
#&gt; 6 -157.49 777 777 -157.49 -166.85     PO 2.92</div><div class='input'><span class='co'># LLRpair is min. of dam &amp; sire LLR, conditional on co-parent:</span>
<span class='fu'>CalcPairLL</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>Pairs</span>, dropPar1<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"dam"</span>, <span class='st'>"sire"</span><span class='op'>)</span>, each<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>,
           <span class='va'>SimGeno_example</span>, SeqList <span class='op'>=</span> <span class='va'>Seq.HSg5</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>using PedigreePar in SeqList</span></div><div class='output co'>#&gt; <span class='message'>using LifeHist in SeqList</span></div><div class='output co'>#&gt; <span class='message'>using AgePriors in SeqList</span></div><div class='output co'>#&gt; <span class='message'>settings in SeqList$Specs will overrule input parameters</span></div><div class='img'><img src='CalcPairLL-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;      ID1    ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2      PO  FS  HS
#&gt; 1 a01190 a00012    1    1      1    PO      1      dam     none -137.55 777 777
#&gt; 2 b01191 a00012    2    1      1    PO      1      dam     none -139.95 777 777
#&gt; 3 a01192 a00012    1    1      1    PO      1      dam     none -139.88 777 777
#&gt; 4 a01190 b00007    1    2      1    PO      2     sire     none -133.32 777 777
#&gt; 5 b01191 b00007    2    2      1    PO      2     sire     none -135.72 777 777
#&gt; 6 a01192 b00007    1    2      1    PO      2     sire     none -135.65 777 777
#&gt;    GP  FA      HA       U TopRel   LLR
#&gt; 1 777 777 -149.22 -160.81     PO 11.67
#&gt; 2 777 777 -147.98 -158.98     PO  8.03
#&gt; 3 777 777 -147.78 -158.81     PO  7.90
#&gt; 4 777 777 -143.63 -153.88     PO 10.31
#&gt; 5 777 777 -146.47 -157.14     PO 10.75
#&gt; 6 777 777 -146.21 -156.75     PO 10.57</div><div class='input'>
<span class='co'># \donttest{</span>
<span class='co'># likelihoods underlying LLR in getMaybeRel output:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Ped_griffin</span>, <span class='va'>SeqOUT_griffin</span>, package<span class='op'>=</span><span class='st'>"sequoia"</span><span class='op'>)</span>
<span class='va'>Geno.griffin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SimGeno.html'>SimGeno</a></span><span class='op'>(</span><span class='va'>Ped_griffin</span>, nSnp<span class='op'>=</span><span class='fl'>200</span>, SnpError <span class='op'>=</span> <span class='fl'>0.01</span>, ParMis<span class='op'>=</span><span class='fl'>0.4</span><span class='op'>)</span>
<span class='va'>MR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='GetMaybeRel.html'>GetMaybeRel</a></span><span class='op'>(</span>GenoM <span class='op'>=</span> <span class='va'>Geno.griffin</span>,
                  LifeHistData <span class='op'>=</span> <span class='va'>SeqOUT_griffin</span><span class='op'>$</span><span class='va'>LifeHist</span>,
                  Module <span class='op'>=</span> <span class='st'>"par"</span>, Err <span class='op'>=</span> <span class='fl'>0.001</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Searching for non-assigned parent-offspring pairs ... (Module = par)</span></div><div class='output co'>#&gt; <span class='message'>Genotype matrix looks OK! There are  142  individuals and  200  SNPs.</span></div><div class='output co'>#&gt; <span class='message'>Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 10,10</span></div><div class='output co'>#&gt; Counting opposing homozygous loci between all individuals ...
#&gt; Checking for non-assigned Parent-Offspring pairs ...
#&gt; Checking for Parent-Parent-Offspring trios ...</div><div class='output co'>#&gt; <span class='message'>Found 127 likely parent-offspring pairs, and 2 other non-assigned pairs of possible relatives</span></div><div class='output co'>#&gt; <span class='message'>Found 33 parent-parent-offspring trios</span></div><div class='input'><span class='va'>FivePairs</span> <span class='op'>&lt;-</span> <span class='va'>MR</span><span class='op'>$</span><span class='va'>MaybePar</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ID1"</span>, <span class='st'>"ID2"</span>, <span class='st'>"Sex1"</span>, <span class='st'>"Sex2"</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>FivePairs</span><span class='op'>$</span><span class='va'>AgeDif</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>   <span class='co'># pretend unknown age differences</span>
<span class='va'>PairLL</span> <span class='op'>&lt;-</span> <span class='fu'>CalcPairLL</span><span class='op'>(</span>Pairs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>FivePairs</span>, focal <span class='op'>=</span> <span class='st'>"PO"</span><span class='op'>)</span>,
                                    <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>FivePairs</span>, focal <span class='op'>=</span> <span class='st'>"HS"</span><span class='op'>)</span>,
                                    <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>FivePairs</span>, focal <span class='op'>=</span> <span class='st'>"GP"</span><span class='op'>)</span><span class='op'>)</span>,
                     GenoM <span class='op'>=</span> <span class='va'>Geno.griffin</span>,
                     Err <span class='op'>=</span> <span class='fl'>0.005</span>, Plot<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>PairLL</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>6</span>, <span class='fl'>11</span><span class='op'>)</span>, <span class='op'>]</span>
</div><div class='output co'>#&gt;            ID1         ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2
#&gt; 1  i115_2006_F i087_2005_F    1    1     NA    PO      1     none     none
#&gt; 6  i115_2006_F i087_2005_F    1    1     NA    HS      1     none     none
#&gt; 11 i115_2006_F i087_2005_F    1    1     NA    GP      1     none     none
#&gt;         PO      FS      HS      GP  FA      HA       U TopRel  LLR
#&gt; 1  -158.05 -163.82 -162.99 -162.44 777 -162.99 -172.66     PO 4.40
#&gt; 6  -158.05  222.00 -161.37 -161.37 777 -162.99 -172.66     PO 3.32
#&gt; 11 -158.05 -163.82 -161.37  222.00 777 -162.99 -172.66     PO 3.32</div><div class='input'><span class='co'># LL(FS)==222 : HSHA, HSGP, FAHA more likely than FS</span>
<span class='co'># LL(GP) higher when focal=HS: GP via 'other' parent also considered</span>
<span class='co'># LL(FA) higher when focal=PO: FAHA, or FS of 'other' parent</span>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


