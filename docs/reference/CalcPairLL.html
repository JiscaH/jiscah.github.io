<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Likelihoods for Alternative Relationships — CalcPairLL • sequoia</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Likelihoods for Alternative Relationships — CalcPairLL"><meta name="description" content="For each specified pair of individuals, calculate the
  log10-likelihoods of being PO, FS, HS, GP, FA, HA, U (see Details).
  Individuals must be genotyped or have at least one genotyped offspring.
NOTE values \(&amp;gt;0\) are various NA types, see 'Likelihood
  special codes' in 'Value' section below."><meta property="og:description" content="For each specified pair of individuals, calculate the
  log10-likelihoods of being PO, FS, HS, GP, FA, HA, U (see Details).
  Individuals must be genotyped or have at least one genotyped offspring.
NOTE values \(&amp;gt;0\) are various NA types, see 'Likelihood
  special codes' in 'Value' section below."><meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo.png"><meta property="og:image:alt" content="sequoia hexlogo"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@HuismanJisca"><meta name="twitter:site" content="@HuismanJisca"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href=".././index.html" aria-label="home"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/sequoia.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_main/book/background.html">Main vignette: User guide</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a></li>
    <li><a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a></li>
    <li><a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/performance_stats.html">Performance Stats</a></li>
    <li><a class="dropdown-item" href="../reference/figures/Poster_sequoia_ESEB2017.pdf">poster</a></li>
    <li><a class="dropdown-item" href="../reference/figures/Slideshow_sequoia_background.pdf">slideshow with background info</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change log</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help"><li><a class="dropdown-item" href="../articles/help.html">Need help?</a></li>
    <li><a class="dropdown-item" href="../articles/want_to_help.html">Want to help?</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../mailto:jisca.huisman@gmail.com" aria-label="email"><span class="fa fas fa-envelope"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JiscaH/sequoia" aria-label="github"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca" aria-label="mastodon"><span class="fa fab fa-mastodon"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/" aria-label="linkedin"><span class="fa fab fa-linkedin-in"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Likelihoods for Alternative Relationships</h1>

      <div class="d-none name"><code>CalcPairLL.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For each specified pair of individuals, calculate the
  log10-likelihoods of being PO, FS, HS, GP, FA, HA, U (see Details).
  Individuals must be genotyped or have at least one genotyped offspring.</p>
<p><strong>NOTE</strong> values \(&gt;0\) are various <code>NA</code> types, see 'Likelihood
  special codes' in 'Value' section below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CalcPairLL</span><span class="op">(</span></span>
<span>  Pairs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  GenoM <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Pedigree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  LifeHistData <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  AgePrior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  SeqList <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Module <span class="op">=</span> <span class="st">"ped"</span>,</span>
<span>  Complex <span class="op">=</span> <span class="st">"full"</span>,</span>
<span>  Herm <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>  InclDup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Err <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  ErrFlavour <span class="op">=</span> <span class="st">"version2.9"</span>,</span>
<span>  Tassign <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  Tfilter <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pairs">Pairs<a class="anchor" aria-label="anchor" href="#arg-pairs"></a></dt>
<dd><p>dataframe with columns <code>ID1</code> and <code>ID2</code>, and
 optionally</p><dl><dt>Sex1</dt>
<dd><p>Sex of ID1, 1=female, 2=male, 3=unknown, or <code>NA</code> to take
  from <code>LifeHistData</code>. The sex of individuals occurring as parent in
  <code>Pedigree</code> cannot be altered.</p></dd>

<dt>Sex2</dt>
<dd><p>Sex of ID2</p></dd>

<dt>AgeDif</dt>
<dd><p>Age difference in whole time units, BirthYear1 - BirthYear2
  (i.e. positive if ID2 is born before ID1). If <code>NA</code>, calculated from
  <code>LifeHistData</code>. Use '999' to explicitly specify 'unknown'.</p></dd>

<dt>focal</dt>
<dd><p>relationship character abbreviation; PO, FS, HS, GP or U. See
Details for its effect and explanation of abbreviations. Default: U.</p></dd>

<dt>patmat</dt>
<dd><p>1=maternal relatives, 2=paternal relatives. Only relevant for
  HS &amp; GP, for which it defaults to Sex1, or 1 if Sex1=3, but is currently
  only predictably implemented for pairs of two genotyped individuals.
  Always equal to Sex2 for PO pairs when Sex2 is known.</p></dd>

<dt>dropPar1</dt>
<dd><p>Drop the parents of <code>ID1</code> before calculating the pair
likelihood, rather than conditioning on them; choose from 'none', 'dam',
'sire', or 'both'. See example. If e.g. the pair shares a common mother,
'none' and 'sire' will condition on this shared mother and not calculate the
likelihood that they are maternal siblings, while dropPar1='dam' or 'both'
will calculate that likelihood, and the other likelihoods as if the mother
of ID1 were unknown.</p></dd>

<dt>dropPar2</dt>
<dd><p>as <code>dropPar1</code>, for <code>ID2</code></p></dd>


</dl></dd>


<dt id="arg-genom">GenoM<a class="anchor" aria-label="anchor" href="#arg-genom"></a></dt>
<dd><p>numeric matrix with genotype data: One row per individual,
one column per SNP, coded as 0, 1, 2, missing values as a negative number
or NA. You can reformat data with <code><a href="GenoConvert.html">GenoConvert</a></code>, or use other
packages to get it into a genlight object and then use <code>as.matrix</code>.</p></dd>


<dt id="arg-pedigree">Pedigree<a class="anchor" aria-label="anchor" href="#arg-pedigree"></a></dt>
<dd><p>dataframe with columns id-dam-sire; likelihoods will be
calculated conditional on the pedigree. May include non-genotyped
individuals, which will be treated as dummy individuals.</p></dd>


<dt id="arg-lifehistdata">LifeHistData<a class="anchor" aria-label="anchor" href="#arg-lifehistdata"></a></dt>
<dd><p>data.frame with up to 6 columns:</p><dl><dt>ID</dt>
<dd><p>max. 30 characters long</p></dd>

 <dt>Sex</dt>
<dd><p>1 = female, 2 = male, 3 = unknown, 4 = hermaphrodite,
           other numbers or NA = unknown</p></dd>

<dt>BirthYear </dt>
<dd><p>birth or hatching year, integer, with missing values as NA
  or any negative number.</p></dd>

<dt>BY.min</dt>
<dd><p>minimum birth year, only used if BirthYear is missing</p></dd>

<dt>BY.max</dt>
<dd><p>maximum birth year, only used if BirthYear is missing</p></dd>

<dt>Year.last</dt>
<dd><p>Last year in which individual could have had offspring. Can
  e.g. in mammals be the year before death for females, and year after death
  for males.</p></dd>

</dl><p>"Birth year" may be in any arbitrary discrete time unit relevant to the
species (day, month, decade), as long as parents are never born in the same
time unit as their offspring, and only integers are used. Individuals do not
need to be in the same order as in `GenoM', nor do all genotyped individuals
need to be included.</p></dd>


<dt id="arg-ageprior">AgePrior<a class="anchor" aria-label="anchor" href="#arg-ageprior"></a></dt>
<dd><p>logical (<code>TRUE/FALSE</code>) whether to estimate the ageprior
from <code>Pedigree</code> and <code>LifeHistData</code>, or a matrix as generated by
<code><a href="MakeAgePrior.html">MakeAgePrior</a></code> and included in the <code><a href="sequoia.html">sequoia</a></code>
output. The <code>AgePrior</code> affects which relationships are considered
possible: only those where \(P(A|R) / P(A) &gt; 0\).  When <code>TRUE</code>,
<code><a href="MakeAgePrior.html">MakeAgePrior</a></code> is called using its default values. When
<code>FALSE</code>, all relationships are considered possible for all age
differences, except that parent-offspring pairs cannot have age difference
zero, and grand-parental pairs have an age difference of at least two.</p></dd>


<dt id="arg-seqlist">SeqList<a class="anchor" aria-label="anchor" href="#arg-seqlist"></a></dt>
<dd><p>list with output from <code><a href="sequoia.html">sequoia</a></code>. If input
parameter <code>Pedigree=NULL</code>, <code>SeqList$Pedigree</code> will be used if
present, and <code>SeqList$PedigreePar</code> otherwise. If <code>SeqList$Specs</code>
is present, input parameters with the same name as its items are ignored.
The list elements 'LifeHist', 'AgePriors', and 'ErrM' are also used if
present, and override the corresponding input parameters.</p></dd>


<dt id="arg-module">Module<a class="anchor" aria-label="anchor" href="#arg-module"></a></dt>
<dd><p>if <code>ped</code> (full pedigree), turn any non-genotyped parents
in <code>Pedigree</code> into dummies to condition upon. If <code>par</code>, ignore
any non-genotyped parents.</p></dd>


<dt id="arg-complex">Complex<a class="anchor" aria-label="anchor" href="#arg-complex"></a></dt>
<dd><p>Breeding system complexity. Either "full" (default), "simp"
(simplified, no explicit consideration of inbred relationships), "mono"
(monogamous).</p></dd>


<dt id="arg-herm">Herm<a class="anchor" aria-label="anchor" href="#arg-herm"></a></dt>
<dd><p>Hermaphrodites, either "no", "A" (distinguish between dam and
sire role, default if at least 1 individual with sex=4), or "B" (no
distinction between dam and sire role). Both of the latter deal with
selfing.</p></dd>


<dt id="arg-incldup">InclDup<a class="anchor" aria-label="anchor" href="#arg-incldup"></a></dt>
<dd><p>logical, include the likelihood for the two samples to be
duplicates (originating from the same individual) in the output?</p></dd>


<dt id="arg-err">Err<a class="anchor" aria-label="anchor" href="#arg-err"></a></dt>
<dd><p>assumed per-locus genotyping error rate, as a single number, or a
length 3 vector with P(hom|hom), P(het|hom), P(hom|het), or a 3x3 matrix.
See details below. The error rate is presumed constant across SNPs, and
missingness is presumed random with respect to actual genotype. Using
<code>Err</code> &gt;5% is not recommended, and <code>Err</code> &gt;10% strongly
discouraged. See <code><a href="Err_RADseq.html">Err_RADseq</a></code> to convert per-allele rates at
homozygous and heterozygous sites to the required length-3 vector, and
<code><a href="ErrToM.html">ErrToM</a></code> for further genotyping error details.</p></dd>


<dt id="arg-errflavour">ErrFlavour<a class="anchor" aria-label="anchor" href="#arg-errflavour"></a></dt>
<dd><p>function that takes <code>Err</code> (single number) as input,
and returns a length 3 vector or 3x3 matrix, or choose from inbuilt options
'version2.9', 'version2.0', 'version1.3', or 'version1.1', referring to the
sequoia version in which they were the default. Ignored if <code>Err</code> is a
vector or matrix.</p></dd>


<dt id="arg-tassign">Tassign<a class="anchor" aria-label="anchor" href="#arg-tassign"></a></dt>
<dd><p>minimum LLR required for acceptance of proposed relationship,
relative to next most likely relationship. Higher values result in more
conservative assignments. Must be zero or positive.</p></dd>


<dt id="arg-tfilter">Tfilter<a class="anchor" aria-label="anchor" href="#arg-tfilter"></a></dt>
<dd><p>threshold log10-likelihood ratio (LLR) between a proposed
relationship versus unrelated, to select candidate relatives. Typically a
negative value, related to the fact that unconditional likelihoods are
calculated during the filtering steps. More negative values may decrease
non-assignment, but will increase computational time.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>logical, suppress messages</p></dd>


<dt id="arg-plot">Plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical, display scatter plots by <code><a href="PlotPairLL.html">PlotPairLL</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <code>Pairs</code> dataframe including all optional columns listed
  above, plus the additional columns:</p>
<dl><dt>xx</dt>
<dd><p>Log10-Likelihood of this pair having relationship xx, with xx
   being the relationship abbreviations listed below.</p></dd>

 <dt>TopRel</dt>
<dd><p>Abbreviation of most likely relationship</p></dd>

 <dt>LLR</dt>
<dd><p>Log10-Likelihood ratio between most-likely and second most likely
   relationships. Other LLRs, e.g. between most-likely and unrelated, can
   easily be computed.</p></dd>


</dl><p><strong>Relationship abbreviations:</strong></p>
<dl><dt>PO</dt>
<dd><p>Parent - offspring</p></dd>

  <dt>FS</dt>
<dd><p>Full siblings</p></dd>

  <dt>HS</dt>
<dd><p>Half siblings</p></dd>

  <dt>GP</dt>
<dd><p>Grandparent</p></dd>

  <dt>FA</dt>
<dd><p>Full avuncular</p></dd>

  <dt>HA</dt>
<dd><p>Half avuncular and other 3rd degree relationships</p></dd>

  <dt>U</dt>
<dd><p>Unrelated</p></dd>

  <dt>2nd</dt>
<dd><p>Unclear which type of 2nd degree relatives
    (HS, GP, or FA)</p></dd>

  <dt>??</dt>
<dd><p>Unclear which type of 1st, 2nd or 3rd degree
    relatives</p></dd>


</dl><p><strong>Likelihood special codes:</strong></p>
<dl><dt>222</dt>
<dd><p>Maybe (via) other parent (e.g. focal="GP", but as likely to be
    maternal as paternal grandparent, and therefore not assignable)</p></dd>

  <dt>333</dt>
<dd><p>Excluded from comparison (shouldn't occur)</p></dd>

  <dt>444</dt>
<dd><p>Not implemented (e.g. would create an odd double/triple
    relationship in combination with the provided pedigree)</p></dd>

  <dt>777</dt>
<dd><p>Impossible (e.g. a male (Sex2=2) cannot be mother (patmat=1))</p></dd>

  <dt>888</dt>
<dd><p>Already assigned in the provided pedigree (see <code>dropPar</code>
    arguments)</p></dd>

  <dt>999</dt>
<dd><p><code>NA</code>. If all values for the pair are <code>999</code>, one or both
    individuals are not genotyped and not dummifiable.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The same pair may be included multiple times, e.g. with different
  sex, age difference, or focal relationship, to explore their effect on the
  likelihoods. Likelihoods are only calculated for relationships that are
  possible given the age difference, e.g. PO (parent-offspring) is not
  calculated for pairs with an age difference of 0.</p>
<p>Non-genotyped individuals can be included if they have at least one
  genotyped offspring and can be turned into a dummy (see
  <code><a href="getAssignCat.html">getAssignCat</a></code>); to establish this a pedigree must be provided.</p>
<p><strong>Warning 1</strong>: There is no check whether the input pedigree is genetically
  sensible, it is simply conditioned upon. Checking whether a pedigree is
  compatible with the SNP data can be done with <code><a href="CalcOHLLR.html">CalcOHLLR</a></code>.</p>
<p><strong>Warning 2</strong>: Conditioning on a <code>Pedigree</code> can make computation
  orders of magnitude slower.</p>
    </div>
    <div class="section level2">
    <h2 id="why-does-it-say-no-can-do-for-all-relationships-">Why does it say 444 (no can do) for all relationships?<a class="anchor" aria-label="anchor" href="#why-does-it-say-no-can-do-for-all-relationships-"></a></h2>


<p>This happens when the pair does not pass the initial check which prevents
 impossible configurations in combination with <code>Pedigree</code>. Specifically,
 it happens when either or both individuals are a parent in the pedigree, but</p><ul><li><p>the sex in <code>Pairs</code> is not consistent with that</p></li>
<li><p><code>Pairs</code> changes the age differences; it is too complex to check
   whether or not this still makes all pedigree links valid. Only setting the
   age difference to 'unknown' via <code>Pairs</code> is possible.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="why-does-it-say-impossible-">Why does it say 777 (impossible)?<a class="anchor" aria-label="anchor" href="#why-does-it-say-impossible-"></a></h2>


<p>This function uses the same machinery as <code>sequoia</code>, which will to save
  time not calculate the likelihood when it is quickly obvious that the pair
  cannot be related in the specified manner.</p>
<p>For PO (putative parent-offspring pairs) this is the case when:</p><ul><li><p>the sex of the candidate parent, via <code>Pairs$Sex2</code> or
    <code>LifeHistData</code>, does not match <code>Pairs$patmat</code>, which defaults
    to 1 (maternal relatives, i.e. dam)</p></li>
<li><p>a dam is already assigned via <code>Pedigree</code> and <code>Pairs$dropPar1
    ='none'</code>, and <code>Pairs$patmat = 1</code></p></li>
<li><p>the age difference is zero or otherwise impossible according to the
    age prior. It is either calculated from <code>LifeHistData</code> or specified
    via <code>Pairs$AgeDif</code>. The <code>AgePrior</code> can be specified directly,
    be taken from <code>SeqList</code>, or calculated  automatically by
    <code><a href="MakeAgePrior.html">MakeAgePrior</a></code> when both <code>Pedigree</code> and
    <code>LifeHistData</code> are provided.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="double-relationships-amp-focal-relationship">Double relationships &amp; focal relationship<a class="anchor" aria-label="anchor" href="#double-relationships-amp-focal-relationship"></a></h2>


<p>Especially when Complex='full', not only the seven relationship
  alternatives listed above are considered, but a whole range of possible
  double and even triple relationships. For example, mother A and offspring B
  (PO) may also be paternal half-siblings (HS, A and A's mother mated with
  same male), grandmother and grand-offspring (GP, B's father is A's son), or
  paternal aunt (B's father is a full or half sib of A).</p>
<p>The likelihood reported as 'LL_PO' is the most-likely one of the possible
  alternatives, among those that are not impossible due to age differences or
  due to the pedigree (as reconstructed up to that point). Whether e.g. the
  likelihood to be both PO &amp; HS is counted as PO or as HS, depends on the
  situation and is determined by the variable 'focal': During parentage
  assignment, it is counted as PO but not HS, while during sibship
  clustering, it is counted as HS but not PO – not omitting from the
  alternative relationship would result in a deadlock.</p>
    </div>
    <div class="section level2">
    <h2 id="dummy-individuals">Dummy individuals<a class="anchor" aria-label="anchor" href="#dummy-individuals"></a></h2>


<p>For historical reasons, the relationships between a dummy ID1 and ID2 are
  reported *between the sibship and ID2*. So,</p><dl><dt>PO</dt>
<dd><p>ID2 replaces dummy ID1; or merge dummy ID2 with dummy ID1</p></dd>

 <dt>FS, HS</dt>
<dd><p>ID1 parent of ID2</p></dd>

 <dt>GP</dt>
<dd><p>ID2 parent of ID1</p></dd>

 <dt>FA,HA</dt>
<dd><p>ID2 FS resp. HS of ID1</p></dd>

</dl><p>If ID1 is genotyped and ID2 is a dummy, the relationships are as when ID2 is
 genotyped.</p>
<p>If you wish to retrieve likelihoods for a different set of relationships,
 please contact me at <a href="mailto:jisca.huisman@gmail.com">jisca.huisman@gmail.com</a> .</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PlotPairLL.html">PlotPairLL</a></code> to plot alternative relationship pairs from
  the output; <code><a href="LLtoProb.html">LLtoProb</a></code> to transform likelihoods to
  probabilities; <code><a href="CalcParentProbs.html">CalcParentProbs</a></code> which uses this function to
  calculate parental probabilities; <code><a href="GetRelM.html">GetRelM</a></code> to find all
  pairwise relatives according to the pedigree; <code><a href="GetMaybeRel.html">GetMaybeRel</a></code> to
  get likely relative pairs based on the genetic data.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Likelihoods depend on the presumed genotyping error rate:</span></span></span>
<span class="r-in"><span><span class="fu">CalcPairLL</span><span class="op">(</span>Pairs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID1<span class="op">=</span><span class="st">'i042_2003_F'</span>, ID2<span class="op">=</span><span class="st">'i015_2001_F'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           GenoM <span class="op">=</span> <span class="va">Geno_griffin</span>, Err <span class="op">=</span> <span class="fl">1e-7</span>, Plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Not conditioning on any pedigree</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ID1         ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 i042_2003_F i015_2001_F    3    3     NA     U      1     none     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PO      FS      HS      GP      FA      HA       U TopRel  LLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -319.07 -323.42 -319.01 -322.13 -321.05 -322.33 -337.08     HS 0.06</span>
<span class="r-in"><span><span class="fu">CalcPairLL</span><span class="op">(</span>Pairs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID1<span class="op">=</span><span class="st">'i042_2003_F'</span>, ID2<span class="op">=</span><span class="st">'i015_2001_F'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           GenoM <span class="op">=</span> <span class="va">Geno_griffin</span>, Err <span class="op">=</span> <span class="fl">1e-3</span>, Plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Not conditioning on any pedigree</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ID1         ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 i042_2003_F i015_2001_F    3    3     NA     U      1     none     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PO      FS      HS      GP      FA      HA       U TopRel  LLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -315.1 -323.38 -319.01 -322.11 -321.06 -322.36 -337.07     PO 3.91</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## likelihoods underlying parent LLR in pedigree:</span></span></span>
<span class="r-in"><span><span class="co"># Example: dams for bottom 3 individuals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">PedigreePar</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              id         dam        sire LLRdam LLRsire LLRpair OHdam OHsire</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140 i198_2010_M i166_2009_F        &lt;NA&gt;   8.62      NA      NA     1     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141 i199_2010_F i165_2009_F i141_2008_M  14.67    4.96   16.17     0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142 i200_2010_F i166_2009_F i142_2008_M  14.41    5.56   15.63     0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MEpair</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142      0</span>
<span class="r-in"><span><span class="co"># set up dataframe with these pairs. LLRdam &amp; LLRsire ignore any co-parent</span></span></span>
<span class="r-in"><span><span class="va">Pairs_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID1 <span class="op">=</span> <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">PedigreePar</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">140</span><span class="op">:</span><span class="fl">142</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                      ID2 <span class="op">=</span> <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">PedigreePar</span><span class="op">$</span><span class="va">dam</span><span class="op">[</span><span class="fl">140</span><span class="op">:</span><span class="fl">142</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                      focal <span class="op">=</span> <span class="st">"PO"</span>,</span></span>
<span class="r-in"><span>                      dropPar1 <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate LL's, conditional on the rest of the pedigree + age differences</span></span></span>
<span class="r-in"><span><span class="fu">CalcPairLL</span><span class="op">(</span><span class="va">Pairs_d</span>, GenoM <span class="op">=</span> <span class="va">Geno_griffin</span>, Err <span class="op">=</span> <span class="fl">1e-04</span>,</span></span>
<span class="r-in"><span>           LifeHistData <span class="op">=</span> <span class="va">LH_griffin</span>, Pedigree <span class="op">=</span> <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">PedigreePar</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Conditioning on pedigree with 142 individuals, 65 dams and 79 sires</span>
<span class="r-plt img"><img src="CalcPairLL-1.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Pedigree-based, overlapping generations, flattened, MaxAgeParent = 99,99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Transferring input pedigree ...</span>
<span class="r-plt img"><img src="CalcPairLL-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ID1         ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 i198_2010_M i166_2009_F    2    1      1    PO      1     both     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 i199_2010_F i165_2009_F    1    1      1    PO      1     both     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 i200_2010_F i166_2009_F    1    1      1    PO      1     both     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PO      FS      HS  GP      FA      HA       U TopRel   LLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -289.23 -374.32 -299.18 777 -297.85 -300.15 -310.28     PO  8.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -279.66 -359.15 -295.41 777 -294.33 -297.09 -310.77     PO 14.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -283.94 -363.30 -298.42 777 -298.35 -299.93 -312.93     PO 14.41</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LLR changes when ignoring age and/or pedigree, as different relationships</span></span></span>
<span class="r-in"><span><span class="co"># become (im)possible</span></span></span>
<span class="r-in"><span><span class="fu">CalcPairLL</span><span class="op">(</span><span class="va">Pairs_d</span>, GenoM <span class="op">=</span> <span class="va">Geno_griffin</span>, Err <span class="op">=</span> <span class="fl">1e-04</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Not conditioning on any pedigree</span>
<span class="r-plt img"><img src="CalcPairLL-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ID1         ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 i198_2010_M i166_2009_F    3    3     NA    PO      1     both     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 i199_2010_F i165_2009_F    3    3     NA    PO      1     both     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 i200_2010_F i166_2009_F    3    3     NA    PO      1     both     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PO      FS      HS      GP      FA      HA       U TopRel  LLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -308.78 -314.22 -312.81 -311.20 -313.25 -315.13 -329.70     PO 2.42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -304.43 -310.40 -311.86 -309.98 -313.78 -317.06 -335.69     PO 5.54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -303.14 -309.52 -310.47 -307.39 -311.26 -315.02 -332.35     PO 4.24</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LLRpair is calculated conditional on co-parent, and min. of dam &amp; sire LLR</span></span></span>
<span class="r-in"><span><span class="va">Pairs_d</span><span class="op">$</span><span class="va">dropPar1</span> <span class="op">&lt;-</span> <span class="st">'dam'</span></span></span>
<span class="r-in"><span><span class="va">Pairs_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID1 <span class="op">=</span> <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">PedigreePar</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">141</span><span class="op">:</span><span class="fl">142</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                      ID2 <span class="op">=</span> <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">PedigreePar</span><span class="op">$</span><span class="va">sire</span><span class="op">[</span><span class="fl">141</span><span class="op">:</span><span class="fl">142</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                      focal <span class="op">=</span> <span class="st">"PO"</span>,</span></span>
<span class="r-in"><span>                      dropPar1 <span class="op">=</span> <span class="st">'sire'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">CalcPairLL</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">Pairs_d</span>, <span class="va">Pairs_s</span><span class="op">)</span>, GenoM <span class="op">=</span> <span class="va">Geno_griffin</span>, Err <span class="op">=</span> <span class="fl">1e-04</span>,</span></span>
<span class="r-in"><span>           LifeHistData <span class="op">=</span> <span class="va">LH_griffin</span>, Pedigree <span class="op">=</span> <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">PedigreePar</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Conditioning on pedigree with 142 individuals, 65 dams and 79 sires</span>
<span class="r-plt img"><img src="CalcPairLL-4.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Pedigree-based, overlapping generations, flattened, MaxAgeParent = 99,99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Transferring input pedigree ...</span>
<span class="r-plt img"><img src="CalcPairLL-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ID1         ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 i198_2010_M i166_2009_F    2    1      1    PO      1      dam     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 i199_2010_F i165_2009_F    1    1      1    PO      1      dam     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 i200_2010_F i166_2009_F    1    1      1    PO      1      dam     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 i199_2010_F i141_2008_M    1    2      2    PO      2     sire     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 i200_2010_F i142_2008_M    1    2      2    PO      2     sire     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PO      FS      HS      GP      FA      HA       U TopRel   LLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 -289.23 -374.32 -299.18  777.00 -297.85 -300.15 -310.28     PO  8.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -239.97  777.00 -262.19  777.00 -259.82 -266.02 -282.76     PO 19.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -245.87  777.00 -265.52  777.00 -266.47 -271.87 -287.07     PO 19.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -235.68  777.00 -361.87 -251.85 -254.73 -263.57 -275.37     PO 16.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -240.97  777.00 -263.38 -256.61 -258.66 -263.96 -279.04     PO 15.63</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## likelihoods underlying LLR in getMaybeRel output:</span></span></span>
<span class="r-in"><span><span class="va">MaybeRel_griffin</span><span class="op">$</span><span class="va">MaybePar</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           ID1         ID2 TopRel  LLR OH BirthYear1 BirthYear2 AgeDif Sex1 Sex2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 i091_2005_F i118_2006_M     PO 8.55  0         NA         NA     NA    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 i127_2007_M i197_2010_F     PO 7.90  0         NA         NA     NA    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 i121_2007_M i175_2009_M     PO 7.85  0         NA         NA     NA    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 i030_2002_F i061_2004_F     PO 7.75  0         NA         NA     NA    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 i041_2003_F i080_2004_M     PO 7.71  0         NA         NA     NA    3    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SNPdBoth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      392</span>
<span class="r-in"><span><span class="va">FivePairs</span> <span class="op">&lt;-</span> <span class="va">MaybeRel_griffin</span><span class="op">$</span><span class="va">MaybePar</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"Sex1"</span>, <span class="st">"Sex2"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">PairLL</span> <span class="op">&lt;-</span> <span class="fu">CalcPairLL</span><span class="op">(</span>Pairs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">FivePairs</span>, focal <span class="op">=</span> <span class="st">"PO"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">FivePairs</span>, focal <span class="op">=</span> <span class="st">"HS"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">FivePairs</span>, focal <span class="op">=</span> <span class="st">"GP"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     GenoM <span class="op">=</span> <span class="va">Geno_griffin</span>, Plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Not conditioning on any pedigree</span>
<span class="r-in"><span><span class="va">PairLL</span><span class="op">[</span><span class="va">PairLL</span><span class="op">$</span><span class="va">ID1</span><span class="op">==</span><span class="st">"i121_2007_M"</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ID1         ID2 Sex1 Sex2 AgeDif focal patmat dropPar1 dropPar2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  i121_2007_M i175_2009_M    3    3     NA    PO      1     none     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  i121_2007_M i175_2009_M    3    3     NA    HS      1     none     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 i121_2007_M i175_2009_M    3    3     NA    GP      1     none     none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         PO      FS      HS      GP      FA      HA       U TopRel  LLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -313.21 -324.46 -321.90 -321.51 -322.83 -323.01 -337.98     PO 8.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  -313.21  222.00 -321.09 -321.51 -323.01 -321.90 -337.98     PO 7.88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 -313.21 -324.46 -321.09 -321.51 -322.83 -325.26 -337.98     PO 7.88</span>
<span class="r-in"><span><span class="co"># LL(FS)==222 : HSHA, HSGP, and/or FAHA more likely than FS</span></span></span>
<span class="r-in"><span><span class="co"># LL(GP) higher when focal=HS: GP via 'other' parent also considered</span></span></span>
<span class="r-in"><span><span class="co"># LL(FA) higher when focal=PO: FAHA, or FS of 'other' parent</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

