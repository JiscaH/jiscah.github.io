<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Perform pedigree reconstruction based on SNP data, including
  parentage assignment and sibship clustering."><title>Pedigree Reconstruction — sequoia • sequoia</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pedigree Reconstruction — sequoia"><meta property="og:description" content="Perform pedigree reconstruction based on SNP data, including
  parentage assignment and sibship clustering."><meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo_s.png"><meta property="og:image:alt" content="sequoia hexlogo"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@HuismanJisca"><meta name="twitter:site" content="@HuismanJisca"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href=".././index.html">
    <span class="fas fa fas fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/sequoia.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_main/book/sec-Background.html">Main vignette: User guide</a>
    <a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a>
    <a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a>
    <a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Change log</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/help.html">Help</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/performance_stats.html">Stats</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa fas fa-envelope"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JiscaH/sequoia">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca">
    <span class="fab fa fab fa-mastodon"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/HuismanJisca">
    <span class="fab fa fab fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Pedigree Reconstruction</h1>
      
      <div class="d-none name"><code>sequoia.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform pedigree reconstruction based on SNP data, including
  parentage assignment and sibship clustering.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sequoia</span><span class="op">(</span></span>
<span>  GenoM <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  LifeHistData <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  SeqList <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Module <span class="op">=</span> <span class="st">"ped"</span>,</span>
<span>  MaxSibIter <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  Err <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  ErrFlavour <span class="op">=</span> <span class="st">"version2.0"</span>,</span>
<span>  MaxMismatch <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Tfilter <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>  Tassign <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  MaxSibshipSize <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  DummyPrefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span>,</span>
<span>  Complex <span class="op">=</span> <span class="st">"full"</span>,</span>
<span>  Herm <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>  UseAge <span class="op">=</span> <span class="st">"yes"</span>,</span>
<span>  args.AP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Flatten <span class="op">=</span> <span class="cn">NULL</span>, Smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  FindMaybeRel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  CalcLLR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Plot <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>GenoM</dt>
<dd><p>numeric matrix with genotype data: One row per individual, and
one column per SNP, coded as 0, 1, 2 or -9 (missing). See also
<code><a href="GenoConvert.html">GenoConvert</a></code>.</p></dd>


<dt>LifeHistData</dt>
<dd><p>dataframe with 3 columns (optionally 5):</p><dl><dt>ID</dt>
<dd><p>max. 30 characters long</p></dd>

 <dt>Sex</dt>
<dd><p>1 = female, 2 = male, 3 = unknown, 4 = hermaphrodite,
           other numbers or NA = unknown</p></dd>

<dt>BirthYear </dt>
<dd><p>birth or hatching year, integer, with missing values as NA
  or any negative value.</p></dd>

<dt>BY.min</dt>
<dd><p>minimum birth year, only used if BirthYear is missing</p></dd>

<dt>BY.max</dt>
<dd><p>maximum birth year, only used if BirthYear is missing</p></dd>
 
</dl><p>If the species has multiple generations per year, use an integer coding such
that the candidate parents' `Birth year' is at least one smaller than their
putative offspring's. Column names are ignored, so ensure column order is ID
- sex - birth year (- BY.min - BY.max). Individuals do not need to be in the
same order as in `GenoM', nor do all genotyped individuals need to be
included.</p></dd>


<dt>SeqList</dt>
<dd><p>list with output from a previous run, to be re-used in the
current run. Used are elements `PedigreePar', `LifeHist', `AgePriors',
`Specs', and `ErrM', and these override the corresponding input parameters.
Not all of these elements need to be present, and all other elements are
ignored. If <code>SeqList$Specs</code> is provided, all  input parameters with
the same name as its items are ignored, except
<code>Module</code>/<code>MaxSibIter</code>.</p></dd>


<dt>Module</dt>
<dd><p>one of</p><dl><dt>pre</dt>
<dd><p>Only input check, return <code>SeqList$Specs</code></p></dd>

  <dt>dup</dt>
<dd><p>Also check for duplicate genotypes</p></dd>

  <dt>par</dt>
<dd><p>Also perform parentage assignment (genotyped parents to
    genotyped offspring)</p></dd>

  <dt>ped</dt>
<dd><p>(Also) perform full pedigree reconstruction, including
    sibship clustering and grandparent assignment. By far the most time
    consuming, and may take several hours for large datasets.</p></dd>


</dl><p>NOTE: <em>Until `MaxSibIter` is fully deprecated: if `MaxSibIter` differs
from the default (<code>42</code>), and `Module` equals the default
(<code>'ped'</code>), MaxSibIter overrides `Module`.</em></p></dd>


<dt>MaxSibIter</dt>
<dd><p><strong>[will be deprecated]</strong> number of iterations of
sibship clustering, including assignment of grandparents to sibships and
avuncular relationships between sibships. Clustering continues until
convergence or until MaxSibIter is reached. Set to 0 for parentage
assignment only.</p></dd>


<dt>Err</dt>
<dd><p>estimated genotyping error rate, as a single number or 3x3 matrix.
Details below. The error rate is presumed constant across SNPs, and
missingness is presumed random with respect to actual genotype. Using
<code>Err</code> &gt;5% is not recommended.</p></dd>


<dt>ErrFlavour</dt>
<dd><p>function that takes <code>Err</code> (single number) as input,
and returns a 3x3 matrix of observed (columns) conditional on actual (rows)
genotypes, or choose from inbuilt options 'version2.0', 'version1.3', or
'version1.1', referring to the sequoia version in which they were the
default. Ignored if <code>Err</code> is a matrix. See <code><a href="ErrToM.html">ErrToM</a></code>.</p></dd>


<dt>MaxMismatch</dt>
<dd><p><strong>DEPRECATED AND IGNORED</strong>. Now calculated
automatically using <code><a href="CalcMaxMismatch.html">CalcMaxMismatch</a></code>.</p></dd>


<dt>Tfilter</dt>
<dd><p>threshold log10-likelihood ratio (LLR) between a proposed
relationship versus unrelated, to select candidate relatives. Typically a
negative value, related to the fact that unconditional likelihoods are
calculated during the filtering steps. More negative values may decrease
non-assignment, but will increase computational time.</p></dd>


<dt>Tassign</dt>
<dd><p>minimum LLR required for acceptance of proposed relationship,
relative to next most likely relationship. Higher values result in more
conservative assignments. Must be zero or positive.</p></dd>


<dt>MaxSibshipSize</dt>
<dd><p>maximum number of offspring for a single individual (a
generous safety margin is advised).</p></dd>


<dt>DummyPrefix</dt>
<dd><p>character vector of length 2 with prefixes for dummy dams
(mothers) and sires (fathers); maximum 20 characters each. Length 3 vector
in case of hermaphrodites (or default prefix 'H').</p></dd>


<dt>Complex</dt>
<dd><p>Breeding system complexity. Either "full" (default), "simp"
(simplified, no explicit consideration of inbred relationships), "mono"
(monogamous).</p></dd>


<dt>Herm</dt>
<dd><p>Hermaphrodites, either "no", "A" (distinguish between dam and
sire role, default if at least 1 individual with sex=4), or "B" (no
distinction between dam and sire role). Both of the latter deal with
selfing.</p></dd>


<dt>UseAge</dt>
<dd><p>either "yes" (default), "no", or "extra" (additional rounds
with extra reliance on ageprior, may boost assignments but increased risk
of erroneous assignments); used during full reconstruction only.</p></dd>


<dt>args.AP</dt>
<dd><p>list with arguments to be passed on to
<code><a href="MakeAgePrior.html">MakeAgePrior</a></code>.</p></dd>


<dt>FindMaybeRel</dt>
<dd><p><strong>DEPRECATED AND IGNORED</strong>, advised to run
<code><a href="GetMaybeRel.html">GetMaybeRel</a></code> separately.</p></dd>


<dt>CalcLLR</dt>
<dd><p>TRUE/FALSE; calculate log-likelihood ratios for all assigned
parents (genotyped + dummy; parent vs. otherwise related). Time-consuming
in large datasets. Can be done separately with <code><a href="CalcOHLLR.html">CalcOHLLR</a></code>.</p></dd>


<dt>quiet</dt>
<dd><p>suppress messages: TRUE/FALSE/"verbose".</p></dd>


<dt>Plot</dt>
<dd><p>display plots from <code><a href="SnpStats.html">SnpStats</a>, <a href="MakeAgePrior.html">MakeAgePrior</a></code>,
and <code><a href="SummarySeq.html">SummarySeq</a></code>. Defaults (NULL) to TRUE when quiet=FALSE or
"verbose", and FALSE when quiet=TRUE. If you get error 'figure margins too
large', enlarge the plotting area (drag with mouse). Error 'invalid
graphics state' can be dealt with by clearing the plotting area with
dev.off().</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with some or all of the following components, depending on</p>
<p></p>
<p><code>Module</code>. All input except <code>GenoM</code> is included in the output.</p>
<dl><dt>AgePriors</dt>
<dd><p>Matrix with age-difference based probability ratios for
  each relationship, used for full pedigree reconstruction; see
  <code><a href="MakeAgePrior.html">MakeAgePrior</a></code> for details. When running only parentage
  assignment (<code>Module="par"</code>) the returned AgePriors has been updated to
  incorporate the information of the assigned parents, and is ready for use
  during full pedigree reconstruction.</p></dd>

<dt>args.AP</dt>
<dd><p>(input) arguments used to specify age prior matrix. If a
  custom ageprior was provided via <code>SeqList$AgePrior</code>, this matrix is
  returned instead</p></dd>

<dt>DummyIDs</dt>
<dd><p>Dataframe with pedigree for dummy individuals, as well as
their sex, estimated birth year (point estimate, upper and lower bound of
95% confidence interval; see also <code><a href="CalcBYprobs.html">CalcBYprobs</a></code>), number of
offspring, and offspring IDs. From version 2.1 onwards, this includes dummy
offspring.</p></dd>

<dt>DupGenotype</dt>
<dd><p>Dataframe, duplicated genotypes (with different IDs,
 duplicate IDs are not allowed). The specified number of maximum mismatches
  is used here too. Note that this dataframe may include pairs of closely
  related individuals, and monozygotic twins.</p></dd>

<dt>DupLifeHistID</dt>
<dd><p>Dataframe, row numbers of duplicated IDs in life
  history dataframe. For convenience only, but may signal a problem. The
  first entry is used.</p></dd>

<dt>ErrM</dt>
<dd><p>(input) Error matrix; probability of observed genotype (columns)
  conditional on actual genotype (rows)</p></dd>

<dt>ExcludedInd</dt>
<dd><p>Individuals in GenoM which were excluded because of a
  too low genotyping success rate (&lt;50%).</p></dd>

<dt>ExcludedSNPs</dt>
<dd><p>Column numbers of SNPs in GenoM which were excluded
  because of a too low genotyping success rate (&lt;10%).</p></dd>

<dt>LifeHist</dt>
<dd><p>(input) Dataframe with sex and birth year data. All missing
  birth years are coded as '-999', all missing sex as '3'.</p></dd>

<dt>LifeHistPar</dt>
<dd><p>LifeHist with additional columns 'Sexx' (inferred Sex when
assigned as part of parent-pair), 'BY.est' (mode of birth year probability
distribution), 'BY.lo' (lower limit of 95% highest density region), 'BY.hi'
(higher limit), inferred after parentage assignment. 'BY.est' is NA when the
probability distribution is flat between 'BY.lo' and 'BY.hi'.</p></dd>

<dt>LifeHistSib</dt>
<dd><p>as LifeHistPar, but estimated after full pedigree
reconstruction</p></dd>

<dt>NoLH</dt>
<dd><p>Vector, IDs in genotype data for which no life history data is
 provided.</p></dd>

<dt>Pedigree</dt>
<dd><p>Dataframe with assigned genotyped and dummy parents from
  Sibship step; entries for dummy individuals are added at the bottom.</p></dd>

<dt>PedigreePar</dt>
<dd><p>Dataframe with assigned parents from Parentage step.</p></dd>

<dt>Specs</dt>
<dd><p>Named vector with parameter values.</p></dd>

<dt>TotLikParents</dt>
<dd><p>Numeric vector, Total likelihood of the genotype data
  at initiation and after each iteration during Parentage.</p></dd>

<dt>TotLikSib</dt>
<dd><p>Numeric vector, Total likelihood of the genotype data
  at initiation and after each iteration during Sibship clustering.</p></dd>

<dt>AgePriorExtra</dt>
<dd><p>As AgePriors, but including columns for grandparents
 and avuncular pairs. NOT updated after parentage assignment, but returned
 as used during the run.</p></dd>

<dt>DummyClones</dt>
<dd><p>Hermaphrodites only: female-male dummy ID pairs that refer
  to the same non-genotyped individual</p></dd>


</dl><p>List elements PedigreePar and Pedigree both have the following columns:</p>
<dl><dt>id</dt>
<dd><p>Individual ID</p></dd>

 <dt>dam</dt>
<dd><p>Assigned mother, or NA</p></dd>

 <dt>sire</dt>
<dd><p>Assigned father, or NA</p></dd>

 <dt>LLRdam</dt>
<dd><p>Log10-Likelihood Ratio (LLR) of this female being the mother,
 versus the next most likely relationship between the focal individual and
 this female. See Details below for relationships considered, and see
 <code><a href="CalcPairLL.html">CalcPairLL</a></code> for underlying likelihood values and further
 details)</p></dd>

 <dt>LLRsire</dt>
<dd><p>idem, for male parent</p></dd>

 <dt>LLRpair</dt>
<dd><p>LLR for the parental pair, versus the next most likely
  configuration between the three individuals (with one or neither parent
  assigned)</p></dd>

 <dt>OHdam</dt>
<dd><p>Number of loci at which the offspring and mother are
   opposite homozygotes</p></dd>

 <dt>OHsire</dt>
<dd><p>idem, for father</p></dd>

 <dt>MEpair</dt>
<dd><p>Number of Mendelian errors between the offspring and the
   parent pair, includes OH as well as e.g. parents being opposing
   homozygotes, but the offspring not being a heterozygote. The offspring
   being OH with both parents is counted as 2 errors.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each pair of candidate relatives, the likelihoods are calculated
  of them being parent-offspring (PO), full siblings (FS), half siblings
  (HS), grandparent-grandoffspring (GG), full avuncular (niece/nephew -
  aunt/uncle; FA), half avuncular/great-grandparental/cousins (HA), or
  unrelated (U). Assignments are made if the likelihood ratio (LLR) between
  the focal relationship and the most likely alternative exceed the threshold
  Tassign.</p>
<p>Dummy parents of sibships are denoted by F0001, F0002, ... (mothers)
  and M0001, M0002, ... (fathers), are appended to the bottom of the
  pedigree, and may have been assigned real or dummy parents themselves (i.e.
  sibship-grandparents). A dummy parent is not assigned to singletons.</p>
<p>The genotyping error rate `Err` is by default at locus level, not allele
  level: the probability to observe true homozygote <em>aa</em> as heterozygote
  <em>Aa</em> is \(\approx E\), and as alternate homozygote <em>AA</em>
  \((E/2)^2\); the probability to observe a true heterozygote as <em>aa</em>
  = the probability to observe it as <em>AA</em> \(= E/2\). This error
  structure can be fully customised by providing a 3x3 matrix of observed
  genotype (columns) conditional on actual genotype (rows) instead, see
  <code><a href="ErrToM.html">ErrToM</a></code> for examples.</p>
<p>Full explanation of the various options and interpretation of the output is
  provided in the vignette and on the package website,
  https://jiscah.github.io/index.html .</p>
    </div>
    <div class="section level2">
    <h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a></h2>
    

<p>While every effort has been made to ensure that sequoia provides what it
claims to do, there is absolutely no guarantee that the results provided are
correct. Use of sequoia is entirely at your own risk.</p>
    </div>
    <div class="section level2">
    <h2 id="-too-few-assignments-">(Too) Few Assignments?<a class="anchor" aria-label="anchor" href="#-too-few-assignments-"></a></h2>
    

<p>Possibly <code>Err</code> is much lower than the actual genotyping error rate.</p>
<p>Alternatively, a true parent will not be assigned when it is:</p><ul><li><p>unclear who is the parent and who the offspring, due to unknown birth
  year for one or both individuals</p></li>
<li><p>unclear whether the parent is the father or mother</p></li>
<li><p>unclear if it is a parent or e.g. full sibling or grandparent, due to
  insufficient genetic data</p></li>
</ul><p>And true half-siblings will not be clustered when it is:</p><ul><li><p>unclear if they are maternal or paternal half-siblings</p></li>
<li><p>unclear if they are half-siblings, full avuncular, or grand-parental</p></li>
<li><p>unclear what type of relatives they are due to insufficient genetic
   data</p></li>
</ul><p>All pairs of non-assigned but likely/definitely relatives can be found with
 <code><a href="GetMaybeRel.html">GetMaybeRel</a></code>. For further information see the vignette.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Huisman, J. (2017) Pedigree reconstruction from SNP data:
  Parentage assignment, sibship clustering, and beyond. Molecular Ecology
  Resources 17:1009--1024.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="GenoConvert.html">GenoConvert</a></code> to read in various data formats,</p></li>
<li><p><code><a href="CheckGeno.html">CheckGeno</a></code>, <code><a href="SnpStats.html">SnpStats</a></code> to calculate
    missingness and allele frequencies,</p></li>
<li><p><code><a href="SimGeno.html">SimGeno</a></code>  to simulate SNP data from a pedigree</p></li>
<li><p><code><a href="MakeAgePrior.html">MakeAgePrior</a></code> to estimate effect of age on relationships,</p></li>
<li><p><code><a href="GetMaybeRel.html">GetMaybeRel</a></code> to find pairs of potential relatives,</p></li>
<li><p><code><a href="SummarySeq.html">SummarySeq</a></code> and <code><a href="PlotAgePrior.html">PlotAgePrior</a></code> to visualise
  results,</p></li>
<li><p><code><a href="sequoia_report.html">sequoia_report</a></code> for a summary report of input + results,</p></li>
<li><p><code><a href="GetRelM.html">GetRelM</a></code> to turn a pedigree into pairwise relationships,</p></li>
<li><p><code><a href="CalcOHLLR.html">CalcOHLLR</a></code> to calculate Mendelian errors and LLR for any
   pedigree,</p></li>
<li><p><code><a href="CalcPairLL.html">CalcPairLL</a></code> for likelihoods of various relationships
   between specific pairs,</p></li>
<li><p><code><a href="CalcBYprobs.html">CalcBYprobs</a></code> to estimate birth years,</p></li>
<li><p><code><a href="PedCompare.html">PedCompare</a></code> and <code><a href="ComparePairs.html">ComparePairs</a></code> to compare to
  two pedigrees,</p></li>
<li><p><code><a href="EstConf.html">EstConf</a></code> to estimate assignment errors,</p></li>
<li><p><code><a href="writeSeq.html">writeSeq</a></code> to save results,</p></li>
<li><p>vignette("sequoia") for detailed manual &amp; FAQ.</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jisca Huisman, <a href="mailto:jisca.huisman@gmail.com">jisca.huisman@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># ===  EXAMPLE 1: simulated data  ===</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SimGeno_example</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        V2 V3 V4 V5 V6 V7 V8 V9 V10 V11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a00013  0  0  0  1  0  0  0  1   0   2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a00008  1  1  1  1  2  1  1  1   1   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a00011  0  2  1  2  2  1  0  2   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a00023  0  0  1  1  1  0  0  0   2   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a00006  1  1  1  0  0  0  0  0   1   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a00004  0  1  1  1  2  1  1  0   0   1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">LH_HSg5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ID Sex BirthYear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 a00001   1      2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 a00002   1      2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 a00003   1      2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 a00004   1      2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 a00005   1      2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 a00006   1      2000</span>
<span class="r-in"><span><span class="co"># parentage assignment:</span></span></span>
<span class="r-in"><span><span class="va">SeqOUT</span> <span class="op">&lt;-</span> <span class="fu">sequoia</span><span class="op">(</span>GenoM <span class="op">=</span> <span class="va">SimGeno_example</span>, Err <span class="op">=</span> <span class="fl">0.005</span>,</span></span>
<span class="r-in"><span>                  LifeHistData <span class="op">=</span> <span class="va">LH_HSg5</span>, Module<span class="op">=</span><span class="st">"par"</span>, Plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Genotype matrix looks OK! There are  214  individuals and  200  SNPs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 2,2</span>
<span class="r-plt img"><img src="sequoia-1.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Duplicate check ~~~</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Parentage assignment ~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parentage ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -18301.94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post-parentage total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13484.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating birth years ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating parental LLR ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> assigned 130 dams and 167 sires to 214 individuals</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Possibly not all parents were assigned, consider running GetMaybeRel() to check</span>
<span class="r-plt img"><img src="sequoia-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">SeqOUT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "Specs"         "ErrM"          "args.AP"       "AgePriors"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "LifeHist"      "DupLifeHistID" "NoLH"          "PedigreePar"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "TotLikPar"     "AgePriorExtra" "LifeHistPar"  </span>
<span class="r-in"><span><span class="va">SeqOUT</span><span class="op">$</span><span class="va">PedigreePar</span><span class="op">[</span><span class="fl">34</span><span class="op">:</span><span class="fl">42</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id    dam   sire LLRdam LLRsire LLRpair OHdam OHsire MEpair</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 a01002   &lt;NA&gt;   &lt;NA&gt;     NA      NA      NA    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 b01003   &lt;NA&gt;   &lt;NA&gt;     NA      NA      NA    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 b01004   &lt;NA&gt;   &lt;NA&gt;     NA      NA      NA    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 a01005 a00013 b00001   2.03    3.80    6.31     1      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 b01006 a00013 b00001   1.66    3.11    5.79     1      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 b01007 a00013 b00001   1.31    2.93    4.53     1      0      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 a01008 a00013 b00001  -0.13    3.63    5.59     2      0      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 b01009 a00008 b00016   0.13    4.09    6.54     1      0      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 a01010 a00008 b00016   3.44    4.26    7.46     0      0      1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare to true (or old) pedigree:</span></span></span>
<span class="r-in"><span><span class="va">PC</span> <span class="op">&lt;-</span> <span class="fu"><a href="PedCompare.html">PedCompare</a></span><span class="op">(</span><span class="va">Ped_HSg5</span>, <span class="va">SeqOUT</span><span class="op">$</span><span class="va">PedigreePar</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sequoia-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">PC</span><span class="op">$</span><span class="va">Counts</span><span class="op">[</span><span class="st">"GG"</span>,,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class      dam sire</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total    130  170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Match    130  167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mismatch   0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P1only     0    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P2only     0    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># parentage assignment + full pedigree reconstruction:</span></span></span>
<span class="r-in"><span><span class="co"># (note: this can be rather time consuming)</span></span></span>
<span class="r-in"><span><span class="va">SeqOUT2</span> <span class="op">&lt;-</span> <span class="fu">sequoia</span><span class="op">(</span>GenoM <span class="op">=</span> <span class="va">SimGeno_example</span>, Err <span class="op">=</span> <span class="fl">0.005</span>,</span></span>
<span class="r-in"><span>                  LifeHistData <span class="op">=</span> <span class="va">LH_HSg5</span>, Module<span class="op">=</span><span class="st">"ped"</span>, quiet<span class="op">=</span><span class="st">"verbose"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Genotype matrix looks OK! There are  214  individuals and  200  SNPs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 2,2</span>
<span class="r-plt img"><img src="sequoia-4.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Duplicate check ~~~</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Parentage assignment ~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Counting opposing homozygous loci between all individuals ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parentage ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -18301.94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Round 01:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13484.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Round 02:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13484.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post-parentage total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13484.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating birth years ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating parental LLR ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> assigned 130 dams and 167 sires to 214 individuals</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span>
<span class="r-plt img"><img src="sequoia-5.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Full pedigree reconstruction ~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Counting opposing homozygous loci between all individuals ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sibships - Initial Total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13484.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parents pre-check ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13484.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Round 01 start ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Find pairs ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n pairs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  2.34375e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merge clusters ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sibship parent replacement...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parents &amp; grow clusters...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12315.7955      0.1875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Round 01 end, Total LogLik; time (sec):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12315.79551      0.71875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dams, sires for real indiv.:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 182 182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dummies:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Round 02 start ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Find pairs ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n pairs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merge clusters ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sibship parent replacement...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12315.79551      0.03125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sibship grandparents ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parents &amp; grow clusters...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12315.79551      0.03125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Round 02 end, Total LogLik; time (sec):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12315.79551      0.15625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dams, sires for real indiv.:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 182 182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dummies:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Round 03 start ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Find pairs ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n pairs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clustering ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grandparent - grandoffspring pairs ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12315.79551      0.03125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Merge clusters ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sibship parent replacement...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sibship grandparents ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12315.79551      0.03125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parents &amp; grow clusters...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total LL, time:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.56250e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Round 03 end, Total LogLik; time (sec):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.23158e+04  1.71875e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dams, sires for real indiv.:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 182 182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dummies:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating birth years ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating parental LLR ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> assigned 182 dams and 182 sires to 214 + 8 individuals (real + dummy)</span>
<span class="r-plt img"><img src="sequoia-6.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Possibly not all relatives were assigned, consider running GetMaybeRel() to check</span>
<span class="r-plt img"><img src="sequoia-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">SeqOUT2</span><span class="op">$</span><span class="va">Pedigree</span><span class="op">[</span><span class="fl">34</span><span class="op">:</span><span class="fl">42</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id    dam   sire LLRdam LLRsire LLRpair OHdam OHsire MEpair</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 a01002  F0002  M0001   4.11    3.34    7.74    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 b01003  F0002  M0001   5.28    1.96    5.26    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 b01004  F0002  M0001   4.25    3.29    5.82    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 a01005 a00013 b00001   4.48    6.40    8.53     1      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 b01006 a00013 b00001   3.82    6.66    7.83     1      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 b01007 a00013 b00001   3.63    5.30    6.58     1      0      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 a01008 a00013 b00001   3.65    5.13    8.06     2      0      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 b01009 a00008 b00016   4.66    4.10    6.54     1      0      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 a01010 a00008 b00016   5.85    4.99    7.66     0      0      1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">PC2</span> <span class="op">&lt;-</span> <span class="fu"><a href="PedCompare.html">PedCompare</a></span><span class="op">(</span><span class="va">Ped_HSg5</span>, <span class="va">SeqOUT2</span><span class="op">$</span><span class="va">Pedigree</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sequoia-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">PC2</span><span class="op">$</span><span class="va">Counts</span><span class="op">[</span><span class="st">"GT"</span>,,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class      dam sire</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total    182  182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Match    182  182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mismatch   0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P1only     0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P2only     0    0</span>
<span class="r-in"><span><span class="va">PC2</span><span class="op">$</span><span class="va">Counts</span><span class="op">[</span>,,<span class="st">"dam"</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cat  Total Match Mismatch P1only P2only</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GG   130   130        0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GD    52    52        0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GT   182   182        0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DG     0     0        0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DD     0     0        0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   DT     0     0        0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TT   960   182        0    778      0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># different kind of pedigree comparison:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ComparePairs.html">ComparePairs</a></span><span class="op">(</span>Ped1<span class="op">=</span><span class="va">Ped_HSg5</span>, Ped2<span class="op">=</span><span class="va">SeqOUT</span><span class="op">$</span><span class="va">PedigreePar</span>, patmat<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Ped2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ped1       M      P      O     FS    MHS    PHS      U      X</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   M      130      0      0      0      0      0      0    830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P        0    167      0      0      0      0      3    790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   FS       0      0      0    206     12     59     13   1310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MHS      0      0      0      0    217      0     97   1446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PHS      0      0      0      0      0    587     71   3022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   U        0      0      0      0      0      0  21229 469311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   X        0      0      0      0      0      0      0      0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># results overview:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="SummarySeq.html">SummarySeq</a></span><span class="op">(</span><span class="va">SeqOUT2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sequoia-9.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="sequoia-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="sequoia-11.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="sequoia-12.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="sequoia-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># important to run with approx. correct genotyping error rate:</span></span></span>
<span class="r-in"><span><span class="va">SeqOUT2.b</span> <span class="op">&lt;-</span> <span class="fu">sequoia</span><span class="op">(</span>GenoM <span class="op">=</span> <span class="va">SimGeno_example</span>, <span class="co">#  Err = 1e-4 by default</span></span></span>
<span class="r-in"><span>                  LifeHistData <span class="op">=</span> <span class="va">LH_HSg5</span>, Module<span class="op">=</span><span class="st">"ped"</span>, Plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Genotype matrix looks OK! There are  214  individuals and  200  SNPs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 2,2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Duplicate check ~~~</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Parentage assignment ~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parentage ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -18301.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post-parentage total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13816.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating birth years ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating parental LLR ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> assigned 122 dams and 159 sires to 214 individuals</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Full pedigree reconstruction ~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sibships - Initial Total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13816.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Round 01 end, Total LogLik; time (sec):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12605.70858      1.21875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dams, sires for real indiv.:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 179 180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Round 02 end, Total LogLik; time (sec):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12605.7086      0.1875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dams, sires for real indiv.:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 179 180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Round 03 end, Total LogLik; time (sec):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -12605.708581      0.203125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No. dams, sires for real indiv.:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 179 180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating birth years ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating parental LLR ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> assigned 179 dams and 180 sires to 214 + 12 individuals (real + dummy)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Possibly not all relatives were assigned, consider running GetMaybeRel() to check</span>
<span class="r-in"><span><span class="va">PC2.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="PedCompare.html">PedCompare</a></span><span class="op">(</span><span class="va">Ped_HSg5</span>, <span class="va">SeqOUT2.b</span><span class="op">$</span><span class="va">Pedigree</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sequoia-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">PC2.b</span><span class="op">$</span><span class="va">Counts</span><span class="op">[</span><span class="st">"GT"</span>,,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class      dam sire</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Total    182  182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Match    173  176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mismatch   6    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P1only     3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P2only     0    0</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># ===  EXAMPLE 2: real data  ===</span></span></span>
<span class="r-in"><span><span class="co"># ideally, select 400-700 SNPs: high MAF &amp; low LD</span></span></span>
<span class="r-in"><span><span class="co"># save in 0/1/2/NA format (PLINK's --recodeA)</span></span></span>
<span class="r-in"><span><span class="va">GenoM</span> <span class="op">&lt;-</span> <span class="fu"><a href="GenoConvert.html">GenoConvert</a></span><span class="op">(</span>InFile <span class="op">=</span> <span class="st">"inputfile_for_sequoia.raw"</span>,</span></span>
<span class="r-in"><span>                     InFormat <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span>  <span class="co"># can also do Colony format</span></span></span>
<span class="r-in"><span><span class="va">SNPSTATS</span> <span class="op">&lt;-</span> <span class="fu"><a href="SnpStats.html">SnpStats</a></span><span class="op">(</span><span class="va">GenoM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># perhaps after some data-cleaning:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">GenoM</span>, file<span class="op">=</span><span class="st">"MyGenoData.txt"</span>, row.names<span class="op">=</span><span class="cn">T</span>, col.names<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># later:</span></span></span>
<span class="r-in"><span><span class="va">GenoM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"MyGenoData.txt"</span>, row.names<span class="op">=</span><span class="fl">1</span>, header<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">LHdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"LifeHistoryData.txt"</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co"># ID-Sex-birthyear</span></span></span>
<span class="r-in"><span><span class="va">SeqOUT</span> <span class="op">&lt;-</span> <span class="fu">sequoia</span><span class="op">(</span><span class="va">GenoM</span>, <span class="va">LHdata</span>, Err<span class="op">=</span><span class="fl">0.005</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="SummarySeq.html">SummarySeq</a></span><span class="op">(</span><span class="va">SeqOUT</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="writeSeq.html">writeSeq</a></span><span class="op">(</span><span class="va">SeqOUT</span>, folder<span class="op">=</span><span class="st">"sequoia_output"</span><span class="op">)</span>  <span class="co"># several text files</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># runtime:</span></span></span>
<span class="r-in"><span><span class="va">SeqOUT</span><span class="op">$</span><span class="va">Specs</span><span class="op">$</span><span class="va">TimeEnd</span> <span class="op">-</span> <span class="va">SeqOUT</span><span class="op">$</span><span class="va">Specs</span><span class="op">$</span><span class="va">TimeStart</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

