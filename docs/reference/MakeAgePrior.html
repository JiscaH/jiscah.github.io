<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Age Priors — MakeAgePrior • sequoia</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Age Priors — MakeAgePrior"><meta name="description" content="Estimate probability ratios \(P(R|A) / P(R)\) for age
  differences A and five categories of parent-offspring and sibling
  relationships R."><meta property="og:description" content="Estimate probability ratios \(P(R|A) / P(R)\) for age
  differences A and five categories of parent-offspring and sibling
  relationships R."><meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo.png"><meta property="og:image:alt" content="sequoia hexlogo"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@HuismanJisca"><meta name="twitter:site" content="@HuismanJisca"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href=".././index.html" aria-label="home"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/sequoia.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_main/book/background.html">Main vignette: User guide</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a></li>
    <li><a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a></li>
    <li><a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/performance_stats.html">Performance Stats</a></li>
    <li><a class="dropdown-item" href="../reference/figures/Poster_sequoia_ESEB2017.pdf">poster</a></li>
    <li><a class="dropdown-item" href="../reference/figures/Slideshow_sequoia_background.pdf">slideshow with background info</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change log</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help"><li><a class="dropdown-item" href="../articles/help.html">Need help?</a></li>
    <li><a class="dropdown-item" href="../articles/want_to_help.html">Want to help?</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../mailto:jisca.huisman@gmail.com" aria-label="email"><span class="fa fas fa-envelope"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JiscaH/sequoia" aria-label="github"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca" aria-label="mastodon"><span class="fa fab fa-mastodon"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/" aria-label="linkedin"><span class="fa fab fa-linkedin-in"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Age Priors</h1>

      <div class="d-none name"><code>MakeAgePrior.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate probability ratios \(P(R|A) / P(R)\) for age
  differences A and five categories of parent-offspring and sibling
  relationships R.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MakeAgePrior</span><span class="op">(</span></span>
<span>  Pedigree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  LifeHistData <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MinAgeParent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MaxAgeParent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Discrete <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Flatten <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambdaNW <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span>,</span>
<span>  Smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Return <span class="op">=</span> <span class="st">"LR"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pedigree">Pedigree<a class="anchor" aria-label="anchor" href="#arg-pedigree"></a></dt>
<dd><p>dataframe with id - dam - sire in columns 1-3, and optional
column with birth years. Other columns are ignored.</p></dd>


<dt id="arg-lifehistdata">LifeHistData<a class="anchor" aria-label="anchor" href="#arg-lifehistdata"></a></dt>
<dd><p>dataframe with 3 or 5 columns: id - sex (not used) -
birthyear (optional columns BY.min - BY.max - YearLast not used), with
unknown birth years coded as negative numbers or NA. "Birth year" may be in
any arbitrary discrete time unit relevant to the species (day, month,
decade), as long as parents are never born in the same time unit as their
offspring. It may include individuals not in the pedigree, and not all
individuals in the pedigree need to be in LifeHistData.</p></dd>


<dt id="arg-minageparent">MinAgeParent<a class="anchor" aria-label="anchor" href="#arg-minageparent"></a></dt>
<dd><p>minimum age of a parent, a single number (min across
dams and sires) or a vector of length two (dams, sires). Defaults to 1.
When there is a conflict with the minimum age in the pedigree, the pedigree
takes precedent.</p></dd>


<dt id="arg-maxageparent">MaxAgeParent<a class="anchor" aria-label="anchor" href="#arg-maxageparent"></a></dt>
<dd><p>maximum age of a parent, a single number (max across
dams and sires) or a vector of length two (dams, sires). If NULL, it will
be set to latest - earliest birth year in <code>LifeHistData</code>, or estimated
from the pedigree if one is provided. See details below.</p></dd>


<dt id="arg-discrete">Discrete<a class="anchor" aria-label="anchor" href="#arg-discrete"></a></dt>
<dd><p>discrete generations? By default (NULL), discrete
generations are assumed if all parent-offspring pairs have an age
difference of 1, and all siblings an age difference of 0, and there are at
least 20 pairs of each category (mother, father, maternal sibling, paternal
sibling). Otherwise, overlapping generations are presumed. When
<code>Discrete=TRUE</code> (explicitly or deduced), <code>Smooth</code> and
<code>Flatten</code> are always automatically set to <code>FALSE</code>. Use
<code>Discrete=FALSE</code> to enforce (potential for) overlapping generations.</p></dd>


<dt id="arg-flatten">Flatten<a class="anchor" aria-label="anchor" href="#arg-flatten"></a></dt>
<dd><p>logical. To deal with small sample sizes for some or all
relationships, calculate weighed average between the observed age
difference distribution among relatives and a flat (0/1) distribution. When
<code>Flatten=NULL</code> (the default) automatically set to TRUE when there are
fewer than 20 parents with known age of either sex assigned, or fewer than
20 maternal or paternal siblings with known age difference. Also advisable
if the sampled relative pairs with known age difference are non-typical of
the pedigree as a whole.</p></dd>


<dt id="arg-lambdanw">lambdaNW<a class="anchor" aria-label="anchor" href="#arg-lambdanw"></a></dt>
<dd><p>control weighing factors when <code>Flatten=TRUE</code>. Weights
are calculated as \(W(R) = 1 - exp(-lambdaNW * N(R))\), where \(N(R)\)
is the number of pairs with relationship R for which the age difference is
known. Large values (&gt;0.2) put strong emphasis on the pedigree, small
values (&lt;0.0001) cause the pedigree to be ignored. Default results in
\(W=0.5\) for \(N=100\).</p></dd>


<dt id="arg-smooth">Smooth<a class="anchor" aria-label="anchor" href="#arg-smooth"></a></dt>
<dd><p>smooth the tails of and any dips in the distribution? Sets dips
(&lt;10% of average of neighbouring ages) to the average of the neighbouring
ages, sets the age after the end (oldest observed age) to LR(end)/2, and
assigns a small value (0.001) to the ages before the front (youngest
observed age) and after the new end. Peaks are not smoothed out, as these
are less likely to cause problems than dips, and are more likely to be
genuine characteristics of the species. Is set to <code>FALSE</code> when
generations do not overlap (<code>Discrete=TRUE</code>).</p></dd>


<dt id="arg-plot">Plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>plot a heatmap of the results?</p></dd>


<dt id="arg-return">Return<a class="anchor" aria-label="anchor" href="#arg-return"></a></dt>
<dd><p>return only a matrix with the likelihood-ratio \(P(A|R) /
P(A)\) (<code>"LR"</code>) or a list including also various intermediate
statistics (<code>"all"</code>) ?</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>suppress messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A matrix with the probability ratio of the age difference between two
  individuals conditional on them being a certain type of relative
  (\(P(A|R)\)) versus being a random draw from the sample (\(P(A)\)).
  Assuming conditional independence, this equals the probability ratio of
  being a certain type of relative conditional on the age difference, versus
  being a random draw.</p>
<p>The matrix has one row per age difference (0 - nAgeClasses) and five
  columns, one for each relationship type, with abbreviations:</p>
<dl><dt>M</dt>
<dd><p>Mothers</p></dd>

  <dt>P</dt>
<dd><p>Fathers</p></dd>

  <dt>FS</dt>
<dd><p>Full siblings</p></dd>

  <dt>MS</dt>
<dd><p>Maternal half-siblings</p></dd>

  <dt>PS</dt>
<dd><p>Paternal half-siblings</p></dd>


</dl><p>When <code>Return</code>='all', a list is returned with the following elements:</p>
<dl><dt>BirthYearRange</dt>
<dd><p>vector length 2</p></dd>

   <dt>MaxAgeParent</dt>
<dd><p>vector length 2, see details</p></dd>

   <dt>tblA.R</dt>
<dd><p>matrix with the counts per age difference (rows) /
     relationship (columns) combination, plus a column 'X' with age
     differences across all pairs of individuals</p></dd>

  <dt>PA.R</dt>
<dd><p>Proportions, i.e. <code>tblA.R</code> divided by its <code>colSums</code>,
    with full-sibling correction applied if necessary (see vignette).</p></dd>

   <dt>LR.RU.A.raw</dt>
<dd><p>Proportions <code>PA.R</code> standardised by global age
     difference distribution (column 'X'); <code>LR.RU.A</code> prior to flattening
     and smoothing</p></dd>

   <dt>Weights</dt>
<dd><p>vector length 4, the weights used to flatten the
    distributions</p></dd>

    <dt>LR.RU.A</dt>
<dd><p>the ageprior, flattened and/or smoothed</p></dd>

   <dt>Specs.AP</dt>
<dd><p>the names of the input <code>Pedigree</code> and
   <code>LifeHistData</code> (or <code>NULL</code>), <code>lambdaNW</code>, and the 'effective'
     settings (i.e. after any automatic update) of <code>Discrete</code>,
     <code>Smooth</code>, and <code>Flatten</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>\(\alpha_{A,R}\) is the ratio between the observed
  counts of pairs with age difference A and relationship R (\(N_{A,R}\)),
  and the expected counts if age and relationship were independent
  (\(N_{.,.}*p_A*p_R\)).</p>
<p>During pedigree reconstruction, \(\alpha_{A,R}\) are multiplied by the
  genetic-only \(P(R|G)\) to obtain a probability that the
  pair are relatives of type R conditional on both their age difference and
  their genotypes.</p>
<p>The age-difference prior is used for pairs of genotyped individuals, as
  well as for dummy individuals. This assumes that the propensity for a pair
  with a given age difference to both be sampled does not depend on their
  relationship, so that the ratio \(P(A|R) / P(A)\) does not differ between
  sampled and unsampled pairs.</p>
<p>For further details, see the vignette.</p>
    </div>
    <div class="section level2">
    <h2 id="caution">CAUTION<a class="anchor" aria-label="anchor" href="#caution"></a></h2>


<p>The small sample correction with <code>Smooth</code> and/or <code>Flatten</code>
  prevents errors in one dataset, but may introduce errors in another; a
  single solution that fits to the wide variety of life histories and
  datasets is impossible. Please do inspect the matrix, e.g. with
  <code>PlotAgePrior</code>, and adjust the input parameters and/or the output
  matrix as necessary.</p>
<p>A few outlier birth years can heavily influence the output; these may be
  easiest to spot with <code>Smooth=FALSE, Flatten=FALSE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="single-cohort">Single cohort<a class="anchor" aria-label="anchor" href="#single-cohort"></a></h2>


<p>When all individuals in <code>LifeHistData</code> have the same birth year, it is
  assumed that <code>Discrete=TRUE</code> and <code>MaxAgeParent=1</code>. Consequently,
  it is assumed there are no avuncular pairs present in the sample; cousins
  are considered as alternative. To enforce overlapping generations, and
  thereby the consideration of full- and half- avuncular relationships, set
  <code>MaxAgeParent</code> to some value greater than \(1\).</p>
<p>When no birth year information is given at all, a single cohort is assumed,
 and the same rules apply.</p>
    </div>
    <div class="section level2">
    <h2 id="other-time-units">Other time units<a class="anchor" aria-label="anchor" href="#other-time-units"></a></h2>


<p>"Birth year" may be in any arbitrary time unit relevant to the species
  (day, month, decade), as long as parents are always born before their
  putative offspring, and never in the same time unit (e.g. parent's
  BirthYear= 1 (or 2001) and offspring BirthYear=5 (or 2005)). Negative
  numbers and NA's are interpreted as unknown, and fractional numbers are not
  allowed.</p>
    </div>
    <div class="section level2">
    <h2 id="maxageparent">MaxAgeParent<a class="anchor" aria-label="anchor" href="#maxageparent"></a></h2>


<p>The maximum parental age for each sex equals the maximum of:</p><ul><li><p>the maximum age of parents in <code>Pedigree</code>,</p></li>
<li><p>the input parameter <code>MaxAgeParent</code>,</p></li>
<li><p>the maximum range of birth years in <code>LifeHistData</code> (including
     BY.min and BY.max). Only used if both of the previous are <code>NA</code>, or
     if there are fewer than 20 parents of either sex assigned.</p></li>
<li><p>1, if <code>Discrete=TRUE</code> or the previous three are all <code>NA</code></p></li>
</ul><p>If the age distribution of assigned parents does not capture the maximum
 possible age of parents, it is advised to specify <code>MaxAgeParent</code> for
 one or both sexes. Not doing so may hinder subsequent assignment of both
 dummy parents and grandparents. Not compatible with <code>Smooth</code>. If the
 largest age difference in the pedigree is larger than the specified
 <code>MaxAgeParent</code>, the pedigree takes precedent (i.e. the largest of the
 two is used).</p>
<p>@section grandparents &amp; avuncular
 The agepriors for grand-parental and avuncular pairs is calculated from
 these by <code><a href="sequoia.html">sequoia</a></code>, and included in its output as
 `AgePriorExtra`.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sequoia.html">sequoia</a></code> and its argument <code>args.AP</code>,
  <code><a href="PlotAgePrior.html">PlotAgePrior</a></code> for visualisation. The age vignette gives
  further details, mathematical justification, and some examples.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># without pedigree or lifehistdata:</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>MaxAgeParent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 2,3</span>
<span class="r-plt img"><img src="MakeAgePrior-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   M P FS MS PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0 0  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1 1  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0 1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0 0  0  0  0</span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>Discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span>
<span class="r-plt img"><img src="MakeAgePrior-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   M P FS MS PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0 0  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 0  0  0  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># single cohort:</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>LifeHistData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, Sex<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>  BirthYear<span class="op">=</span><span class="fl">1984</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   M P FS MS PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0 0  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 0  0  0  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># overlapping generations:</span></span></span>
<span class="r-in"><span><span class="co"># without pedigree: MaxAgeParent = max age difference between any pair +1</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>LifeHistData <span class="op">=</span> <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">LifeHist</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 10,10</span>
<span class="r-plt img"><img src="MakeAgePrior-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    M P FS MS PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0  0 0  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1 1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0 0  0  0  0</span>
<span class="r-in"><span><span class="co"># with pedigree:</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>Pedigree<span class="op">=</span><span class="va">Ped_griffin</span>,</span></span>
<span class="r-in"><span>             LifeHistData<span class="op">=</span><span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">LifeHist</span>,</span></span>
<span class="r-in"><span>             Smooth<span class="op">=</span><span class="cn">FALSE</span>, Flatten<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="MakeAgePrior-4.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Pedigree-based, overlapping generations, MaxAgeParent = 3,3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       M     P    FS    MS    PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0.000 0.000 4.810 4.117 3.684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.462 1.959 2.787 2.626 2.960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2.006 3.159 0.077 0.689 0.582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.340 0.959 0.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.000 0.000 0.000 0.000 0.000</span>
<span class="r-in"><span><span class="co"># with small-sample correction:</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>Pedigree<span class="op">=</span><span class="va">Ped_griffin</span>,</span></span>
<span class="r-in"><span>             LifeHistData<span class="op">=</span><span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">LifeHist</span>,</span></span>
<span class="r-in"><span>             Smooth<span class="op">=</span><span class="cn">TRUE</span>, Flatten<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="MakeAgePrior-5.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Pedigree-based, overlapping generations, flattened, smoothed, MaxAgeParent = 5,5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       M     P    FS    MS    PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0.000 0.000 2.659 3.419 2.799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.688 1.649 1.778 2.262 2.313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.690 2.461 0.598 0.759 0.720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.548 0.972 0.299 0.379 0.360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.274 0.486 0.001 0.001 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.001 0.001 0.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.000 0.000 0.000 0.000 0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Call from sequoia() via args.AP:</span></span></span>
<span class="r-in"><span><span class="va">Seq_HSg5</span> <span class="op">&lt;-</span> <span class="fu"><a href="sequoia.html">sequoia</a></span><span class="op">(</span><span class="va">SimGeno_example</span>, <span class="va">LH_HSg5</span>, Module<span class="op">=</span><span class="st">"par"</span>,</span></span>
<span class="r-in"><span>                args.AP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Discrete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,  <span class="co"># non-overlapping generations</span></span></span>
<span class="r-in"><span>                CalcLLR <span class="op">=</span> <span class="cn">FALSE</span>,   <span class="co"># skip time-consuming calculation of LLR's</span></span></span>
<span class="r-in"><span>                Plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>      <span class="co"># no summary plots when finished</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Checking input data ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Genotype matrix looks OK! There are  214  individuals and  200  SNPs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Among genotyped individuals: ___ </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> There are 106 females, 108 males, 0 of unknown sex, and 0 hermaphrodites.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Exact birth years are from 2000 to 2001</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ___</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Calling `MakeAgePrior()` ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">~~~ Duplicate check ~~~</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> No potential duplicates found</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">~~~ Parentage assignment ~~~</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Time    |  R |  Step      |  Progress  | Dams  | Sires |  GPs  |   Total LL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------- | -- | ---------- | ---------- | ----- | ----- | ----- | ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08:54:49 |  0 | initial    |            |     0 |     0 |     0 |   -18301.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08:54:49 |  0 | parents    |            |   126 |   165 |     0 |   -13690.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">assigned 126 dams and 165 sires to 214 individuals </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

