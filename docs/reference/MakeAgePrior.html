<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimate probability ratios \(P(R|A) / P(R)\) for age
  differences A and five categories of parent-offspring and sibling
  relationships R."><title>Age Priors — MakeAgePrior • sequoia</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Age Priors — MakeAgePrior"><meta property="og:description" content="Estimate probability ratios \(P(R|A) / P(R)\) for age
  differences A and five categories of parent-offspring and sibling
  relationships R."><meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo_s.png"><meta property="og:image:alt" content="sequoia hexlogo"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@HuismanJisca"><meta name="twitter:site" content="@HuismanJisca"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href=".././index.html">
    <span class="fas fa fas fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/sequoia.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-manuals">Manuals</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-manuals">
    <a class="dropdown-item" href="../articles/vignette_main/book/sec-Background.html">Main vignette: User guide</a>
    <a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a>
    <a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a>
    <a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Change log</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/help.html">Help</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/performance_stats.html">Stats</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa fas fa-envelope"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JiscaH/sequoia">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca">
    <span class="fab fa fab fa-mastodon"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/HuismanJisca">
    <span class="fab fa fab fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Age Priors</h1>
      
      <div class="d-none name"><code>MakeAgePrior.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate probability ratios \(P(R|A) / P(R)\) for age
  differences A and five categories of parent-offspring and sibling
  relationships R.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MakeAgePrior</span><span class="op">(</span></span>
<span>  Pedigree <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  LifeHistData <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MaxAgeParent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Discrete <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Flatten <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambdaNW <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span>,</span>
<span>  Smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Return <span class="op">=</span> <span class="st">"LR"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>Pedigree</dt>
<dd><p>dataframe with id - dam - sire in columns 1-3, and optional
column with birth years. Other columns are ignored.</p></dd>


<dt>LifeHistData</dt>
<dd><p>dataframe with 3 or 5 columns: id - sex (not used) -
birth year (- BY.min - BY.max), with unknown birth years coded as negative
numbers or NA. Column names are ignored, so the column order is important.
"Birth year" may be in any arbitrary discrete time unit relevant to the
species (day, month, decade), as long as parents are never born in the same
time unit as their offspring. It may include individuals not in the
pedigree, and not all individuals in the pedigree need to be in
LifeHistData.</p></dd>


<dt>MaxAgeParent</dt>
<dd><p>maximum age of a parent, a single number (max across
dams and sires) or a vector of length two (dams, sires). If NULL, it will
be estimated from the pedigree. See details below.</p></dd>


<dt>Discrete</dt>
<dd><p>discrete generations? By default (NULL), discrete
generations are assumed if all parent-offspring pairs have an age
difference of 1, and all siblings an age difference of 0, and there are at
least 20 pairs of each category (mother, father, maternal sibling, paternal
sibling). Otherwise, overlapping generations are presumed. When
<code>Discrete=TRUE</code> (explicitly or deduced), <code>Smooth</code> and
<code>Flatten</code> are always automatically set to <code>FALSE</code>. Use
<code>Discrete=FALSE</code> to enforce (potential for) overlapping generations.</p></dd>


<dt>Flatten</dt>
<dd><p>logical. To deal with small sample sizes for some or all
relationships, calculate weighed average between the observed age
difference distribution among relatives and a flat (0/1) distribution. When
<code>Flatten=NULL</code> (the default) automatically set to TRUE when there are
fewer than 20 parents with known age of either sex assigned, or fewer than
20 maternal or paternal siblings with known age difference. Also advisable
if the sampled relative pairs with known age difference are non-typical of
the pedigree as a whole.</p></dd>


<dt>lambdaNW</dt>
<dd><p>control weighing factors when <code>Flatten=TRUE</code>. Weights
are calculated as \(W(R) = 1 - exp(-lambdaNW * N(R))\), where \(N(R)\)
is the number of pairs with relationship R for which the age difference is
known. Large values (&gt;0.2) put strong emphasis on the pedigree, small
values (&lt;0.0001) cause the pedigree to be ignored. Default results in
\(W=0.5\) for \(N=100\).</p></dd>


<dt>Smooth</dt>
<dd><p>smooth the tails of and any dips in the distribution? Sets dips
(&lt;10% of average of neighbouring ages) to the average of the neighbouring
ages, sets the age after the end (oldest observed age) to LR(end)/2, and
assigns a small value (0.001) to the ages before the front (youngest
observed age) and after the new end. Peaks are not smoothed out, as these
are less likely to cause problems than dips, and are more likely to be
genuine characteristics of the species. Is set to <code>FALSE</code> when
generations do not overlap (<code>Discrete=TRUE</code>).</p></dd>


<dt>Plot</dt>
<dd><p>plot a heatmap of the results?</p></dd>


<dt>Return</dt>
<dd><p>return only a matrix with the likelihood-ratio \(P(A|R) /
P(A)\) (<code>"LR"</code>) or a list including also various intermediate
statistics (<code>"all"</code>) ?</p></dd>


<dt>quiet</dt>
<dd><p>suppress messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix with the probability ratio of the age difference between two
  individuals conditional on them being a certain type of relative
  (\(P(A|R)\)) versus being a random draw from the sample (\(P(A)\)).
  Assuming conditional independence, this equals the probability ratio of
  being a certain type of relative conditional on the age difference, versus
  being a random draw.</p>


<p>The matrix has one row per age difference (0 - nAgeClasses) and five
  columns, one for each relationship type, with abbreviations:</p>
<dl><dt>M</dt>
<dd><p>Mothers</p></dd>

  <dt>P</dt>
<dd><p>Fathers</p></dd>

  <dt>FS</dt>
<dd><p>Full siblings</p></dd>

  <dt>MS</dt>
<dd><p>Maternal half-siblings</p></dd>

  <dt>PS</dt>
<dd><p>Paternal half-siblings</p></dd>


</dl><p>When <code>Return</code>='all', a list is returned with the following elements:</p>
<dl><dt>BirthYearRange</dt>
<dd><p>vector length 2</p></dd>

   <dt>MaxAgeParent</dt>
<dd><p>vector length 2, see details</p></dd>

   <dt>tblA.R</dt>
<dd><p>matrix with the counts per age difference (rows) /
     relationship (columns) combination, plus a column 'X' with age
     differences across all pairs of individuals</p></dd>

  <dt>PA.R</dt>
<dd><p>Proportions, i.e. <code>tblA.R</code> divided by its <code>colSums</code>,
    with full-sibling correction applied if necessary (see vignette).</p></dd>

   <dt>LR.RU.A.raw</dt>
<dd><p>Proportions <code>PA.R</code> standardised by global age
     difference distribution (column 'X'); <code>LR.RU.A</code> prior to flattening
     and smoothing</p></dd>

   <dt>Weights</dt>
<dd><p>vector length 4, the weights used to flatten the
    distributions</p></dd>

    <dt>LR.RU.A</dt>
<dd><p>the ageprior, flattend and/or smoothed</p></dd>

   <dt>Specs.AP</dt>
<dd><p>the names of the input <code>Pedigree</code> and
   <code>LifeHistData</code> (or <code>NULL</code>), <code>lambdaNW</code>, and the 'effective'
     settings (i.e. after any automatic update) of <code>Discrete</code>,
     <code>Smooth</code>, and <code>Flatten</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>\(\alpha_{A,R}\) is the ratio between the observed
  counts of pairs with age difference A and relationship R (\(N_{A,R}\)),
  and the expected counts if age and relationship were independent
  (\(N_{.,.}*p_A*p_R\)).</p>
<p>During pedigree reconstruction, \(\alpha_{A,R}\) are multiplied by the
  genetic-only \(P(R|G)\) to obtain a probability that the
  pair are relatives of type R conditional on both their age difference and
  their genotypes.</p>
<p>The age-difference prior is used for pairs of genotyped individuals, as
  well as for dummy individuals. This assumes that the propensity for a pair
  with a given age difference to both be sampled does not depend on their
  relationship, so that the ratio \(P(A|R) / P(A)\) does not differ between
  sampled and unsampled pairs.</p>
<p>For further details, see the vignette.</p>
    </div>
    <div class="section level2">
    <h2 id="caution">CAUTION<a class="anchor" aria-label="anchor" href="#caution"></a></h2>
    

<p>The small sample correction with <code>Smooth</code> and/or <code>Flatten</code>
  prevents errors in one dataset, but may introduce errors in another; a
  single solution that fits to the wide variety of life histories and
  datasets is impossible. Please do inspect the matrix, e.g. with
  <code>PlotAgePrior</code>, and adjust the input parameters and/or the output
  matrix as necessary.</p>
    </div>
    <div class="section level2">
    <h2 id="single-cohort">Single cohort<a class="anchor" aria-label="anchor" href="#single-cohort"></a></h2>
    

<p>When all individuals in <code>LifeHistData</code> have the same birth year, it is
  assumed that <code>Discrete=TRUE</code> and <code>MaxAgeParent=1</code>. Consequently,
  it is assumed there are no avuncular pairs present in the sample; cousins
  are considered as alternative. To enforce overlapping generations, and
  thereby the consideration of full- and half- avuncular relationships, set
  <code>MaxAgeParent</code> to some value greater than \(1\).</p>
<p>When no birth year information is given at all, a single cohort is assumed,
 and the same rules apply.</p>
    </div>
    <div class="section level2">
    <h2 id="other-time-units">Other time units<a class="anchor" aria-label="anchor" href="#other-time-units"></a></h2>
    

<p>"Birth year" may be in any arbitrary time unit relevant to the species
  (day, month, decade), as long as parents are always born before their
  putative offspring, and never in the same time unit (e.g. parent's
  BirthYear= 1 (or 2001) and offspring BirthYear=5 (or 2005)). Negative
  numbers and NA's are interpreted as unknown, and fractional numbers are not
  allowed.</p>
    </div>
    <div class="section level2">
    <h2 id="maxageparent">MaxAgeParent<a class="anchor" aria-label="anchor" href="#maxageparent"></a></h2>
    

<p>The maximum parental age for each sex equals the maximum of:</p><ul><li><p>the maximum age of parents in <code>Pedigree</code>,</p></li>
<li><p>the input parameter <code>MaxAgeParent</code>,</p></li>
<li><p>the maximum range of birth years in <code>LifeHistData</code> (including
     BY.min and BY.max). Only used if both of the previous are <code>NA</code>, or
     if there are fewer than 20 parents of either sex assigned.</p></li>
<li><p>1, if <code>Discrete=TRUE</code> or the previous three are all <code>NA</code></p></li>
</ul><p>If the age distribution of assigned parents does not capture the maximum
 possible age of parents, it is advised to specify <code>MaxAgeParent</code> for
 one or both sexes. Not doing so may hinder subsequent assignment of both
 dummy parents and grandparents. Not compatible with <code>Smooth</code>.</p>
<p>@section grandparents &amp; avuncular
 The agepriors for grand-parental and avuncular pairs is calculated from
 these by <code><a href="sequoia.html">sequoia</a></code>, and included in its output as
 `AgePriorExtra`.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sequoia.html">sequoia</a></code> and its argument <code>args.AP</code>,
  <code><a href="PlotAgePrior.html">PlotAgePrior</a></code> for visualisation. The age vignette gives
  further details, mathematical justification, and some examples.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># without pedigree or lifehistdata:</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>MaxAgeParent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 2,3</span>
<span class="r-plt img"><img src="MakeAgePrior-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   M P FS MS PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0 0  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1 1  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0 1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0 0  0  0  0</span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>Discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span>
<span class="r-plt img"><img src="MakeAgePrior-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   M P FS MS PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0 0  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 0  0  0  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># single cohort:</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>LifeHistData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, Sex<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>  BirthYear<span class="op">=</span><span class="fl">1984</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   M P FS MS PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0 0  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 0  0  0  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># overlapping generations:</span></span></span>
<span class="r-in"><span><span class="co"># without pedigree: MaxAgeParent = max age difference between any pair +1</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>LifeHistData <span class="op">=</span> <span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">LifeHist</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 10,10</span>
<span class="r-plt img"><img src="MakeAgePrior-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    M P FS MS PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0  0 0  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1 1  1  1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1 1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0 0  0  0  0</span>
<span class="r-in"><span><span class="co"># with pedigree:</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>Pedigree<span class="op">=</span><span class="va">Ped_griffin</span>,</span></span>
<span class="r-in"><span>             LifeHistData<span class="op">=</span><span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">LifeHist</span>,</span></span>
<span class="r-in"><span>             Smooth<span class="op">=</span><span class="cn">FALSE</span>, Flatten<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Pedigree-based, overlapping generations, MaxAgeParent = 3,3</span>
<span class="r-plt img"><img src="MakeAgePrior-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       M     P    FS    MS    PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0.000 0.000 5.043 4.316 3.862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.476 1.967 2.798 2.636 2.971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2.011 3.167 0.077 0.691 0.583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.340 0.959 0.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.000 0.000 0.000 0.000 0.000</span>
<span class="r-in"><span><span class="co"># with small-sample correction:</span></span></span>
<span class="r-in"><span><span class="fu">MakeAgePrior</span><span class="op">(</span>Pedigree<span class="op">=</span><span class="va">Ped_griffin</span>,</span></span>
<span class="r-in"><span>             LifeHistData<span class="op">=</span><span class="va">SeqOUT_griffin</span><span class="op">$</span><span class="va">LifeHist</span>,</span></span>
<span class="r-in"><span>             Smooth<span class="op">=</span><span class="cn">TRUE</span>, Flatten<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Pedigree-based, overlapping generations, flattened, smoothed, MaxAgeParent = 5,5</span>
<span class="r-plt img"><img src="MakeAgePrior-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       M     P    FS    MS    PS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0.000 0.000 2.761 3.574 2.918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.698 1.655 1.783 2.270 2.321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.693 2.467 0.598 0.760 0.721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.548 0.972 0.299 0.380 0.360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.274 0.486 0.001 0.001 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.001 0.001 0.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.000 0.000 0.000 0.000 0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Call from sequoia() via args.AP:</span></span></span>
<span class="r-in"><span><span class="va">Seq_HSg5</span> <span class="op">&lt;-</span> <span class="fu"><a href="sequoia.html">sequoia</a></span><span class="op">(</span><span class="va">SimGeno_example</span>, <span class="va">LH_HSg5</span>, Module<span class="op">=</span><span class="st">"par"</span>,</span></span>
<span class="r-in"><span>                args.AP<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Discrete <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,  <span class="co"># non-overlapping generations</span></span></span>
<span class="r-in"><span>                CalcLLR <span class="op">=</span> <span class="cn">FALSE</span>,   <span class="co"># skip time-consuming calculation of LLR's</span></span></span>
<span class="r-in"><span>                Plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>      <span class="co"># no summary plots when finished</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Genotype matrix looks OK! There are  214  individuals and  200  SNPs.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Duplicate check ~~~</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ~~~ Parentage assignment ~~~</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parentage ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -18301.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post-parentage total LL :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -13773.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating birth years ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> assigned 121 dams and 165 sires to 214 individuals</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Possibly not all parents were assigned, consider running GetMaybeRel() to check</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

