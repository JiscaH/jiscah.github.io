<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Age Priors — MakeAgePrior • sequoia</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Age Priors — MakeAgePrior" />
<meta property="og:description" content="Estimate probability ratios \(P(R|A) / P(R)\) for age
  differences A and five categories of parent-offspring and sibling
  relationships R." />
<meta property="og:image" content="/reference/figures/sequoia_hexlogo_s.png" />
<meta property="og:image:alt" content="sequoia hexlogo" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sequoia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href=".././index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_main/book/sec-Background.html">Main vignette: User guide</a>
    </li>
    <li>
      <a href="../articles/vignette_age/book/index.html">Age prior vignette</a>
    </li>
    <li>
      <a href="../articles/index.html">Examples</a>
    </li>
    <li>
      <a href="../articles/index.html">More info on ...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a href="../articles/help.html">Help</a>
</li>
<li>
  <a href="../articles/performance_stats.html">Stats</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/HuismanJisca">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/JiscaH/sequoia">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Age Priors</h1>
    
    <div class="hidden name"><code>MakeAgePrior.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate probability ratios \(P(R|A) / P(R)\) for age
  differences A and five categories of parent-offspring and sibling
  relationships R.</p>
    </div>

    <pre class="usage"><span class='fu'>MakeAgePrior</span><span class='op'>(</span>
  Pedigree <span class='op'>=</span> <span class='cn'>NULL</span>,
  LifeHistData <span class='op'>=</span> <span class='cn'>NULL</span>,
  MaxAgeParent <span class='op'>=</span> <span class='cn'>NULL</span>,
  Discrete <span class='op'>=</span> <span class='cn'>NULL</span>,
  Flatten <span class='op'>=</span> <span class='cn'>NULL</span>,
  lambdaNW <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>100</span>,
  Smooth <span class='op'>=</span> <span class='cn'>TRUE</span>,
  Plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  Return <span class='op'>=</span> <span class='st'>"LR"</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Pedigree</th>
      <td><p>dataframe with id - dam - sire in columns 1-3, and optional
column with birth years. Other columns are ignored.</p></td>
    </tr>
    <tr>
      <th>LifeHistData</th>
      <td><p>dataframe with 3 or 5 columns: id - sex (not used) -
birth year (- BY.min - BY.max), with unknown birth years coded as negative
numbers or NA. Column names are ignored, so the column order is important.
"Birth year" may be in any arbitrary discrete time unit relevant to the
species (day, month, decade), as long as parents are never born in the same
time unit as their offspring. It may include individuals not in the
pedigree, and not all individuals in the pedigree need to be in
LifeHistData.</p></td>
    </tr>
    <tr>
      <th>MaxAgeParent</th>
      <td><p>maximum age of a parent, a single number (max across
dams and sires) or a vector of length two (dams, sires). If NULL, it will
be estimated from the pedigree. See details below.</p></td>
    </tr>
    <tr>
      <th>Discrete</th>
      <td><p>discrete generations? By default (NULL), discrete
generations are assumed if all parent-offspring pairs have an age
difference of 1, and all siblings an age difference of 0, and there are at
least 20 pairs of each category (mother, father, maternal sibling, paternal
sibling). Otherwise, overlapping generations are presumed. When
<code>Discrete=TRUE</code> (explicitly or deduced), <code>Smooth</code> and
<code>Flatten</code> are always automatically set to <code>FALSE</code>. Use
<code>Discrete=FALSE</code> to enforce (potential for) overlapping generations.</p></td>
    </tr>
    <tr>
      <th>Flatten</th>
      <td><p>logical. To deal with small sample sizes for some or all
relationships, calculate weighed average between the observed age
difference distribution among relatives and a flat (0/1) distribution. When
<code>Flatten=NULL</code> (the default) automatically set to TRUE when there are
fewer than 20 parents with known age of either sex assigned, or fewer than
20 maternal or paternal siblings with known age difference. Also advisable
if the sampled relative pairs with known age difference are non-typical of
the pedigree as a whole.</p></td>
    </tr>
    <tr>
      <th>lambdaNW</th>
      <td><p>control weighing factors when <code>Flatten=TRUE</code>. Weights
are calculated as \(W(R) = 1 - exp(-lambdaNW * N(R))\), where \(N(R)\)
is the number of pairs with relationship R for which the age difference is
known. Large values (&gt;0.2) put strong emphasis on the pedigree, small
values (&lt;0.0001) cause the pedigree to be ignored. Default results in
\(W=0.5\) for \(N=100\).</p></td>
    </tr>
    <tr>
      <th>Smooth</th>
      <td><p>smooth the tails of and any dips in the distribution? Sets dips
(&lt;10% of average of neighbouring ages) to the average of the neighbouring
ages, sets the age after the end (oldest observed age) to LR(end)/2, and
assigns a small value (0.001) to the ages before the front (youngest
observed age) and after the new end. Peaks are not smoothed out, as these
are less likely to cause problems than dips, and are more likely to be
genuine characteristics of the species. Is set to <code>FALSE</code> when
generations do not overlap (<code>Discrete=TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>Plot</th>
      <td><p>plot a heatmap of the results?</p></td>
    </tr>
    <tr>
      <th>Return</th>
      <td><p>return only a matrix with the likelihood-ratio \(P(A|R) /
P(A)\) (<code>"LR"</code>) or a list including also various intermediate
statistics (<code>"all"</code>) ?</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>suppress messages.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix with the probability ratio of the age difference between two
  individuals conditional on them being a certain type of relative
  (\(P(A|R)\)) versus being a random draw from the sample (\(P(A)\)).
  Assuming conditional independence, this equals the probability ratio of
  being a certain type of relative conditional on the age difference, versus
  being a random draw.</p>
<p>The matrix has one row per age difference (0 - nAgeClasses) and five
  columns, one for each relationship type, with abbreviations:</p>
<dt>M</dt><dd><p>Mothers</p></dd>
  <dt>P</dt><dd><p>Fathers</p></dd>
  <dt>FS</dt><dd><p>Full siblings</p></dd>
  <dt>MS</dt><dd><p>Maternal half-siblings</p></dd>
  <dt>PS</dt><dd><p>Paternal half-siblings</p></dd>

  When Return='all', a list is returned with the following elements:
   <dt>BirthYearRange</dt><dd><p>vector length 2</p></dd>
   <dt>MaxAgeParent</dt><dd><p>vector length 2, see details</p></dd>
   <dt>tblA.R</dt><dd><p>matrix with the counts per age difference (rows) /
     relationship (columns) combination, plus a column 'X' with age
     differences across all pairs of individuals</p></dd>
  <dt>PA.R</dt><dd><p>Proportions, i.e. <code>tblA.R</code> divided by its <code>colSums</code>,
    with full-sibling correction applied if necessary (see vignette).</p></dd>
   <dt>LR.RU.A.raw</dt><dd><p>Proportions <code>PA.R</code> standardised by global age
     difference distribution (column 'X'); <code>LR.RU.A</code> prior to flattening
     and smoothing</p></dd>
   <dt>Weights</dt><dd><p>vector length 4, the weights used to flatten the
    distributions</p></dd>
    <dt>LR.RU.A</dt><dd><p>the ageprior, flattend and/or smoothed</p></dd>
   <dt>Specs.AP</dt><dd><p>the names of the input <code>Pedigree</code> and
   <code>LifeHistData</code> (or <code>NULL</code>), <code>lambdaNW</code>, and the 'effective'
     settings (i.e. after any automatic update) of <code>Discrete</code>,
     <code>Smooth</code>, and <code>Flatten</code>.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>\(\alpha_{A,R}\) is the ratio between the observed
  counts of pairs with age difference A and relationship R (\(N_{A,R}\)),
  and the expected counts if age and relationship were independent
  (\(N_{.,.}*p_A*p_R\)).</p>
<p>During pedigree reconstruction, \(\alpha_{A,R}\) are multiplied by the
  genetic-only \(P(R|G)\) to obtain a probability that the
  pair are relatives of type R conditional on both their age difference and
  their genotypes.</p>
<p>The age-difference prior is used for pairs of genotyped individuals, as
  well as for dummy individuals. This assumes that the propensity for a pair
  with a given age difference to both be sampled does not depend on their
  relationship, so that the ratio \(P(A|R) / P(A)\) does not differ between
  sampled and unsampled pairs.</p>
<p>For further details, see the vignette.</p>
    <h2 class="hasAnchor" id="caution"><a class="anchor" href="#caution"></a>CAUTION</h2>

    

<p>The small sample correction with <code>Smooth</code> and/or <code>Flatten</code>
  prevents errors in one dataset, but may introduce errors in another; a
  single solution that fits to the wide variety of life histories and
  datasets is impossible. Please do inspect the matrix, e.g. with
  <code>PlotAgePrior</code>, and adjust the input parameters and/or the output
  matrix as necessary.</p>
    <h2 class="hasAnchor" id="single-cohort"><a class="anchor" href="#single-cohort"></a>Single cohort</h2>

    

<p>When all individuals in <code>LifeHistData</code> have the same birth year, it is
  assumed that <code>Discrete=TRUE</code> and <code>MaxAgeParent=1</code>. Consequently,
  it is assumed there are no avuncular pairs present in the sample; cousins
  are considered as alternative. To enforce overlapping generations, and
  thereby the consideration of full- and half- avuncular relationships, set
  <code>MaxAgeParent</code> to some value greater than \(1\).</p>
<p>When no birth year information is given at all, a single cohort is assumed,
 and the same rules apply.</p>
    <h2 class="hasAnchor" id="other-time-units"><a class="anchor" href="#other-time-units"></a>Other time units</h2>

    

<p>"Birth year" may be in any arbitrary time unit relevant to the species
  (day, month, decade), as long as parents are always born before their
  putative offspring, and never in the same time unit (e.g. parent's
  BirthYear= 1 (or 2001) and offspring BirthYear=5 (or 2005)). Negative
  numbers and NA's are interpreted as unknown, and fractional numbers are not
  allowed.</p>
    <h2 class="hasAnchor" id="maxageparent"><a class="anchor" href="#maxageparent"></a>MaxAgeParent</h2>

    

<p>The maximum parental age for each sex equals the maximum of:</p><ul>
<li><p>the maximum age of parents in <code>Pedigree</code>,</p></li>
<li><p>the input parameter <code>MaxAgeParent</code>,</p></li>
<li><p>the maximum range of birth years in <code>LifeHistData</code> (including
     BY.min and BY.max). Only used if both of the previous are <code>NA</code>, or
     if there are fewer than 20 parents of either sex assigned.</p></li>
<li><p>1, if <code>Discrete=TRUE</code> or the previous three are all <code>NA</code></p></li>
</ul><p>If the age distribution of assigned parents does not capture the maximum
 possible age of parents, it is advised to specify <code>MaxAgeParent</code> for
 one or both sexes. Not doing so may hinder subsequent assignment of both
 dummy parents and grandparents.</p>
<p>@section grandparents &amp; avuncular
 The agepriors for grand-parental and avuncular pairs is calculated from
 these by <code><a href='sequoia.html'>sequoia</a></code>, and included in its output as
 `AgePriorExtra`.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sequoia.html'>sequoia</a></code> and its argument <code>args.AP</code>,
  <code><a href='PlotAgePrior.html'>PlotAgePrior</a></code> for visualisation. The age vignette gives
  further details, mathematical justification, and some examples.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># without pedigree or lifehistdata:</span>
<span class='fu'>MakeAgePrior</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 99,99</span></div><div class='img'><img src='MakeAgePrior-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;     M P FS MS PS
#&gt; 0   0 0  1  1  1
#&gt; 1   1 1  1  1  1
#&gt; 2   1 1  1  1  1
#&gt; 3   1 1  1  1  1
#&gt; 4   1 1  1  1  1
#&gt; 5   1 1  1  1  1
#&gt; 6   1 1  1  1  1
#&gt; 7   1 1  1  1  1
#&gt; 8   1 1  1  1  1
#&gt; 9   1 1  1  1  1
#&gt; 10  1 1  1  1  1
#&gt; 11  1 1  1  1  1
#&gt; 12  1 1  1  1  1
#&gt; 13  1 1  1  1  1
#&gt; 14  1 1  1  1  1
#&gt; 15  1 1  1  1  1
#&gt; 16  1 1  1  1  1
#&gt; 17  1 1  1  1  1
#&gt; 18  1 1  1  1  1
#&gt; 19  1 1  1  1  1
#&gt; 20  1 1  1  1  1
#&gt; 21  1 1  1  1  1
#&gt; 22  1 1  1  1  1
#&gt; 23  1 1  1  1  1
#&gt; 24  1 1  1  1  1
#&gt; 25  1 1  1  1  1
#&gt; 26  1 1  1  1  1
#&gt; 27  1 1  1  1  1
#&gt; 28  1 1  1  1  1
#&gt; 29  1 1  1  1  1
#&gt; 30  1 1  1  1  1
#&gt; 31  1 1  1  1  1
#&gt; 32  1 1  1  1  1
#&gt; 33  1 1  1  1  1
#&gt; 34  1 1  1  1  1
#&gt; 35  1 1  1  1  1
#&gt; 36  1 1  1  1  1
#&gt; 37  1 1  1  1  1
#&gt; 38  1 1  1  1  1
#&gt; 39  1 1  1  1  1
#&gt; 40  1 1  1  1  1
#&gt; 41  1 1  1  1  1
#&gt; 42  1 1  1  1  1
#&gt; 43  1 1  1  1  1
#&gt; 44  1 1  1  1  1
#&gt; 45  1 1  1  1  1
#&gt; 46  1 1  1  1  1
#&gt; 47  1 1  1  1  1
#&gt; 48  1 1  1  1  1
#&gt; 49  1 1  1  1  1
#&gt; 50  1 1  1  1  1
#&gt; 51  1 1  1  1  1
#&gt; 52  1 1  1  1  1
#&gt; 53  1 1  1  1  1
#&gt; 54  1 1  1  1  1
#&gt; 55  1 1  1  1  1
#&gt; 56  1 1  1  1  1
#&gt; 57  1 1  1  1  1
#&gt; 58  1 1  1  1  1
#&gt; 59  1 1  1  1  1
#&gt; 60  1 1  1  1  1
#&gt; 61  1 1  1  1  1
#&gt; 62  1 1  1  1  1
#&gt; 63  1 1  1  1  1
#&gt; 64  1 1  1  1  1
#&gt; 65  1 1  1  1  1
#&gt; 66  1 1  1  1  1
#&gt; 67  1 1  1  1  1
#&gt; 68  1 1  1  1  1
#&gt; 69  1 1  1  1  1
#&gt; 70  1 1  1  1  1
#&gt; 71  1 1  1  1  1
#&gt; 72  1 1  1  1  1
#&gt; 73  1 1  1  1  1
#&gt; 74  1 1  1  1  1
#&gt; 75  1 1  1  1  1
#&gt; 76  1 1  1  1  1
#&gt; 77  1 1  1  1  1
#&gt; 78  1 1  1  1  1
#&gt; 79  1 1  1  1  1
#&gt; 80  1 1  1  1  1
#&gt; 81  1 1  1  1  1
#&gt; 82  1 1  1  1  1
#&gt; 83  1 1  1  1  1
#&gt; 84  1 1  1  1  1
#&gt; 85  1 1  1  1  1
#&gt; 86  1 1  1  1  1
#&gt; 87  1 1  1  1  1
#&gt; 88  1 1  1  1  1
#&gt; 89  1 1  1  1  1
#&gt; 90  1 1  1  1  1
#&gt; 91  1 1  1  1  1
#&gt; 92  1 1  1  1  1
#&gt; 93  1 1  1  1  1
#&gt; 94  1 1  1  1  1
#&gt; 95  1 1  1  1  1
#&gt; 96  1 1  1  1  1
#&gt; 97  1 1  1  1  1
#&gt; 98  1 1  1  1  1
#&gt; 99  1 1  0  0  0
#&gt; 100 0 0  0  0  0</div><div class='input'><span class='fu'>MakeAgePrior</span><span class='op'>(</span>MaxAgeParent <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 2,3</span></div><div class='img'><img src='MakeAgePrior-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;   M P FS MS PS
#&gt; 0 0 0  1  1  1
#&gt; 1 1 1  1  1  1
#&gt; 2 1 1  0  0  1
#&gt; 3 0 1  0  0  0
#&gt; 4 0 0  0  0  0</div><div class='input'><span class='fu'>MakeAgePrior</span><span class='op'>(</span>Discrete<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span></div><div class='img'><img src='MakeAgePrior-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;   M P FS MS PS
#&gt; 0 0 0  1  1  1
#&gt; 1 1 1  0  0  0
#&gt; 2 0 0  0  0  0</div><div class='input'>
<span class='co'># single cohort:</span>
<span class='fu'>MakeAgePrior</span><span class='op'>(</span>LifeHistData <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span>, Sex<span class='op'>=</span><span class='fl'>3</span>,
  BirthYear<span class='op'>=</span><span class='fl'>1984</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 1,1</span></div><div class='output co'>#&gt;   M P FS MS PS
#&gt; 0 0 0  1  1  1
#&gt; 1 1 1  0  0  0
#&gt; 2 0 0  0  0  0</div><div class='input'>
<span class='co'># overlapping generations:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Ped_griffin</span>, <span class='va'>SeqOUT_griffin</span>, package<span class='op'>=</span><span class='st'>"sequoia"</span><span class='op'>)</span>
<span class='co'># without pedigree: MaxAgeParent = max age difference between any pair +1</span>
<span class='fu'>MakeAgePrior</span><span class='op'>(</span>LifeHistData <span class='op'>=</span> <span class='va'>SeqOUT_griffin</span><span class='op'>$</span><span class='va'>LifeHist</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Ageprior: Flat 0/1, overlapping generations, MaxAgeParent = 10,10</span></div><div class='img'><img src='MakeAgePrior-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;    M P FS MS PS
#&gt; 0  0 0  1  1  1
#&gt; 1  1 1  1  1  1
#&gt; 2  1 1  1  1  1
#&gt; 3  1 1  1  1  1
#&gt; 4  1 1  1  1  1
#&gt; 5  1 1  1  1  1
#&gt; 6  1 1  1  1  1
#&gt; 7  1 1  1  1  1
#&gt; 8  1 1  1  1  1
#&gt; 9  1 1  1  1  1
#&gt; 10 1 1  0  0  0
#&gt; 11 0 0  0  0  0</div><div class='input'><span class='co'># with pedigree:</span>
<span class='fu'>MakeAgePrior</span><span class='op'>(</span>Pedigree<span class='op'>=</span><span class='va'>Ped_griffin</span>,
             LifeHistData<span class='op'>=</span><span class='va'>SeqOUT_griffin</span><span class='op'>$</span><span class='va'>LifeHist</span>,
             Smooth<span class='op'>=</span><span class='cn'>FALSE</span>, Flatten<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Ageprior: Pedigree-based, overlapping generations, MaxAgeParent = 3,3</span></div><div class='img'><img src='MakeAgePrior-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;       M     P    FS    MS    PS
#&gt; 0 0.000 0.000 5.043 4.316 3.862
#&gt; 1 3.476 1.967 2.798 2.636 2.971
#&gt; 2 2.011 3.167 0.077 0.691 0.583
#&gt; 3 0.340 0.959 0.000 0.000 0.000
#&gt; 4 0.000 0.000 0.000 0.000 0.000</div><div class='input'><span class='co'># with small-sample correction:</span>
<span class='fu'>MakeAgePrior</span><span class='op'>(</span>Pedigree<span class='op'>=</span><span class='va'>Ped_griffin</span>,
             LifeHistData<span class='op'>=</span><span class='va'>SeqOUT_griffin</span><span class='op'>$</span><span class='va'>LifeHist</span>,
             Smooth<span class='op'>=</span><span class='cn'>TRUE</span>, Flatten<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Ageprior: Pedigree-based, overlapping generations, flattened, smoothed, MaxAgeParent = 5,5</span></div><div class='img'><img src='MakeAgePrior-6.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;       M     P    FS    MS    PS
#&gt; 0 0.000 0.000 2.761 3.574 2.918
#&gt; 1 2.698 1.655 1.783 2.270 2.321
#&gt; 2 1.693 2.467 0.598 0.760 0.721
#&gt; 3 0.548 0.972 0.299 0.380 0.360
#&gt; 4 0.274 0.486 0.001 0.001 0.001
#&gt; 5 0.001 0.001 0.000 0.000 0.000
#&gt; 6 0.000 0.000 0.000 0.000 0.000</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


