<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compare Pairwise Relationships — ComparePairs • sequoia</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compare Pairwise Relationships — ComparePairs" />
<meta property="og:description" content="Compare, count and identify different types of relative pairs
  between two pedigrees, or within one pedigree." />
<meta property="og:image" content="/reference/figures/sequoia_hexlogo_s.png" />
<meta property="og:image:alt" content="sequoia hexlogo" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sequoia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href=".././index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_main/book/sec-Background.html">Main vignette: User guide</a>
    </li>
    <li>
      <a href="../articles/vignette_age/book/index.html">Age prior vignette</a>
    </li>
    <li>
      <a href="../articles/index.html">Examples</a>
    </li>
    <li>
      <a href="../articles/index.html">More info on ...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a href="../articles/help.html">Help</a>
</li>
<li>
  <a href="../articles/performance_stats.html">Stats</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/HuismanJisca">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/JiscaH/sequoia">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compare Pairwise Relationships</h1>
    
    <div class="hidden name"><code>ComparePairs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compare, count and identify different types of relative pairs
  between two pedigrees, or within one pedigree.</p>
    </div>

    <pre class="usage"><span class='fu'>ComparePairs</span><span class='op'>(</span>
  Ped1 <span class='op'>=</span> <span class='cn'>NULL</span>,
  Ped2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  Pairs2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  GenBack <span class='op'>=</span> <span class='fl'>1</span>,
  patmat <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ExcludeDummies <span class='op'>=</span> <span class='cn'>TRUE</span>,
  DumPrefix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"F0"</span>, <span class='st'>"M0"</span><span class='op'>)</span>,
  Return <span class='op'>=</span> <span class='st'>"Counts"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Ped1</th>
      <td><p>first (e.g. original/reference) pedigree, dataframe with 3
columns: id-dam-sire.</p></td>
    </tr>
    <tr>
      <th>Ped2</th>
      <td><p>optional second (e.g. inferred) pedigree.</p></td>
    </tr>
    <tr>
      <th>Pairs2</th>
      <td><p>optional dataframe with relationships categories between pairs
of individuals, instead of or in addition to <code>Ped2</code>, e.g. as returned
by <code><a href='GetMaybeRel.html'>GetMaybeRel</a></code>. First three columns: ID1-ID2-relationship,
column names and any additional columns are ignored.</p></td>
    </tr>
    <tr>
      <th>GenBack</th>
      <td><p>number of generations back to consider; 1 returns
parent-offspring and sibling relationships, 2 also returns grandparental,
avuncular and first cousins. GenBack &gt;2 is not implemented.</p></td>
    </tr>
    <tr>
      <th>patmat</th>
      <td><p>logical, distinguish between paternal versus maternal relative
pairs?</p></td>
    </tr>
    <tr>
      <th>ExcludeDummies</th>
      <td><p>logical, exclude dummy IDs from output? Individuals
with e.g. the same dummy father will still be counted as paternal halfsibs.
No attempt is made to match dummies in one pedigree to individuals in the
other pedigree; for that use <code><a href='PedCompare.html'>PedCompare</a></code>.</p></td>
    </tr>
    <tr>
      <th>DumPrefix</th>
      <td><p>character vector with the prefixes identifying dummy
individuals. Use 'F0' ('M0') to avoid matching to regular individuals with
IDs starting with 'F' ('M'), provided <code>Ped2</code> has fewer than 999 dummy
females (males).</p></td>
    </tr>
    <tr>
      <th>Return</th>
      <td><p>return a matrix with <code>Counts</code> or a <code>Summary</code> of the
number of identical relationships and mismatches per relationship, or
detailed results as a 2xNxN <code>Array</code> or as a <code>Dataframe</code>.
<code>All</code> returns a list with all four.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Depending on <code>Return</code>, one of the following, or a list with all:</p>
<dt>Counts</dt><dd><p>(the default), a matrix with counts, with the classification in
  <code>Ped1</code> on rows and that in <code>Ped2</code> in columns. Counts for
  'symmetrical' pairs ("FS", "HS", "MHS", "PHS", "FC1", "DFC1", "U","X") are
  divided by two.</p></dd>
  <dt>Summary</dt><dd><p>a matrix with one row per relationship type and four columns
    , named as if <code>Ped1</code> is the true pedigree:
    <dl>
      <dt>n</dt><dd><p>total number of pairs with that relationship in <code>Ped1</code>,
        and occurring in <code>Ped2</code></p></dd>
     <dt>OK</dt><dd><p>Number of pairs with same relationship in <code>Ped2</code> as in
       <code>Ped1</code></p></dd>
     <dt>hi</dt><dd><p>Number of pairs with 'higher' relationship in <code>Ped2</code> as
       in <code>Ped1</code> (e.g. FS instead of HS; ranking is the order given
       below)</p></dd>
     <dt>lo</dt><dd><p>Number of pairs with 'lower' relationship in <code>Ped2</code> as in
      <code>Ped1</code>, but not unrelated in <code>Ped2</code></p></dd></dl></p></dd>
  <dt>Array</dt><dd><p>a 2xNxN array (if <code>Ped2</code> or <code>Pairs2</code> is specified)
    or a NxN matrix , where N is the total number of individuals occurring in
    <code>Ped1</code> and/or <code>Ped2</code>.</p></dd>
  <dt>Dataframe</dt><dd><p>a dataframe with \(N^2\) rows and four columns:
    <dl>
      <dt>id.A</dt><dd><p>First individual of the pair</p></dd>
      <dt>id.B</dt><dd><p>Second individual of the pair</p></dd>
      <dt>RC1</dt><dd><p>the relationship category in <code>Ped1</code>, as a factor with all
        considered categories as levels, including those with 0 count</p></dd>
      <dt>RC2</dt><dd><p>the relationship category in <code>Ped2</code></p></dd></dl>
    Each pair is listed twice, e.g. once as P and once as O, or twice as FS.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If <code>Pairs2</code> is as returned by <code><a href='GetMaybeRel.html'>GetMaybeRel</a></code>
  (identified by the additional column names 'LLR' and 'OH'), these
  relationship categories are appended with an '?' in the output, to
  distinguish them from those derived from <code>Ped2</code>.</p>
<p>When <code>Pairs2$TopRel</code> contains values other than the ones listed among
  the return values for the combination of <code>patmat</code> and <code>GenBack</code>,
  they are prioritised in decreasing order of factor levels, or in decreasing
  alphabetical order, and before the default (<code>ped2</code> derived) levels.</p>
<p>The matrix returned by <code><a href='DyadCompare.html'>DyadCompare</a></code> [Deprecated] is a subset
  of the matrix returned here using default settings.</p>
    <h2 class="hasAnchor" id="relationship-abbreviations-and-ranking"><a class="anchor" href="#relationship-abbreviations-and-ranking"></a>Relationship abbreviations and ranking</h2>

    

<p>By default (<code>GenBack=1, patmat=FALSE</code>) the following 7 relationships are
distinguished:</p><ul>
<li><p><strong>S</strong>: Self (not included in <code>Counts</code>)</p></li>
<li><p><strong>MP</strong>: Parent</p></li>
<li><p><strong>O</strong>: Offspring (not included in <code>Counts</code>)</p></li>
<li><p><strong>FS</strong>: Full sibling</p></li>
<li><p><strong>HS</strong>: Half sibling</p></li>
<li><p><strong>U</strong>: Unrelated, or otherwise related</p></li>
<li><p><strong>X</strong>: Either or both individuals not occurring in both
     pedigrees</p></li>
</ul><p>In the array and dataframe, 'MP' indicates that the second (column)
individual is the parent of the first (row) individual, and 'O' indicates the
reverse.</p>
<p>When <code>GenBack=1, patmat=TRUE</code> the categories are (S)-M-P-(O)-FS-MHS-PHS-
U-X.</p>
<p>When <code>GenBack=2, patmat=TRUE</code>, the following relationships are
distinguished:</p><ul>
<li><p><strong>S</strong>: Self (not included in <code>Counts</code>)</p></li>
<li><p><strong>M</strong>: Mother</p></li>
<li><p><strong>P</strong>: Father</p></li>
<li><p><strong>O</strong>: Offspring (not included in <code>Counts</code>)</p></li>
<li><p><strong>FS</strong>: Full sibling</p></li>
<li><p><strong>MHS</strong>: Maternal half-sibling</p></li>
<li><p><strong>PHS</strong>: Paternal half-sibling</p></li>
<li><p><strong>MGM</strong>: Maternal grandmother</p></li>
<li><p><strong>MGF</strong>: Maternal grandfather</p></li>
<li><p><strong>PGM</strong>: Paternal grandmother</p></li>
<li><p><strong>PGF</strong>: Paternal grandfather</p></li>
<li><p><strong>GO</strong>: Grand-offspring (not included in <code>Counts</code>)</p></li>
<li><p><strong>FA</strong>: Full avuncular; maternal or paternal aunt or uncle</p></li>
<li><p><strong>HA</strong>: Half avuncular</p></li>
<li><p><strong>FN</strong>: Full nephew/niece (not included in <code>Counts</code>)</p></li>
<li><p><strong>HN</strong>: Half nephew/niece (not included in <code>Counts</code>)</p></li>
<li><p><strong>FC1</strong>: Full first cousin</p></li>
<li><p><strong>DFC1</strong>: Double full first cousin</p></li>
<li><p><strong>U</strong>: Unrelated, or otherwise related</p></li>
<li><p><strong>X</strong>: Either or both individuals not occurring in both pedigrees</p></li>
</ul><p>Note that for avuncular and cousin relationships no distinction is made
between paternal versus maternal, as this may differ between the two
individuals and would generate a large number of sub-classes. When a pair is
related via multiple paths, the first-listed relationship is returned.</p>
<p>When <code>GenBack=2, patmat=FALSE</code>, MGM, MGF, PGM and PGF are combined
into GP, with the rest of the categories analogous to the above.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='PedCompare.html'>PedCompare</a></code> for individual-based comparison;
  <code><a href='GetRelM.html'>GetRelM</a></code> for a pairwise relationships matrix of a single
  pedigree; <code><a href='PlotRelPairs.html'>PlotRelPairs</a></code> for visualisation of relationships
  within each pedigree.</p>
<p>To estimate P(actual relationship (Ped1) | inferred relationship (Ped2)),
  see examples at <code><a href='EstConf.html'>EstConf</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Ped_griffin</span>, <span class='va'>SeqOUT_griffin</span>, package<span class='op'>=</span><span class='st'>"sequoia"</span><span class='op'>)</span>
<span class='va'>PairsG</span> <span class='op'>&lt;-</span> <span class='fu'>ComparePairs</span><span class='op'>(</span><span class='va'>Ped_griffin</span>, <span class='va'>SeqOUT_griffin</span><span class='op'>[[</span><span class='st'>"Pedigree"</span><span class='op'>]</span><span class='op'>]</span>,
                       patmat <span class='op'>=</span> <span class='cn'>TRUE</span>, ExcludeDummies <span class='op'>=</span> <span class='cn'>TRUE</span>, Return <span class='op'>=</span> <span class='st'>"All"</span><span class='op'>)</span>
<span class='va'>PairsG</span><span class='op'>$</span><span class='va'>Counts</span>
</div><div class='output co'>#&gt;      Ped2
#&gt; Ped1     M    P    O   FS  MHS  PHS    U    X
#&gt;   M     65    0    0    0    0    0    0  102
#&gt;   P      0   79    0    0    0    0    0   84
#&gt;   FS     0    0    0    5    0    0    0    0
#&gt;   MHS    0    0    0    0   87    0    8  116
#&gt;   PHS    0    0    0    0    0   76    6   72
#&gt;   U      0    0    0    0    0    0 9685 9515
#&gt;   X      0    0    0    0    0    0    0    0</div><div class='input'>
<span class='co'># pairwise correct assignment rate:</span>
<span class='va'>PairsG</span><span class='op'>$</span><span class='va'>Summary</span><span class='op'>[</span>,<span class='st'>"OK"</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>PairsG</span><span class='op'>$</span><span class='va'>Summary</span><span class='op'>[</span>,<span class='st'>"n"</span><span class='op'>]</span>
</div><div class='output co'>#&gt;         M         P        FS       MHS       PHS         U 
#&gt; 1.0000000 1.0000000 1.0000000 0.9157895 0.9268293 1.0000000 </div><div class='input'>
<span class='co'># check specific pair:</span>
<span class='va'>PairsG</span><span class='op'>$</span><span class='va'>Array</span><span class='op'>[</span>, <span class='st'>"i190_2010_M"</span>, <span class='st'>"i168_2009_F"</span><span class='op'>]</span>
</div><div class='output co'>#&gt; Ped1 Ped2 
#&gt;  "M"  "X" </div><div class='input'><span class='co'># or</span>
<span class='va'>RelDF</span> <span class='op'>&lt;-</span> <span class='va'>PairsG</span><span class='op'>$</span><span class='va'>Dataframe</span>   <span class='co'># for brevity</span>
<span class='va'>RelDF</span><span class='op'>[</span><span class='va'>RelDF</span><span class='op'>$</span><span class='va'>id.A</span><span class='op'>==</span><span class='st'>"i190_2010_M"</span> <span class='op'>&amp;</span> <span class='va'>RelDF</span><span class='op'>$</span><span class='va'>id.B</span><span class='op'>==</span><span class='st'>"i168_2009_F"</span>, <span class='op'>]</span>
</div><div class='output co'>#&gt;              id.A        id.B Ped1 Ped2
#&gt; 33590 i190_2010_M i168_2009_F    M    X</div><div class='input'>
<span class='co'># Colony-style lists of full sib dyads &amp; half sib dyads:</span>
<span class='va'>FullSibDyads</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>RelDF</span>, <span class='va'>RelDF</span><span class='op'>[</span><span class='va'>Ped1</span> <span class='op'>==</span> <span class='st'>"FS"</span> <span class='op'>&amp;</span> <span class='va'>id.A</span> <span class='op'>&lt;</span> <span class='va'>id.B</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='va'>HalfSibDyads</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>RelDF</span>, <span class='va'>RelDF</span><span class='op'>[</span><span class='va'>Ped1</span> <span class='op'>==</span> <span class='st'>"HS"</span> <span class='op'>&amp;</span> <span class='va'>id.A</span> <span class='op'>&lt;</span> <span class='va'>id.B</span>, <span class='op'>]</span><span class='op'>)</span>
<span class='co'># Use 'id.A &lt; id.B' because each pair is listed 2x</span>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


