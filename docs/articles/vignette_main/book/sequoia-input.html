<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 sequoia() input | Sequoia User Guide</title>
  <meta name="description" content="4 sequoia() input | Sequoia User Guide" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="4 sequoia() input | Sequoia User Guide" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/../../sequoia_logo.png" />
  
  <meta name="github-repo" content="JiscaH/sequoia" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 sequoia() input | Sequoia User Guide" />
  
  
  <meta name="twitter:image" content="/../../sequoia_logo.png" />

<meta name="author" content="Jisca Huisman" />


<meta name="date" content="2023-04-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png" />
  <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
<link rel="prev" href="function-overview.html"/>
<link rel="next" href="running-sequoia.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./../../../index.html"><img src="../../home-solid-silver.svg" height="40" alt="home"/></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>1</b> Background</a>
<ul>
<li class="chapter" data-level="1.1" data-path="background.html"><a href="background.html#sec:Background"><i class="fa fa-check"></i><b>1.1</b> The core of <code>Sequoia</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="key-points.html"><a href="key-points.html"><i class="fa fa-check"></i><b>2</b> Key Points</a>
<ul>
<li class="chapter" data-level="2.1" data-path="key-points.html"><a href="key-points.html#sec:MendelErrors"><i class="fa fa-check"></i><b>2.1</b> Mendelian Errors</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="key-points.html"><a href="key-points.html#parent-pairs"><i class="fa fa-check"></i><b>2.1.1</b> Parent-pairs</a></li>
<li class="chapter" data-level="2.1.2" data-path="key-points.html"><a href="key-points.html#maximum-mismatches"><i class="fa fa-check"></i><b>2.1.2</b> Maximum mismatches</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="key-points.html"><a href="key-points.html#likelihoods"><i class="fa fa-check"></i><b>2.2</b> Likelihoods</a></li>
<li class="chapter" data-level="2.3" data-path="key-points.html"><a href="key-points.html#sec:GenoErrors"><i class="fa fa-check"></i><b>2.3</b> Genotyping errors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="key-points.html"><a href="key-points.html#effect"><i class="fa fa-check"></i><b>2.3.1</b> Effect</a></li>
<li class="chapter" data-level="2.3.2" data-path="key-points.html"><a href="key-points.html#assumed-genotyping-error-rate-err"><i class="fa fa-check"></i><b>2.3.2</b> Assumed genotyping error rate <code>Err</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="key-points.html"><a href="key-points.html#performance-with-high-genotyping-error-rates"><i class="fa fa-check"></i><b>2.3.3</b> Performance with high genotyping error rates</a></li>
<li class="chapter" data-level="2.3.4" data-path="key-points.html"><a href="key-points.html#effect-on-runtime"><i class="fa fa-check"></i><b>2.3.4</b> Effect on runtime</a></li>
<li class="chapter" data-level="2.3.5" data-path="key-points.html"><a href="key-points.html#error-matrix"><i class="fa fa-check"></i><b>2.3.5</b> Error matrix</a></li>
<li class="chapter" data-level="2.3.6" data-path="key-points.html"><a href="key-points.html#estimate"><i class="fa fa-check"></i><b>2.3.6</b> Estimate</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="key-points.html"><a href="key-points.html#sec:BY-AP"><i class="fa fa-check"></i><b>2.4</b> Birth years &amp; Ageprior</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="key-points.html"><a href="key-points.html#definition-interpretation"><i class="fa fa-check"></i><b>2.4.1</b> Definition &amp; interpretation</a></li>
<li class="chapter" data-level="2.4.2" data-path="key-points.html"><a href="key-points.html#implementation"><i class="fa fa-check"></i><b>2.4.2</b> Implementation</a></li>
<li class="chapter" data-level="2.4.3" data-path="key-points.html"><a href="key-points.html#smooth-flatten"><i class="fa fa-check"></i><b>2.4.3</b> Smooth &amp; Flatten</a></li>
<li class="chapter" data-level="2.4.4" data-path="key-points.html"><a href="key-points.html#age-based-non-assignment"><i class="fa fa-check"></i><b>2.4.4</b> Age-based non-assignment</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="key-points.html"><a href="key-points.html#parent-llr"><i class="fa fa-check"></i><b>2.5</b> Parent LLR</a></li>
<li class="chapter" data-level="2.6" data-path="key-points.html"><a href="key-points.html#sec:EstConf"><i class="fa fa-check"></i><b>2.6</b> Confidence</a></li>
<li class="chapter" data-level="2.7" data-path="key-points.html"><a href="key-points.html#sec:lowAR"><i class="fa fa-check"></i><b>2.7</b> Low assignment rate</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="key-points.html"><a href="key-points.html#causes"><i class="fa fa-check"></i><b>2.7.1</b> Causes</a></li>
<li class="chapter" data-level="2.7.2" data-path="key-points.html"><a href="key-points.html#remedies"><i class="fa fa-check"></i><b>2.7.2</b> Remedies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="function-overview.html"><a href="function-overview.html"><i class="fa fa-check"></i><b>3</b> Function overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="function-overview.html"><a href="function-overview.html#input"><i class="fa fa-check"></i><b>3.1</b> Input</a></li>
<li class="chapter" data-level="3.2" data-path="function-overview.html"><a href="function-overview.html#simulate"><i class="fa fa-check"></i><b>3.2</b> Simulate</a></li>
<li class="chapter" data-level="3.3" data-path="function-overview.html"><a href="function-overview.html#ageprior"><i class="fa fa-check"></i><b>3.3</b> Ageprior</a></li>
<li class="chapter" data-level="3.4" data-path="function-overview.html"><a href="function-overview.html#pedigree-reconstruction"><i class="fa fa-check"></i><b>3.4</b> Pedigree reconstruction</a></li>
<li class="chapter" data-level="3.5" data-path="function-overview.html"><a href="function-overview.html#pedigree-check"><i class="fa fa-check"></i><b>3.5</b> Pedigree check</a></li>
<li class="chapter" data-level="3.6" data-path="function-overview.html"><a href="function-overview.html#pairwise-relationships"><i class="fa fa-check"></i><b>3.6</b> Pairwise relationships</a></li>
<li class="chapter" data-level="3.7" data-path="function-overview.html"><a href="function-overview.html#miscellaneous"><i class="fa fa-check"></i><b>3.7</b> Miscellaneous</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sequoia-input.html"><a href="sequoia-input.html"><i class="fa fa-check"></i><b>4</b> <code>sequoia()</code> input</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:GenoFormat"><i class="fa fa-check"></i><b>4.1</b> Genotypes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sequoia-input.html"><a href="sequoia-input.html#subset-snps"><i class="fa fa-check"></i><b>4.1.1</b> Subset SNPs</a></li>
<li class="chapter" data-level="4.1.2" data-path="sequoia-input.html"><a href="sequoia-input.html#plink"><i class="fa fa-check"></i><b>4.1.2</b> PLINK</a></li>
<li class="chapter" data-level="4.1.3" data-path="sequoia-input.html"><a href="sequoia-input.html#low-call-rate"><i class="fa fa-check"></i><b>4.1.3</b> Low call rate</a></li>
<li class="chapter" data-level="4.1.4" data-path="sequoia-input.html"><a href="sequoia-input.html#very-large-datasets"><i class="fa fa-check"></i><b>4.1.4</b> Very large datasets</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sequoia-input.html"><a href="sequoia-input.html#birth-years-sex"><i class="fa fa-check"></i><b>4.2</b> Birth years &amp; sex</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sequoia-input.html"><a href="sequoia-input.html#lifehistdata"><i class="fa fa-check"></i><b>4.2.1</b> LifeHistData</a></li>
<li class="chapter" data-level="4.2.2" data-path="sequoia-input.html"><a href="sequoia-input.html#unknown-birth-years"><i class="fa fa-check"></i><b>4.2.2</b> Unknown birth years</a></li>
<li class="chapter" data-level="4.2.3" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:custom-AP"><i class="fa fa-check"></i><b>4.2.3</b> <code>args.AP</code> (Customising the ageprior)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sequoia-input.html"><a href="sequoia-input.html#tfilter-tassign"><i class="fa fa-check"></i><b>4.3</b> <code>Tfilter</code> &amp; <code>Tassign</code></a></li>
<li class="chapter" data-level="4.4" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:Complx"><i class="fa fa-check"></i><b>4.4</b> <code>Complex</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:WeirdRels"><i class="fa fa-check"></i><b>4.4.1</b> Unusual relationships</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sequoia-input.html"><a href="sequoia-input.html#herm"><i class="fa fa-check"></i><b>4.5</b> <code>Herm</code></a></li>
<li class="chapter" data-level="4.6" data-path="sequoia-input.html"><a href="sequoia-input.html#useage"><i class="fa fa-check"></i><b>4.6</b> <code>UseAge</code></a></li>
<li class="chapter" data-level="4.7" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:reuse"><i class="fa fa-check"></i><b>4.7</b> <code>SeqList</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="running-sequoia.html"><a href="running-sequoia.html"><i class="fa fa-check"></i><b>5</b> Running <code>sequoia()</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="running-sequoia.html"><a href="running-sequoia.html#module-maxsibiter"><i class="fa fa-check"></i><b>5.1</b> <code>Module</code> (<code>MaxSibIter</code>)</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="running-sequoia.html"><a href="running-sequoia.html#sec:MaxSibIter"><i class="fa fa-check"></i><b>5.1.1</b> <code>MaxSibIter</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="running-sequoia.html"><a href="running-sequoia.html#input-check"><i class="fa fa-check"></i><b>5.2</b> Input check</a></li>
<li class="chapter" data-level="5.3" data-path="running-sequoia.html"><a href="running-sequoia.html#check-for-duplicates"><i class="fa fa-check"></i><b>5.3</b> Check for duplicates</a></li>
<li class="chapter" data-level="5.4" data-path="running-sequoia.html"><a href="running-sequoia.html#parentage-assignment"><i class="fa fa-check"></i><b>5.4</b> Parentage assignment</a></li>
<li class="chapter" data-level="5.5" data-path="running-sequoia.html"><a href="running-sequoia.html#ageprior-1"><i class="fa fa-check"></i><b>5.5</b> AgePrior</a></li>
<li class="chapter" data-level="5.6" data-path="running-sequoia.html"><a href="running-sequoia.html#full-reconstruction"><i class="fa fa-check"></i><b>5.6</b> Full reconstruction</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="running-sequoia.html"><a href="running-sequoia.html#dummy-individuals"><i class="fa fa-check"></i><b>5.6.1</b> Dummy Individuals</a></li>
<li class="chapter" data-level="5.6.2" data-path="running-sequoia.html"><a href="running-sequoia.html#total-likelihood"><i class="fa fa-check"></i><b>5.6.2</b> Total likelihood</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="running-sequoia.html"><a href="running-sequoia.html#save-output"><i class="fa fa-check"></i><b>5.7</b> Save output</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="output-check.html"><a href="output-check.html"><i class="fa fa-check"></i><b>6</b> Output check</a>
<ul>
<li class="chapter" data-level="6.1" data-path="output-check.html"><a href="output-check.html#pedigree-stats-plots"><i class="fa fa-check"></i><b>6.1</b> Pedigree stats &amp; plots</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="output-check.html"><a href="output-check.html#negative-llrs"><i class="fa fa-check"></i><b>6.1.1</b> Negative LLR’s</a></li>
<li class="chapter" data-level="6.1.2" data-path="output-check.html"><a href="output-check.html#dyad-plot"><i class="fa fa-check"></i><b>6.1.2</b> Dyad plot</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="output-check.html"><a href="output-check.html#sec:compPed"><i class="fa fa-check"></i><b>6.2</b> Compare pedigrees</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="output-check.html"><a href="output-check.html#dummy-matching"><i class="fa fa-check"></i><b>6.2.1</b> Dummy matching</a></li>
<li class="chapter" data-level="6.2.2" data-path="output-check.html"><a href="output-check.html#example"><i class="fa fa-check"></i><b>6.2.2</b> Example</a></li>
<li class="chapter" data-level="6.2.3" data-path="output-check.html"><a href="output-check.html#colony"><i class="fa fa-check"></i><b>6.2.3</b> Colony</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="output-check.html"><a href="output-check.html#sec:compR"><i class="fa fa-check"></i><b>6.3</b> Relatedness</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="output-check.html"><a href="output-check.html#sec:Rped"><i class="fa fa-check"></i><b>6.3.1</b> Pedigree relatedness</a></li>
<li class="chapter" data-level="6.3.2" data-path="output-check.html"><a href="output-check.html#genomic-relatedness"><i class="fa fa-check"></i><b>6.3.2</b> Genomic relatedness</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="output-check.html"><a href="output-check.html#cluster-families"><i class="fa fa-check"></i><b>6.4</b> Cluster families</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hermaphrodites.html"><a href="hermaphrodites.html"><i class="fa fa-check"></i><b>7</b> Hermaphrodites</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hermaphrodites.html"><a href="hermaphrodites.html#herm-a-pedigree-prior"><i class="fa fa-check"></i><b>7.1</b> Herm ‘A’: Pedigree prior</a></li>
<li class="chapter" data-level="7.2" data-path="hermaphrodites.html"><a href="hermaphrodites.html#herm-b-ignore-sex-role"><i class="fa fa-check"></i><b>7.2</b> Herm ‘B’: Ignore sex role</a></li>
<li class="chapter" data-level="7.3" data-path="hermaphrodites.html"><a href="hermaphrodites.html#hermaphrodite-dummies"><i class="fa fa-check"></i><b>7.3</b> Hermaphrodite dummies</a></li>
<li class="chapter" data-level="7.4" data-path="hermaphrodites.html"><a href="hermaphrodites.html#assignment-errors"><i class="fa fa-check"></i><b>7.4</b> Assignment errors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>8</b> FAQ</a>
<ul>
<li class="chapter" data-level="8.1" data-path="faq.html"><a href="faq.html#error-aboutdue-to-input-data"><i class="fa fa-check"></i><b>8.1</b> Error about/due to input data</a></li>
<li class="chapter" data-level="8.2" data-path="faq.html"><a href="faq.html#sec:FAQlowAR"><i class="fa fa-check"></i><b>8.2</b> Low assignment rate</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="faq.html"><a href="faq.html#not-enough-snps"><i class="fa fa-check"></i><b>8.2.1</b> Not enough SNPs</a></li>
<li class="chapter" data-level="8.2.2" data-path="faq.html"><a href="faq.html#genotyping-errors"><i class="fa fa-check"></i><b>8.2.2</b> Genotyping errors</a></li>
<li class="chapter" data-level="8.2.3" data-path="faq.html"><a href="faq.html#lacking-sex-information"><i class="fa fa-check"></i><b>8.2.3</b> Lacking sex information</a></li>
<li class="chapter" data-level="8.2.4" data-path="faq.html"><a href="faq.html#insufficient-age-information"><i class="fa fa-check"></i><b>8.2.4</b> Insufficient age information</a></li>
<li class="chapter" data-level="8.2.5" data-path="faq.html"><a href="faq.html#uninformative-age-prior"><i class="fa fa-check"></i><b>8.2.5</b> Uninformative age prior</a></li>
<li class="chapter" data-level="8.2.6" data-path="faq.html"><a href="faq.html#mating-system"><i class="fa fa-check"></i><b>8.2.6</b> Mating system</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="faq.html"><a href="faq.html#death-year"><i class="fa fa-check"></i><b>8.3</b> Death year</a></li>
<li class="chapter" data-level="8.4" data-path="faq.html"><a href="faq.html#accuracy"><i class="fa fa-check"></i><b>8.4</b> Accuracy</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="faq.html"><a href="faq.html#field-pedigree"><i class="fa fa-check"></i><b>8.4.1</b> Field pedigree</a></li>
<li class="chapter" data-level="8.4.2" data-path="faq.html"><a href="faq.html#genomic-relatedness-1"><i class="fa fa-check"></i><b>8.4.2</b> Genomic relatedness</a></li>
<li class="chapter" data-level="8.4.3" data-path="faq.html"><a href="faq.html#data-simulation"><i class="fa fa-check"></i><b>8.4.3</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="faq.html"><a href="faq.html#add-new-individuals"><i class="fa fa-check"></i><b>8.5</b> Add new individuals</a></li>
<li class="chapter" data-level="8.6" data-path="faq.html"><a href="faq.html#results-differ-from-colony"><i class="fa fa-check"></i><b>8.6</b> Results differ from COLONY</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="./../../vignette_age/book/index.html">Ageprior Vignette</a></li>
<li><a href="./../../index.html">Other Manuals</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sequoia User Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sequoia-input" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> <code>sequoia()</code> input<a href="sequoia-input.html#sequoia-input" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="sec:GenoFormat" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Genotypes<a href="sequoia-input.html#sec:GenoFormat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The SNP data should be provided as a numeric matrix <code>GenoM</code> with one line per individual, and one column per SNP, with each SNP is coded as 0, 1, 2 copies of the reference allele, or missing (-9). The rownames should be the individual IDs, and column names are ignored.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="sequoia-input.html#cb1-1" tabindex="-1"></a>GenoM <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">read.table</span>(<span class="st">&quot;MyGenoData.txt&quot;</span>, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">header=</span><span class="cn">FALSE</span>))</span></code></pre></div>
<p>When the genotype data is in another format, such as Colony input files or PLINK’s .ped or .raw files, <code>GenoConvert()</code> can be used.</p>
<div id="subset-snps" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Subset SNPs<a href="sequoia-input.html#subset-snps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using tens of thousands of SNP markers for pedigree reconstruction is unnecessary, will slow down computation, and may even hamper inferences by their non-independence. Rather, a subset of SNPs with a decent genotyping call rate (e.g. <span class="math inline">\(&gt;0.9\)</span>), in low linkage disequilibrium (LD) with each other, and with high minor allele frequencies (e.g. MAF <span class="math inline">\(&gt; 0.3\)</span>) ought to be selected first if more than a few hundred SNPs are available. The calculations assume independence of markers, and while low (background) levels of LD are unlikely to interfere with pedigree reconstruction, high levels may give spurious results. The recommended maximum number of SNPs therefore depends on genome size and chromosome number. Markers with a high MAF provide the most information, as although rare allele provide strong evidence when they are inherited, this does not balance out the rarity of such events.</p>
<p>It is advised to ‘tweak’ the filtering thresholds until a set with a few hundred SNPs (300–700) is created. To assist with this, the function <code>SnpStats()</code> gives for each SNP both the allele frequency and the missingness. In addition, when a pedigree is provided (e.g. an existing one, or from a preliminary parentage-only run), the number of Mendelian errors per SNP is calculated and used to estimate the genotyping error rate.</p>
</div>
<div id="plink" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> PLINK<a href="sequoia-input.html#plink" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since the full dataset may be too large to easily load into R, creating a subset of SNPs can for example be done using <a href="https://www.cog-genomics.org/plink/">PLINK</a>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="sequoia-input.html#cb2-1" tabindex="-1"></a><span class="ex">plink</span> <span class="at">--file</span> mydata <span class="at">--geno</span> 0.1 <span class="at">--maf</span> 0.3 <span class="at">--indep</span> 50 5 2</span></code></pre></div>
<p>which on a windows machine is equivalent to running inside R</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sequoia-input.html#cb3-1" tabindex="-1"></a><span class="fu">system</span>(<span class="st">&quot;cmd&quot;</span>, <span class="at">input =</span> <span class="st">&quot;plink --file mydata --maf 0.3 --indep 50 5 2&quot;</span>)</span></code></pre></div>
<p>This will create a list of SNPs with a missingness below 0.1, a minor allele frequency of at least 0.3, and which in a window of 50 SNPs, sliding by 5 SNPs per step, have a VIF of maximum 2. VIF, or variance inflation factor, is <span class="math inline">\(1/(1-r^2)\)</span>. For further details, see the <a href="https://www.cog-genomics.org/plink2/ld#indep">plink website</a>.</p>
<p>The resulting list (<code>plink.prune.in</code>) can be used to create the genotype file used as input for Sequoia, with SNPs codes as 0, 1, 2, or NA, with the command</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="sequoia-input.html#cb4-1" tabindex="-1"></a><span class="ex">plink</span> <span class="at">--file</span> mydata <span class="at">--extract</span> plink.prune.in <span class="at">--recodeA</span> <span class="at">--out</span> inputfile_for_sequoia</span></code></pre></div>
<p>This will create a file with the extension .RAW, which can be converted to the required input format using</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sequoia-input.html#cb5-1" tabindex="-1"></a>GenoM <span class="ot">&lt;-</span> <span class="fu">GenoConvert</span>(<span class="at">InFile =</span> <span class="st">&quot;inputfile_for_sequoia.raw&quot;</span>, <span class="at">InFormat=</span><span class="st">&quot;raw&quot;</span>)</span></code></pre></div>
<p>This function can also convert from two-columns-per-SNP format, as e.g. used by Colony.</p>
<div id="family-ids" class="section level4 hasAnchor" number="4.1.2.1">
<h4><span class="header-section-number">4.1.2.1</span> Family IDs<a href="sequoia-input.html#family-ids" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>By default, the ‘Family ID’ (1st) column in the PLINK file is ignored, and IDs are extracted from the second column only. If the family IDs are essential to distinguish between individuals, use <code>GenoConvert()</code> with the flag <code>UseFID = TRUE</code> which will combine individual IDs and family IDs as FID__IID. Ensure the IDs in the life history file are in the same format, for example by using <code>LHConvert()</code>. The FID and IID can be split again in the resulting pedigree using <code>PedStripFID()</code>.</p>
</div>
</div>
<div id="low-call-rate" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Low call rate<a href="sequoia-input.html#low-call-rate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Samples with a very low genotyping success rate (call rate) can sometimes wrongly be assigned as parents to unrelated individuals, as <code>sequoia()</code> does not (yet) deal perfectly with these cases. In addition, at least in my experience with SNP arrays, a low sample call rate is often indicative of poor sample quality or a poor genotyping run, and associated with a high sample error rate.
Samples with a call rate below 5% are automatically excluded, but it is strongly advised to create a subset where all individuals are genotyped for at least 50% of SNPs, and preferably for at least 80%.</p>
<p>In addition, SNPs with a call rate below 10% are excluded, as these contribute almost no information. Again, a stricter threshold is advised of at least 50% to minimise the risk of spurious results.</p>
<p>Checks for individuals and SNPs with low call rate, and monomorphic SNPs, are done automatically when calling <code>sequoia()</code> and various other functions, and can be done separately by calling <code>CheckGeno()</code>.</p>
</div>
<div id="very-large-datasets" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Very large datasets<a href="sequoia-input.html#very-large-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When the number of individuals is very large, it may be impossible to load the genotype data into R as it will exceed R’s memory limit. A stand-alone version of the algorithm underlying this R package does not suffer from this limitation, and is available as Fortran source code from <a href="https://github.com/JiscaH/sequoia_notR">github</a>, where you can also find its manual. The standalone is not faster than the R package, as the bulk of the computations are done in Fortran regardless.</p>
</div>
</div>
<div id="birth-years-sex" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Birth years &amp; sex<a href="sequoia-input.html#birth-years-sex" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The relative age of individuals can greatly improve pedigree reconstruction (see <a href="key-points.html#sec:BY-AP">Birth years &amp; Ageprior</a>), and sex information is necessary to determine whether a candidate parent is the mother or father.</p>
<div id="lifehistdata" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> LifeHistData<a href="sequoia-input.html#lifehistdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The life history data (<code>LifeHistData</code>) should be a dataframe with three or five columns (column names are ignored, order is important!):</p>
<ul>
<li><strong>ID</strong><br />
It is probably safest to stick to R’s ‘syntactically valid names’, defined as “consists of letters, numbers and the dot or underline characters and starts with a letter, or the dot not followed by a number”.</li>
<li><strong>Sex</strong><br />
1 = female, 2 = male, 3=unknown, 4=hermaphrodites. All other numbers, letters, or NA = unknown</li>
<li><strong>BirthYear</strong><br />
Year of birth/hatching/germination/… In species with more than one generation per year, a finer time scale than year of birth ought to be used (in round numbers), ensuring that parents are always ‘born’ in a time unit prior to their first offspring (e.g. parent’s BirthYear=2001 (<span class="math inline">\(t=1\)</span>) and offspring BirthYear=2005 (<span class="math inline">\(t=5\)</span>)). Negative numbers and NA’s are interpreted as unknown.</li>
<li><strong>BY.min</strong> (optional)<br />
Earliest year in which individual may have been born, if exact year is unknown. Ignored when BirthYear is non-missing.</li>
<li><strong>BY.max</strong> (optional)<br />
Latest year in which individual may have been born</li>
</ul>
<p>Ideally this basic life history information is provided for all genotyped individuals, but this is not strictly necessary. This dataframe may be in a different order than the genotype data, and may include many more individuals (which are ignored).</p>
</div>
<div id="unknown-birth-years" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Unknown birth years<a href="sequoia-input.html#unknown-birth-years" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The year of birth may be unknown for some individuals, and for those <code>sequoia()</code> cannot determine whether they are the parent or the offspring if a genetic parent-offspring pair is found (unless a ‘complementary’ co-parent is identified). Especially in wild populations this information can be unknown for a substantial part of the sample, but often a minimum and/or maximum possible birth year (<code>BY.min</code> and <code>BY.max</code>) can be determined. For example, <code>BY.max</code> is at the latest the first year in which an individual was observed.</p>
<table>
<caption><span id="tab:BY-example">Table 4.1: </span>Example LifeHistData with the optional columns for minimum + maximum birth year</caption>
<thead>
<tr class="header">
<th align="left">ID</th>
<th align="right">Sex</th>
<th align="right">BirthYear</th>
<th align="right">BY.min</th>
<th align="right">BY.max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alpha</td>
<td align="right">2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">2010</td>
</tr>
<tr class="even">
<td align="left">Beta</td>
<td align="right">2</td>
<td align="right">2012</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Gamma</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">2008</td>
<td align="right">2009</td>
</tr>
</tbody>
</table>
<p>Even very wide ranges may help in pedigree reconstruction: for example, Alpha and Beta are genetically identified to be parent and offspring, Alpha was first seen in 2011 as an adult, and Beta was known to be born 2012 (Table <a href="sequoia-input.html#tab:BY-example">4.1</a>). Then Alpha is certainly the parent of Beta. Before version 2.0 there was no method to inform <code>sequoia</code> that Alpha could not have been born after 2012, and thus could not be an offspring of Beta. It was (and still is) possible to ‘guestimate’ birth years, but this can be time consuming and is potentially prone to errors. For example, if Alpha also forms a genetic parent-offspring pair with Gamma, then setting Alpha’s birth year to 2010 will result in it being assigned as Gamma’s offspring, while it may just as well be Gamma’s parent.</p>
<p>To minimise such pedigree errors where parent and offspring are flipped the wrong way around, and the ‘secondary’ errors derived from these cases, it is recommended to set the possible birth year range as wide as possible, at least during an initial (preliminary) round of parentage assignment. To see the pairs that are genetically parent and offspring, but for which it cannot be determined which of the two is the parent, use function <code>GetMaybeRel()</code>.</p>
</div>
<div id="sec:custom-AP" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> <code>args.AP</code> (Customising the ageprior)<a href="sequoia-input.html#sec:custom-AP" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When running <code>sequoia()</code>, you can pass arguments to <code>MakeAgePrior()</code> via <code>args.AP</code>. For example, when you are sure generations do not overlap, you can specify this via <code>MakeAgePrior()</code>’s argument <code>Discrete</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sequoia-input.html#cb6-1" tabindex="-1"></a>SeqOUT <span class="ot">&lt;-</span> <span class="fu">sequoia</span>(<span class="at">GenoM =</span> Geno, <span class="at">LifeHistData =</span> LH,</span>
<span id="cb6-2"><a href="sequoia-input.html#cb6-2" tabindex="-1"></a>                  <span class="at">args.AP =</span> <span class="fu">list</span>(<span class="at">Discrete =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>Or you can specify that the maximum age of (non-genotyped) parents exceeds the observed age range among SNP-genotyped parent-offspring pairs in <code>PedigreePar</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="sequoia-input.html#cb7-1" tabindex="-1"></a>SeqOUT <span class="ot">&lt;-</span> <span class="fu">sequoia</span>(<span class="at">GenoM =</span> Geno, <span class="at">LifeHistData =</span> LH,</span>
<span id="cb7-2"><a href="sequoia-input.html#cb7-2" tabindex="-1"></a>                  <span class="at">args.AP =</span> <span class="fu">list</span>(<span class="at">MaxAgeParent =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">9</span>)),  <span class="co"># dams, sires</span></span>
<span id="cb7-3"><a href="sequoia-input.html#cb7-3" tabindex="-1"></a>                  <span class="at">SeqList =</span> ParOUT[<span class="fu">c</span>(<span class="st">&quot;Specs&quot;</span>, <span class="st">&quot;PedigreePar&quot;</span>)])</span></code></pre></div>
<p>Alternatively, if you have a field-pedigree or microsatellite-based pedigree that contains many more individuals than have been SNP-genotyped, an ageprior estimated from that old pedigree will be more informative than the one estimated from a limited number of SNP-genotyped parent-offspring pairs. This can be done as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="sequoia-input.html#cb8-1" tabindex="-1"></a>APfromOld <span class="ot">&lt;-</span> <span class="fu">MakeAgePrior</span>(<span class="at">Pedigree =</span> MyOldPedigree,</span>
<span id="cb8-2"><a href="sequoia-input.html#cb8-2" tabindex="-1"></a>                          <span class="at">LifeHistData =</span> LH,</span>
<span id="cb8-3"><a href="sequoia-input.html#cb8-3" tabindex="-1"></a>                          <span class="at">Smooth =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="sequoia-input.html#cb8-4" tabindex="-1"></a>SeqOUT <span class="ot">&lt;-</span> <span class="fu">sequoia</span>(<span class="at">GenoM =</span> Geno,</span>
<span id="cb8-5"><a href="sequoia-input.html#cb8-5" tabindex="-1"></a>                  <span class="at">LifeHistData =</span> LH,</span>
<span id="cb8-6"><a href="sequoia-input.html#cb8-6" tabindex="-1"></a>                  <span class="at">SeqList =</span> <span class="fu">list</span>(<span class="at">AgePriors =</span> APfromOld))</span></code></pre></div>
<p>When argument <code>SeqList</code> contains an element <code>AgePriors</code>, it is used during both parentage assignment and sibship clustering. Thus, if you wish to use different agepriors during those different phases, you need to run them separately (see <a href="sequoia-input.html#sec:reuse">reuse</a>).</p>
<p>For further information on the ageprior, please see the separate vignette on this topic. If you wish to manually edit the <code>AgePriors</code> matrix before using it as input in <code>sequoia()</code>, or have done so in the past, it is advised to look at the latest version of this document, as the implementation has changed in package version 2.0, and the documentation was clarified in version 2.1.</p>
</div>
</div>
<div id="tfilter-tassign" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> <code>Tfilter</code> &amp; <code>Tassign</code><a href="sequoia-input.html#tfilter-tassign" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These are threshold values for log10-likelihood ratios (LLRs).</p>
<p><code>Tfilter</code> is the threshold LLR between a proposed relationship versus unrelated, to select candidate relatives. It is typically negative, and a more negative value may prevent filtering out of true relatives, but will increase computational time.</p>
<p><code>Tassign</code> is the threshold used for acceptance of a proposed relationship, and is relative to next most likely relationship. It must be positive, with higher values resulting in more conservative assignments. Counter-intuitively a high <code>Tassign</code> can sometimes <em>increase</em> the number of wrong assignments, as a correct low-threshold assignment may prevent wrong assignments among close relatives (a.o. by revealing genotyping errors and changing the most-likely true genotype of an individual).</p>
<p>The default values of <code>Tfilter</code> and <code>Tassign</code> seem to work well in a wide range of datasets, but their interaction with genotyping error rate and other dataset characteristics has not been thoroughly explored.</p>
</div>
<div id="sec:Complx" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> <code>Complex</code><a href="sequoia-input.html#sec:Complx" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The complexity of the mating system considered. One of:</p>
<ul>
<li><strong><code>mono</code></strong>
Only consider monogamous matings. This can be especially useful for small SNP panels that have insufficient power to distinguish reliably between full siblings and half-siblings, but may have ample power to distinguish between full siblings and third degree relatives (e.g. full cousins). Works well when full aunts/uncles and grandparents differ consistently more in age than full siblings, and do not have to be considered as alternatives to full sibling either.</li>
<li><strong><code>simp</code></strong>
Consider polygamous matings, but ignore all inbred and double relationships (see below). Such relationships may still be assigned as side-effect. This again can be useful if the SNP panel has limited power, and the occurrence of such complex relationships is very rare.</li>
<li><strong><code>full</code></strong>
The default, do consider all kinds of relationship combinations.</li>
</ul>
<div id="sec:WeirdRels" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Unusual relationships<a href="sequoia-input.html#sec:WeirdRels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pedigree inference is often applied in small, (semi-)closed populations, and is regularly done to check for inbreeding. In such cases, pairs of individuals may be related via more than one route. For example, maternal half-siblings may also be niece and aunt via the paternal side, and be mistaken for full-siblings. Or a pair may be both paternal half-siblings, and maternal full cousins. A range of such double relationships is considered explicitly (Table <a href="sequoia-input.html#tab:DoubleRels">4.2</a>) to minimise such mistakes. If such a type is common in your population but not yet considered by <code>sequoia</code>, and seems to be causing problems, please send me an email as adding additional relationships is relatively straightforward.</p>
<table>
<caption><span id="tab:DoubleRels">Table 4.2: </span>Double relationships between pairs of individuals. Abbreviations as before, and GGG=great-grandparent, F1C=full first cousins, H1C=half first cousins (parents are HS).</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">PO</th>
<th align="left">FS</th>
<th align="left">HS</th>
<th align="left">GP</th>
<th align="left">FA</th>
<th align="left">HA</th>
<th align="left">GGG</th>
<th align="left">F1C</th>
<th align="left">H1C</th>
<th align="left">U</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PO</td>
<td align="left">–</td>
<td align="left">–</td>
<td align="left">Y</td>
<td align="left">Y</td>
<td align="left"></td>
<td align="left">Y</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Y</td>
</tr>
<tr class="even">
<td align="left">FS</td>
<td align="left">–</td>
<td align="left">–</td>
<td align="left">–</td>
<td align="left">–</td>
<td align="left">–</td>
<td align="left">Y</td>
<td align="left"></td>
<td align="left">–</td>
<td align="left">Y</td>
<td align="left">Y</td>
</tr>
<tr class="odd">
<td align="left">HS</td>
<td align="left">Y</td>
<td align="left">–</td>
<td align="left">(FS)</td>
<td align="left">Y</td>
<td align="left">Y <sup>2</sup></td>
<td align="left">Y</td>
<td align="left">Y <sup>2</sup></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Y</td>
</tr>
<tr class="even">
<td align="left">GP</td>
<td align="left">Y</td>
<td align="left">–</td>
<td align="left">Y</td>
<td align="left"><sup>1</sup></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Y</td>
</tr>
<tr class="odd">
<td align="left">FA</td>
<td align="left"></td>
<td align="left">–</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Y</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Y</td>
</tr>
<tr class="even">
<td align="left">HA</td>
<td align="left"></td>
<td align="left">Y</td>
<td align="left">Y <sup>2</sup></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Y</td>
</tr>
<tr class="odd">
<td align="left">GGG</td>
<td align="left"></td>
<td align="left">–</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"><sup>3</sup></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Y</td>
</tr>
<tr class="even">
<td align="left">F1C</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Y</td>
</tr>
</tbody>
</table>
<p>–: impossible<br />
Y: explicitly considered<br />
empty: not (yet) explicitly considered (but may be inferred as ‘side effect’)<br />
<sup>1</sup>: Can not be considered explicitly, as likelihood identical to PO<br />
<sup>2</sup>: Including the special case were one is inbred<br />
<sup>3</sup>: Can not be considered explicitly, as likelihood identical to GP</p>
<!-- &nbsp;    extra empty line-->
</div>
</div>
<div id="herm" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> <code>Herm</code><a href="sequoia-input.html#herm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hermaphrodites, one of:
* <strong><code>no</code></strong>
Dioecious (separate sexes) species
* <strong><code>A</code></strong>
Heed dam versus sire role of individuals, and assign a parent only if it is clear that it was the female or male parent of an individual. Requires a pedigree prior (e.g. the plant from which the seed was collected), or age difference between maternal versus paternal role (see <a href="#sec:Herm">Hermaphrodites</a>.
* <strong><code>B</code></strong>
No distinction is made between dam versus sire role; any parent is assigned in the first available ‘slot’, and no conclusions can be drawn from whether individuals are assigned as maternal, paternal or ‘cross’ half-siblings.</p>
<p>If any individuals in the life history data have sex=4, <code>Herm='no'</code> will automatically be changed into <code>Herm='A'</code>. Hermaphrodites may be mixed with known-sex (or known sex role) individuals. <code>Herm='A'</code> or ‘B’ can also be selected if none of the genotyped individuals are hermaphrodites, but non-genotyped (dummy) parents could be.</p>
</div>
<div id="useage" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> <code>UseAge</code><a href="sequoia-input.html#useage" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The strength of reliance on birth year information during full pedigree reconstruction.</p>
<p>In addition to providing no birth year information at all, there are three possible levels of reliance on <a href="key-points.html#sec:BY-AP">birth years and ageprior</a> during full pedigree reconstruction:</p>
<ul>
<li><strong><code>no</code></strong>
Only use the ageprior matrix to determine which age difference – relationship combinations are possible and which are not, i.e. simplifying the ageprior to a 0/1 (FALSE/TRUE) matrix.</li>
<li><strong><code>yes</code></strong> (default)
Use age information in a restrictive way: only accept a proposed assignment if both the purely genetic LLR (<span class="math inline">\(LLR_{SNP}\)</span>) and the sum of <span class="math inline">\(LLR_{SNP}\)</span> and log10 of the ageprior’s probability ratios (<span class="math inline">\(LLR_{age}\)</span>) pass <span class="math inline">\(T_{assign}\)</span> (Note that the ageprior matrix is not on a log scale, and that <span class="math inline">\(log(0) = -Inf\)</span>, and <span class="math inline">\(log(1)=0\)</span>). Thus, relationships that are genetically likely but unlikely based on the age difference, will not be assigned.</li>
<li><strong><code>extra</code></strong>
Use age information in a permissive way: accept a proposed assignment if <span class="math inline">\(LLR_{SNP} + LLR_{age}\)</span> passes <span class="math inline">\(T_{assign}\)</span>, even if <span class="math inline">\(LLR_{SNP}\)</span> on its own does not. Thus, a pair for which genetically the relationship is ambivalent (e.g. ‘either one of HS, GP, FA’), but whose age difference makes one of these relationships (much) more likely, are now also assigned (see example). The risk of a cascading avalanche of assignment errors is reduced by first running the algorithm as for <code>UseAge = 'yes'</code>, and only once the total likelihood has plateaued switching to <code>UseAge = 'extra'</code> (and continuing until the total likelihood plateaus again).</li>
</ul>
<table>
<caption><span id="tab:UseAge">Table 4.3: </span>Parameter ‘UseAge’ (see text for definitions)</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">no</th>
<th align="center">yes</th>
<th align="center">extra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(LR_{age} &gt; 0\)</span></td>
<td align="center">Y</td>
<td align="center">Y</td>
<td align="center">Y</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(LLR_{SNP} &gt; T_{assign}\)</span></td>
<td align="center">Y</td>
<td align="center">Y</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(LLR_{SNP} + LLR_{age} &gt; T_{assign}\)</span></td>
<td align="center"></td>
<td align="center">Y</td>
<td align="center">Y</td>
</tr>
</tbody>
</table>
<p>Below an example of how to calculate <span class="math inline">\(LLR_{SNP}\)</span> and <span class="math inline">\(LLR_{age}\)</span>, for a grandparent – grand-offspring pair from the griffin example pedigree, with an age difference of 4 years. This pair would not be assigned with <code>UseAge = 'yes'</code>, as purely genetically the likelihoods for the pair being HS, GP or FA are identical (unless both individuals already have at least 1 parent assigned), but would get assigned with <code>UseAge = 'extra'</code>, as in this fictional population 4-year-older paternal grandmothers are about 10x as common as 4-year-older paternal aunts (difference of 1 unit on log10-scale).</p>
<p>Such assignments which rely strongly on the age difference of a pair, in combination with the estimated age distribution of relative pairs, are often not desirable, and are therefore not made by default (<code>UseAge = 'yes'</code>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sequoia-input.html#cb9-1" tabindex="-1"></a><span class="fu">data</span>(Ped_griffin, SeqOUT_griffin, <span class="at">package=</span><span class="st">&quot;sequoia&quot;</span>)</span>
<span id="cb9-2"><a href="sequoia-input.html#cb9-2" tabindex="-1"></a>GenoX <span class="ot">&lt;-</span> <span class="fu">SimGeno</span>(Ped_griffin, <span class="at">nSnp =</span> <span class="dv">400</span>, <span class="at">ParMis=</span><span class="dv">0</span>)</span>
<span id="cb9-3"><a href="sequoia-input.html#cb9-3" tabindex="-1"></a>LLR_SNP <span class="ot">&lt;-</span> <span class="fu">CalcPairLL</span>(<span class="at">Pairs =</span> <span class="fu">data.frame</span>(<span class="at">ID1=</span><span class="st">&quot;i122_2007_M&quot;</span>, <span class="at">ID2=</span><span class="st">&quot;i042_2003_F&quot;</span>), </span>
<span id="cb9-4"><a href="sequoia-input.html#cb9-4" tabindex="-1"></a>                      <span class="at">GenoM =</span> GenoX, <span class="at">Plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb9-5"><a href="sequoia-input.html#cb9-5" tabindex="-1"></a>LLR_Age <span class="ot">&lt;-</span> <span class="fu">GetLLRAge</span>(SeqOUT_griffin<span class="sc">$</span>AgePriorExtra, <span class="at">agedif=</span><span class="dv">4</span>, <span class="at">patmat=</span><span class="dv">2</span>)</span>
<span id="cb9-6"><a href="sequoia-input.html#cb9-6" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(<span class="at">SNP =</span> LLR_SNP[,<span class="fu">colnames</span>(LLR_Age)],</span>
<span id="cb9-7"><a href="sequoia-input.html#cb9-7" tabindex="-1"></a>                   <span class="at">Age =</span> LLR_Age,</span>
<span id="cb9-8"><a href="sequoia-input.html#cb9-8" tabindex="-1"></a>                   <span class="st">&quot;SNP + Age&quot;</span> <span class="ot">=</span> LLR_SNP[,<span class="fu">colnames</span>(LLR_Age)] <span class="sc">+</span></span>
<span id="cb9-9"><a href="sequoia-input.html#cb9-9" tabindex="-1"></a>                     LLR_Age),</span>
<span id="cb9-10"><a href="sequoia-input.html#cb9-10" tabindex="-1"></a>             <span class="at">digits=</span><span class="dv">1</span>, <span class="at">booktabs=</span><span class="cn">TRUE</span>, </span>
<span id="cb9-11"><a href="sequoia-input.html#cb9-11" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;LLR example for a grandparent - grand-offspring pair&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:griffin-useAge-1">Table 4.4: </span>LLR example for a grandparent - grand-offspring pair</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">PO</th>
<th align="right">FS</th>
<th align="right">HS</th>
<th align="right">GP</th>
<th align="right">FA</th>
<th align="right">HA</th>
<th align="right">U</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SNP</td>
<td align="right">-401.9</td>
<td align="right">-334.6</td>
<td align="right">-326.4</td>
<td align="right">-326.4</td>
<td align="right">-326.4</td>
<td align="right">-326.0</td>
<td align="right">-328.9</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="right">-0.4</td>
<td align="right">-3.0</td>
<td align="right">-3.0</td>
<td align="right">0.3</td>
<td align="right">-0.3</td>
<td align="right">-0.3</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">SNP + Age</td>
<td align="right">-402.3</td>
<td align="right">-337.6</td>
<td align="right">-329.4</td>
<td align="right">-326.1</td>
<td align="right">-326.8</td>
<td align="right">-326.3</td>
<td align="right">-328.9</td>
</tr>
</tbody>
</table>
</div>
<div id="sec:reuse" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> <code>SeqList</code><a href="sequoia-input.html#sec:reuse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Parameter settings and input data from one <code>sequoia()</code> run can be re-used in a subsequent <code>sequoia()</code> run, and as input by various other functions (Table <a href="function-overview.html#tab:CoreFun">3.1</a>). This makes it easier to have consistent parameter values and input data across different pedigree inference runs and different functions.</p>
<p>The parameter values used as arguments when calling <code>sequoia()</code> are returned in the list element <code>Specs</code>. This 1-row dataframe may be edited (with caution!) before re-use. Other elements of the <code>sequoia()</code> output list (<code>SeqList</code>) that are used as input by one or more functions are <code>LifeHist</code>, <code>AgePriors</code>, and <code>PedigreePar</code>/<code>Pedigree</code>. Details on which elements are used is provided in the help file of each function.
<code>SeqList[["Specs"]]</code> nearly always take precedent over similarly-named input parameters, with exception of e.g. <code>sequoia()</code>‘s <code>Module</code> (<code>MaxSibIter</code>) argument. The other <code>SeqList</code> elements generally also take precedent, but not always with a warning. If you wish to use a mixture of <code>SeqList</code> elements and ’new’ data, it is safest to provide only the minimal subset of <code>SeqList</code>, and specify the other data as separate input (or as ‘fake’ <code>SeqList</code> elements).</p>
<p>For example, if you wish to change the dummy prefix, but do not want to re-run parentage assignment:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="sequoia-input.html#cb10-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;Sequoia_output_date.RData&quot;</span>)  <span class="co"># output from an old sequoia run that was saved to disk</span></span>
<span id="cb10-2"><a href="sequoia-input.html#cb10-2" tabindex="-1"></a>ParOUT<span class="sc">$</span>Specs<span class="sc">$</span>DummyPrefixFemale <span class="ot">&lt;-</span> <span class="st">&quot;D-FEM&quot;</span></span>
<span id="cb10-3"><a href="sequoia-input.html#cb10-3" tabindex="-1"></a>ParOUT<span class="sc">$</span>Specs<span class="sc">$</span>DummyPrefixMale <span class="ot">&lt;-</span> <span class="st">&quot;D-MALE&quot;</span></span>
<span id="cb10-4"><a href="sequoia-input.html#cb10-4" tabindex="-1"></a>SeqOUTX <span class="ot">&lt;-</span> <span class="fu">sequoia</span>(<span class="at">GenoM =</span> Geno,</span>
<span id="cb10-5"><a href="sequoia-input.html#cb10-5" tabindex="-1"></a>                  <span class="at">SeqList =</span> ParOUT[<span class="fu">c</span>(<span class="st">&quot;Specs&quot;</span>, <span class="st">&quot;PedigreePar&quot;</span>, <span class="st">&quot;LifeHist&quot;</span>)],</span>
<span id="cb10-6"><a href="sequoia-input.html#cb10-6" tabindex="-1"></a>                  <span class="at">Module =</span> <span class="st">&quot;ped&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="function-overview.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="running-sequoia.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
