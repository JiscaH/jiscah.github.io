<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Output check | Sequoia User Guide</title>
  <meta name="description" content="6 Output check | Sequoia User Guide" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Output check | Sequoia User Guide" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/../../sequoia_logo.png" />
  
  <meta name="github-repo" content="JiscaH/sequoia" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Output check | Sequoia User Guide" />
  
  
  <meta name="twitter:image" content="/../../sequoia_logo.png" />

<meta name="author" content="Jisca Huisman" />


<meta name="date" content="2021-05-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png" />
  <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
<link rel="prev" href="running-sequoia.html"/>
<link rel="next" href="hermaphrodites.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./../../../index.html"><img src="../../home-solid-silver.svg" height="40" alt="home"/></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="sec-Background.html"><a href="sec-Background.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="key-points.html"><a href="key-points.html"><i class="fa fa-check"></i><b>2</b> Key Points</a>
<ul>
<li class="chapter" data-level="2.1" data-path="key-points.html"><a href="key-points.html#sec:MendelErrors"><i class="fa fa-check"></i><b>2.1</b> Mendelian Errors</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="key-points.html"><a href="key-points.html#parent-pairs"><i class="fa fa-check"></i><b>2.1.1</b> Parent-pairs</a></li>
<li class="chapter" data-level="2.1.2" data-path="key-points.html"><a href="key-points.html#maximum-mismatches"><i class="fa fa-check"></i><b>2.1.2</b> Maximum mismatches</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="key-points.html"><a href="key-points.html#likelihoods"><i class="fa fa-check"></i><b>2.2</b> Likelihoods</a></li>
<li class="chapter" data-level="2.3" data-path="key-points.html"><a href="key-points.html#sec:GenoErrors"><i class="fa fa-check"></i><b>2.3</b> Genotyping errors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="key-points.html"><a href="key-points.html#effect"><i class="fa fa-check"></i><b>2.3.1</b> Effect</a></li>
<li class="chapter" data-level="2.3.2" data-path="key-points.html"><a href="key-points.html#assumed-genotyping-error-rate-err"><i class="fa fa-check"></i><b>2.3.2</b> Assumed genotyping error rate <code>Err</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="key-points.html"><a href="key-points.html#performance-with-high-genotyping-error-rates"><i class="fa fa-check"></i><b>2.3.3</b> Performance with high genotyping error rates</a></li>
<li class="chapter" data-level="2.3.4" data-path="key-points.html"><a href="key-points.html#effect-on-runtime"><i class="fa fa-check"></i><b>2.3.4</b> Effect on runtime</a></li>
<li class="chapter" data-level="2.3.5" data-path="key-points.html"><a href="key-points.html#error-matrix"><i class="fa fa-check"></i><b>2.3.5</b> Error matrix</a></li>
<li class="chapter" data-level="2.3.6" data-path="key-points.html"><a href="key-points.html#estimate"><i class="fa fa-check"></i><b>2.3.6</b> Estimate</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="key-points.html"><a href="key-points.html#sec:BY-AP"><i class="fa fa-check"></i><b>2.4</b> Birth years &amp; Ageprior</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="key-points.html"><a href="key-points.html#definition-interpretation"><i class="fa fa-check"></i><b>2.4.1</b> Definition &amp; interpretation</a></li>
<li class="chapter" data-level="2.4.2" data-path="key-points.html"><a href="key-points.html#implementation"><i class="fa fa-check"></i><b>2.4.2</b> Implementation</a></li>
<li class="chapter" data-level="2.4.3" data-path="key-points.html"><a href="key-points.html#smooth-flatten"><i class="fa fa-check"></i><b>2.4.3</b> Smooth &amp; Flatten</a></li>
<li class="chapter" data-level="2.4.4" data-path="key-points.html"><a href="key-points.html#age-based-non-assignment"><i class="fa fa-check"></i><b>2.4.4</b> Age-based non-assignment</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="key-points.html"><a href="key-points.html#parent-llr"><i class="fa fa-check"></i><b>2.5</b> Parent LLR</a></li>
<li class="chapter" data-level="2.6" data-path="key-points.html"><a href="key-points.html#sec:EstConf"><i class="fa fa-check"></i><b>2.6</b> Confidence</a></li>
<li class="chapter" data-level="2.7" data-path="key-points.html"><a href="key-points.html#sec:lowAR"><i class="fa fa-check"></i><b>2.7</b> Low assignment rate</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="key-points.html"><a href="key-points.html#causes"><i class="fa fa-check"></i><b>2.7.1</b> Causes</a></li>
<li class="chapter" data-level="2.7.2" data-path="key-points.html"><a href="key-points.html#remedies"><i class="fa fa-check"></i><b>2.7.2</b> Remedies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="function-overview.html"><a href="function-overview.html"><i class="fa fa-check"></i><b>3</b> Function overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="function-overview.html"><a href="function-overview.html#input"><i class="fa fa-check"></i><b>3.1</b> Input</a></li>
<li class="chapter" data-level="3.2" data-path="function-overview.html"><a href="function-overview.html#simulate"><i class="fa fa-check"></i><b>3.2</b> Simulate</a></li>
<li class="chapter" data-level="3.3" data-path="function-overview.html"><a href="function-overview.html#ageprior"><i class="fa fa-check"></i><b>3.3</b> Ageprior</a></li>
<li class="chapter" data-level="3.4" data-path="function-overview.html"><a href="function-overview.html#pedigree-reconstruction"><i class="fa fa-check"></i><b>3.4</b> Pedigree reconstruction</a></li>
<li class="chapter" data-level="3.5" data-path="function-overview.html"><a href="function-overview.html#pedigree-check"><i class="fa fa-check"></i><b>3.5</b> Pedigree check</a></li>
<li class="chapter" data-level="3.6" data-path="function-overview.html"><a href="function-overview.html#pairwise-relationships"><i class="fa fa-check"></i><b>3.6</b> Pairwise relationships</a></li>
<li class="chapter" data-level="3.7" data-path="function-overview.html"><a href="function-overview.html#miscellaneous"><i class="fa fa-check"></i><b>3.7</b> Miscellaneous</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sequoia-input.html"><a href="sequoia-input.html"><i class="fa fa-check"></i><b>4</b> <code>sequoia()</code> input</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:GenoFormat"><i class="fa fa-check"></i><b>4.1</b> Genotypes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sequoia-input.html"><a href="sequoia-input.html#subset-snps"><i class="fa fa-check"></i><b>4.1.1</b> Subset SNPs</a></li>
<li class="chapter" data-level="4.1.2" data-path="sequoia-input.html"><a href="sequoia-input.html#plink"><i class="fa fa-check"></i><b>4.1.2</b> PLINK</a></li>
<li class="chapter" data-level="4.1.3" data-path="sequoia-input.html"><a href="sequoia-input.html#low-call-rate"><i class="fa fa-check"></i><b>4.1.3</b> Low call rate</a></li>
<li class="chapter" data-level="4.1.4" data-path="sequoia-input.html"><a href="sequoia-input.html#very-large-datasets"><i class="fa fa-check"></i><b>4.1.4</b> Very large datasets</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sequoia-input.html"><a href="sequoia-input.html#birth-years-sex"><i class="fa fa-check"></i><b>4.2</b> Birth years &amp; sex</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sequoia-input.html"><a href="sequoia-input.html#lifehistdata"><i class="fa fa-check"></i><b>4.2.1</b> LifeHistData</a></li>
<li class="chapter" data-level="4.2.2" data-path="sequoia-input.html"><a href="sequoia-input.html#unknown-birth-years"><i class="fa fa-check"></i><b>4.2.2</b> Unknown birth years</a></li>
<li class="chapter" data-level="4.2.3" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:custom-AP"><i class="fa fa-check"></i><b>4.2.3</b> <code>args.AP</code> (Customising the ageprior)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sequoia-input.html"><a href="sequoia-input.html#tfilter-tassign"><i class="fa fa-check"></i><b>4.3</b> <code>Tfilter</code> &amp; <code>Tassign</code></a></li>
<li class="chapter" data-level="4.4" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:Complx"><i class="fa fa-check"></i><b>4.4</b> <code>Complex</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:WeirdRels"><i class="fa fa-check"></i><b>4.4.1</b> Unusual relationships</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sequoia-input.html"><a href="sequoia-input.html#herm"><i class="fa fa-check"></i><b>4.5</b> <code>Herm</code></a></li>
<li class="chapter" data-level="4.6" data-path="sequoia-input.html"><a href="sequoia-input.html#useage"><i class="fa fa-check"></i><b>4.6</b> <code>UseAge</code></a></li>
<li class="chapter" data-level="4.7" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:reuse"><i class="fa fa-check"></i><b>4.7</b> <code>SeqList</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="running-sequoia.html"><a href="running-sequoia.html"><i class="fa fa-check"></i><b>5</b> Running <code>sequoia()</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="running-sequoia.html"><a href="running-sequoia.html#module-maxsibiter"><i class="fa fa-check"></i><b>5.1</b> <code>Module</code> (<code>MaxSibIter</code>)</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="running-sequoia.html"><a href="running-sequoia.html#sec:MaxSibIter"><i class="fa fa-check"></i><b>5.1.1</b> <code>MaxSibIter</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="running-sequoia.html"><a href="running-sequoia.html#input-check"><i class="fa fa-check"></i><b>5.2</b> Input check</a></li>
<li class="chapter" data-level="5.3" data-path="running-sequoia.html"><a href="running-sequoia.html#check-for-duplicates"><i class="fa fa-check"></i><b>5.3</b> Check for duplicates</a></li>
<li class="chapter" data-level="5.4" data-path="running-sequoia.html"><a href="running-sequoia.html#parentage-assignment"><i class="fa fa-check"></i><b>5.4</b> Parentage assignment</a></li>
<li class="chapter" data-level="5.5" data-path="running-sequoia.html"><a href="running-sequoia.html#ageprior-1"><i class="fa fa-check"></i><b>5.5</b> AgePrior</a></li>
<li class="chapter" data-level="5.6" data-path="running-sequoia.html"><a href="running-sequoia.html#full-reconstruction"><i class="fa fa-check"></i><b>5.6</b> Full reconstruction</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="running-sequoia.html"><a href="running-sequoia.html#dummy-individuals"><i class="fa fa-check"></i><b>5.6.1</b> Dummy Individuals</a></li>
<li class="chapter" data-level="5.6.2" data-path="running-sequoia.html"><a href="running-sequoia.html#total-likelihood"><i class="fa fa-check"></i><b>5.6.2</b> Total likelihood</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="running-sequoia.html"><a href="running-sequoia.html#save-output"><i class="fa fa-check"></i><b>5.7</b> Save output</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="output-check.html"><a href="output-check.html"><i class="fa fa-check"></i><b>6</b> Output check</a>
<ul>
<li class="chapter" data-level="6.1" data-path="output-check.html"><a href="output-check.html#pedigree-stats-plots"><i class="fa fa-check"></i><b>6.1</b> Pedigree stats &amp; plots</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="output-check.html"><a href="output-check.html#negative-llrs"><i class="fa fa-check"></i><b>6.1.1</b> Negative LLR’s</a></li>
<li class="chapter" data-level="6.1.2" data-path="output-check.html"><a href="output-check.html#dyad-plot"><i class="fa fa-check"></i><b>6.1.2</b> Dyad plot</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="output-check.html"><a href="output-check.html#sec:compPed"><i class="fa fa-check"></i><b>6.2</b> Compare pedigrees</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="output-check.html"><a href="output-check.html#dummy-matching"><i class="fa fa-check"></i><b>6.2.1</b> Dummy matching</a></li>
<li class="chapter" data-level="6.2.2" data-path="output-check.html"><a href="output-check.html#example"><i class="fa fa-check"></i><b>6.2.2</b> Example</a></li>
<li class="chapter" data-level="6.2.3" data-path="output-check.html"><a href="output-check.html#colony"><i class="fa fa-check"></i><b>6.2.3</b> Colony</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="output-check.html"><a href="output-check.html#sec:compR"><i class="fa fa-check"></i><b>6.3</b> Relatedness</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="output-check.html"><a href="output-check.html#sec:Rped"><i class="fa fa-check"></i><b>6.3.1</b> Pedigree relatedness</a></li>
<li class="chapter" data-level="6.3.2" data-path="output-check.html"><a href="output-check.html#genomic-relatedness"><i class="fa fa-check"></i><b>6.3.2</b> Genomic relatedness</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="output-check.html"><a href="output-check.html#cluster-families"><i class="fa fa-check"></i><b>6.4</b> Cluster families</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hermaphrodites.html"><a href="hermaphrodites.html"><i class="fa fa-check"></i><b>7</b> Hermaphrodites</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hermaphrodites.html"><a href="hermaphrodites.html#herm-a-pedigree-prior"><i class="fa fa-check"></i><b>7.1</b> Herm ‘A’: Pedigree prior</a></li>
<li class="chapter" data-level="7.2" data-path="hermaphrodites.html"><a href="hermaphrodites.html#herm-b-ignore-sex-role"><i class="fa fa-check"></i><b>7.2</b> Herm ‘B’: Ignore sex role</a></li>
<li class="chapter" data-level="7.3" data-path="hermaphrodites.html"><a href="hermaphrodites.html#hermaphrodite-dummies"><i class="fa fa-check"></i><b>7.3</b> Hermaphrodite dummies</a></li>
<li class="chapter" data-level="7.4" data-path="hermaphrodites.html"><a href="hermaphrodites.html#assignment-errors"><i class="fa fa-check"></i><b>7.4</b> Assignment errors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>8</b> FAQ</a>
<ul>
<li class="chapter" data-level="8.1" data-path="faq.html"><a href="faq.html#error-aboutdue-to-input-data"><i class="fa fa-check"></i><b>8.1</b> Error about/due to input data</a></li>
<li class="chapter" data-level="8.2" data-path="faq.html"><a href="faq.html#sec:FAQlowAR"><i class="fa fa-check"></i><b>8.2</b> Low assignment rate</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="faq.html"><a href="faq.html#not-enough-snps"><i class="fa fa-check"></i><b>8.2.1</b> Not enough SNPs</a></li>
<li class="chapter" data-level="8.2.2" data-path="faq.html"><a href="faq.html#genotyping-errors"><i class="fa fa-check"></i><b>8.2.2</b> Genotyping errors</a></li>
<li class="chapter" data-level="8.2.3" data-path="faq.html"><a href="faq.html#lacking-sex-information"><i class="fa fa-check"></i><b>8.2.3</b> Lacking sex information</a></li>
<li class="chapter" data-level="8.2.4" data-path="faq.html"><a href="faq.html#insufficient-age-information"><i class="fa fa-check"></i><b>8.2.4</b> Insufficient age information</a></li>
<li class="chapter" data-level="8.2.5" data-path="faq.html"><a href="faq.html#uninformative-age-prior"><i class="fa fa-check"></i><b>8.2.5</b> Uninformative age prior</a></li>
<li class="chapter" data-level="8.2.6" data-path="faq.html"><a href="faq.html#mating-system"><i class="fa fa-check"></i><b>8.2.6</b> Mating system</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="faq.html"><a href="faq.html#death-year"><i class="fa fa-check"></i><b>8.3</b> Death year</a></li>
<li class="chapter" data-level="8.4" data-path="faq.html"><a href="faq.html#accuracy"><i class="fa fa-check"></i><b>8.4</b> Accuracy</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="faq.html"><a href="faq.html#field-pedigree"><i class="fa fa-check"></i><b>8.4.1</b> Field pedigree</a></li>
<li class="chapter" data-level="8.4.2" data-path="faq.html"><a href="faq.html#genomic-relatedness-1"><i class="fa fa-check"></i><b>8.4.2</b> Genomic relatedness</a></li>
<li class="chapter" data-level="8.4.3" data-path="faq.html"><a href="faq.html#data-simulation"><i class="fa fa-check"></i><b>8.4.3</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="faq.html"><a href="faq.html#add-new-individuals"><i class="fa fa-check"></i><b>8.5</b> Add new individuals</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="./../../vignette_age/book/index.html">Ageprior Vignette</a></li>
<li><a href="./../../index.html">Other Manuals</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sequoia User Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="output-check" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Output check</h1>
<hr />
<div id="pedigree-stats-plots" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Pedigree stats &amp; plots</h2>
<p>Various summary statistics can be calculated and displayed using <code>SummarySeq()</code>, such as the number and kind of assigned parents (Figure <a href="output-check.html#fig:SumSeq-parents">6.1</a>), family sizes (Figure <a href="output-check.html#fig:SumSeq-sibsize">6.2</a>), and the distributions of Mendelian errors. Its output also includes a table analogous to <code>pedigreeStats</code> by R package <code>pedantics</code> (which was archived on CRAN in December 2019).</p>
<div class="figure"><span id="fig:SumSeq-parents"></span>
<img src="figs/SummarySeq_deer.png" alt="Number of parents assigned to genotyped individuals, split by category" width="80%" />
<p class="caption">
Figure 6.1: Number of parents assigned to genotyped individuals, split by category
</p>
</div>
<div class="figure"><span id="fig:SumSeq-sibsize"></span>
<img src="figs/SummarySeq_deer_sibships.png" alt="Family sizes, split by genotyped (dark) or dummy (light) parent" width="80%" />
<p class="caption">
Figure 6.2: Family sizes, split by genotyped (dark) or dummy (light) parent
</p>
</div>
<p>There is a range of software available to plot pedigrees in various styles, such as R package <code>kinship2</code> or the program PedigreeViewer. Be aware that many use a different column order (id - sire - dam, rather than id - dam - sire), use <span class="math inline">\(0\)</span> to denote missing parents rather than NA, and/or do not allow individuals to have a single parent (they must have 0 or 2 parents). The last two issues can be resolved with <code>Sequoia</code>’s function <code>PedPolish()</code>.</p>
<!-- \clearpage  -->
<div id="negative-llrs" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Negative LLR’s</h3>
<p>The parent LLR’s are calculated based on genetic data only, without any consideration of age. Consequently, they are often close to zero for dummy – dummy parent-offspring pairs, as genetically the parent may just as well be the offspring. Such pairs will not have been assigned unless there is a compatible co-parent (<code>LLRpair</code> should always be positive) or if there is overwhelming age-based evidence to decide which one is the parent.</p>
<p>When a parental LLR is negative without an accompanying co-parent, or when <code>LLRpair</code> is negative, this is reason to cautious about the assignment and for example <a href="output-check.html#sec:compPed">compare it to a previous pedigree</a> or inspect the <a href="output-check.html#sec:compR">genomic relatedness</a>. In contrast to MCMC type approaches, <code>sequoia</code>’s algorithm has limited scope to undo previously made assignments, and may get stuck at suboptimal solutions.</p>
<p>Extremely negative LLRs (<span class="math inline">\(&lt; -100\)</span>) are typically caused by one or more of the alternative relationships considered, now conditional on the rest of the pedigree, being very convoluted and neither being caught as ‘highly improbable and not implemented’ nor being implemented properly (see Table <a href="sequoia-input.html#sec:WeirdRels">weird relationships</a> for double relationships that are implemented). In the unlikely event that the parent-offspring relationship itself is not implemented properly you will see an error value of 444 or 777.</p>
</div>
<div id="dyad-plot" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Dyad plot</h3>
<p>Per popular request, from version 2.1 sequoia includes <code>PlotRelPairs()</code> to produce pairwise plots, similar to Colony’s plot of half- and full-sibling dyads. It plots the output from <code>GetRelM()</code>, where you can specify if you want to trace each individual’s pedigree 1 generation back (as in Figure <a href="output-check.html#fig:Relplot">6.3</a>) or 2 (include grandparents &amp; aunts/uncles), and whether or not you want to differentiate between paternal and maternal relatives. It includes some basic functionality to subset individuals.</p>
<div class="figure"><span id="fig:Relplot"></span>
<img src="figs/RelPlot-griffin.png" alt="Example plot from PlotRelPairs()" width="100%" />
<p class="caption">
Figure 6.3: Example plot from PlotRelPairs()
</p>
</div>
</div>
</div>
<div id="sec:compPed" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Compare pedigrees</h2>
<p>Often a (part) pedigree is already available to which one wants to compare the newly inferred pedigree, for example to field-observed mothers or a microsatellite-based pedigree. <code>PedCompare()</code> compares for each individual the assigned parents between the two pedigrees (match/mismatch), while <code>ComparePairs()</code> compares for each pair their relationship between the two pedigrees (e.g. full sibs vs half sibs). Both pedigrees may have genotyped as well as non-genotyped individuals.</p>
<p>Most of the terminology in this vignette and the helpfiles is based on <code>Ped1</code> being the ‘true’ pedigree (the one from which data is simulated) and <code>Ped2</code> is the inferred pedigree (from the simulated data), but both functions work for any two pedigrees. From version 2.0 onwards you can indicate in <code>PedCompare()</code> that both pedigrees may be imperfect (<code>Symmetrical = TRUE</code>).</p>
<div id="dummy-matching" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Dummy matching</h3>
<p>Comparing two pedigrees becomes complicated when dummy IDs are involved – When are non-identical parental IDs between the two pedigrees actually referring to the same individual? For example, in Table <a href="output-check.html#tab:PedComp-ex1">6.1</a> the mother of Blossom and Bob is Beta in Pedigree1, and dummy female F0007 in Pedigree 2. It seems fair to assume that F0007 thus refers to the non-genotyped female Beta. And since Alpha was assigned as maternal grandmother to Blossom and Bob, we can also conclude that Alpha must be the mother of Beta!</p>
<table class="kable_wrapper">
<caption>
<span id="tab:PedComp-ex1">Table 6.1: </span>Example comparison between Pedigree1 (left) and Pedigree2 (right)
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">id</th>
<th align="left">dam</th>
<th align="left">sire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alpha</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Beta</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Abigail</td>
<td align="left">Alpha</td>
<td align="left">Zorro</td>
</tr>
<tr class="even">
<td align="left">Aster</td>
<td align="left">Alpha</td>
<td align="left">Yann</td>
</tr>
<tr class="odd">
<td align="left">Blossom</td>
<td align="left">Beta</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Bob</td>
<td align="left">Beta</td>
<td align="left">Zorro</td>
</tr>
<tr class="odd">
<td align="left">-</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="left">id</th>
<th align="left">dam</th>
<th align="left">sire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alpha</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">-</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Abigail</td>
<td align="left">Alpha</td>
<td align="left">Zorro</td>
</tr>
<tr class="even">
<td align="left">Aster</td>
<td align="left">Alpha</td>
<td align="left">M0004</td>
</tr>
<tr class="odd">
<td align="left">Blossom</td>
<td align="left">F0007</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Bob</td>
<td align="left">F0007</td>
<td align="left">Zorro</td>
</tr>
<tr class="odd">
<td align="left">F0007</td>
<td align="left">Alpha</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Matching and replacing dummy IDs this way extends the number of individuals with both pedigree and phenotypic data, which will among others increase power of any downstream quantitative genetic analyses.</p>
<p>More specifically, <code>PedCompare()</code> considers it a ‘match’ if the inferred sibship (in Pedigree2) which contains the most offspring of a non-genotyped parent (in Pedigree1), consists for more than half of this individual’s offspring. If for example a cluster of <span class="math inline">\(5\)</span> siblings in Pedigree1 is split into two clusters in Pedigree2, the larger sibship (of say 3 individuals) is considered a match, and the smaller a mismatch (thus 2 mismatches) — even though it could be argued the inferred Pedigree2 does not contain any incorrect links. For this same example, <code>ComparePairs()</code> would tell that the <span class="math inline">\((5*4)/2=10\)</span> halfsib pairs in Pedigree1 are <span class="math inline">\(3+1\)</span> halfsib pairs in Pedigree2, and <span class="math inline">\(6\)</span> unrelated pairs. <code>ComparePairs()</code> does not attempt any matching of dummy individuals.</p>
</div>
<div id="example" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Example</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="output-check.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data.</span></span>
<span id="cb17-2"><a href="output-check.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(SeqOUT_griffin, FieldMums_griffin, <span class="at">package=</span><span class="st">&quot;sequoia&quot;</span>)</span>
<span id="cb17-3"><a href="output-check.html#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="output-check.html#cb17-4" aria-hidden="true" tabindex="-1"></a>PCG  <span class="ot">&lt;-</span> <span class="fu">PedCompare</span>(<span class="at">Ped1 =</span> <span class="fu">cbind</span>(FieldMums_griffin,</span>
<span id="cb17-5"><a href="output-check.html#cb17-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sire =</span> <span class="cn">NA</span>),</span>
<span id="cb17-6"><a href="output-check.html#cb17-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ped2 =</span> SeqOUT_griffin<span class="sc">$</span>Pedigree,</span>
<span id="cb17-7"><a href="output-check.html#cb17-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">SNPd =</span> SeqOUT_griffin<span class="sc">$</span>PedigreePar<span class="sc">$</span>id,</span>
<span id="cb17-8"><a href="output-check.html#cb17-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Symmetrical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-9"><a href="output-check.html#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="output-check.html#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># pedigrees side-by-side (subset of columns because no field-observed sires here)</span></span>
<span id="cb17-11"><a href="output-check.html#cb17-11" aria-hidden="true" tabindex="-1"></a>PCG<span class="sc">$</span>MergedPed[<span class="dv">127</span><span class="sc">:</span><span class="dv">133</span>, <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;dam.1&quot;</span>, <span class="st">&quot;dam.2&quot;</span>, <span class="st">&quot;dam.r&quot;</span>, <span class="st">&quot;id.dam.cat&quot;</span>, <span class="st">&quot;dam.class&quot;</span>)]</span>
<span id="cb17-12"><a href="output-check.html#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  Non-genotyped field mums have a two-colour code (e.g. &#39;BlueRed&#39;)</span></span>
<span id="cb17-13"><a href="output-check.html#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="output-check.html#cb17-14" aria-hidden="true" tabindex="-1"></a>PCG<span class="sc">$</span>MergedPed[<span class="fu">c</span>(<span class="dv">137</span>,<span class="dv">138</span>, <span class="dv">6</span>, <span class="dv">128</span>,<span class="dv">129</span>,<span class="dv">7</span>), <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;id.r&quot;</span>, <span class="st">&quot;dam.1&quot;</span>, <span class="st">&quot;dam.2&quot;</span>, <span class="st">&quot;dam.r&quot;</span>)]</span>
<span id="cb17-15"><a href="output-check.html#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># column &#39;id&#39;: ids common to both pedigrees, plus those only in Pedigree2 </span></span>
<span id="cb17-16"><a href="output-check.html#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># column &#39;id.r&#39;: &#39;consensus&#39; ids, plus those only occurring in Pedigree1  </span></span>
<span id="cb17-17"><a href="output-check.html#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="output-check.html#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># dummy individuals from Ped2 with their best-matching non-genotyped individual in Ped1</span></span>
<span id="cb17-19"><a href="output-check.html#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PCG<span class="sc">$</span>DummyMatch[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>)])</span>
<span id="cb17-20"><a href="output-check.html#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;nomatch&#39; in the `id.1` column: none of the siblings in Ped2 had a field-observed</span></span>
<span id="cb17-21"><a href="output-check.html#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co"># mother, or there is a mismatch.</span></span>
<span id="cb17-22"><a href="output-check.html#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="output-check.html#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of matches &amp; mismatches:</span></span>
<span id="cb17-24"><a href="output-check.html#cb17-24" aria-hidden="true" tabindex="-1"></a>PCG<span class="sc">$</span>Counts</span>
<span id="cb17-25"><a href="output-check.html#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># dim1: category: genotyped/dummy/total</span></span>
<span id="cb17-26"><a href="output-check.html#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co"># dim2: classification: total (could-have-had-parent)/ match/ mismatch/ </span></span>
<span id="cb17-27"><a href="output-check.html#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co">#       P1only (no parent in Ped2)/ P2only</span></span>
<span id="cb17-28"><a href="output-check.html#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co"># dim3: dam/sire</span></span></code></pre></div>
<p>See <a href="">here</a> for a detailed walk-through of this example, and suggestions on how to trace the underlying cause of discrepancies between the newly-inferred genetic pedigree and an existing field pedigree.</p>
<p>In short, the main aim of checking the discrepancies is to figure out the underlying cause of each case:</p>
<ul>
<li>pedigree reconstruction error,</li>
<li>wet lab error (sample swap/mislabeling), or</li>
<li>field ‘error’ (e.g. mistaken/unknown identity),</li>
</ul>
<p>so that the records and/or pedigree can be corrected. <code>PedCompare()</code> only points you to where the discrepancies are; field records, lab records and common sense are needed to determine the most likely cause (or determine that the cause is unknowable).</p>
<p>Fairly common (but still rare) pedigree reconstruction errors are</p>
<ul>
<li>one sibship is erroneously split into two,</li>
<li>two sibships are erroneously merged into one,</li>
<li>an aunt/uncle is assigned as sibship-grandparent,</li>
<li>the parent-offspring relationship between to dummy individuals, or between two genotyped individuals with unknown birth years, is flipped the wrong way around.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="output-check.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ~~ Mismatches ~~</span></span>
<span id="cb18-2"><a href="output-check.html#cb18-2" aria-hidden="true" tabindex="-1"></a>PCG<span class="sc">$</span>MergedPed[<span class="fu">which</span>(PCG<span class="sc">$</span>MergedPed<span class="sc">$</span>dam.class <span class="sc">==</span> <span class="st">&quot;Mismatch&quot;</span>), </span>
<span id="cb18-3"><a href="output-check.html#cb18-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;dam.1&quot;</span>, <span class="st">&quot;dam.2&quot;</span>, <span class="st">&quot;id.dam.cat&quot;</span>)]</span>
<span id="cb18-4"><a href="output-check.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="output-check.html#cb18-5" aria-hidden="true" tabindex="-1"></a>PedM <span class="ot">&lt;-</span> PCG<span class="sc">$</span>MergedPed[, <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;dam.1&quot;</span>, <span class="st">&quot;dam.2&quot;</span>)]   <span class="co"># short-hand to minimise typing</span></span>
<span id="cb18-6"><a href="output-check.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="output-check.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># who are the mismatching individual&#39;s siblings according to Ped1 &amp; Ped2? </span></span>
<span id="cb18-8"><a href="output-check.html#cb18-8" aria-hidden="true" tabindex="-1"></a>PedM[<span class="fu">which</span>(PedM<span class="sc">$</span>dam<span class="fl">.1</span> <span class="sc">==</span> <span class="st">&quot;GreenBlue&quot;</span>), ]</span>
<span id="cb18-9"><a href="output-check.html#cb18-9" aria-hidden="true" tabindex="-1"></a>PedM[<span class="fu">which</span>(PedM<span class="sc">$</span>dam<span class="fl">.2</span> <span class="sc">==</span> <span class="st">&quot;i081_2005_F&quot;</span>), ]</span>
<span id="cb18-10"><a href="output-check.html#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="output-check.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># who are their maternal grandparents?</span></span>
<span id="cb18-12"><a href="output-check.html#cb18-12" aria-hidden="true" tabindex="-1"></a>PedM[<span class="fu">which</span>(PedM<span class="sc">$</span>id<span class="fl">.1</span> <span class="sc">==</span> <span class="st">&quot;GreenBlue&quot;</span>), ]</span>
<span id="cb18-13"><a href="output-check.html#cb18-13" aria-hidden="true" tabindex="-1"></a>PedM[<span class="fu">which</span>(PedM<span class="sc">$</span>id<span class="fl">.2</span> <span class="sc">==</span> <span class="st">&quot;i081_2005_F&quot;</span>), ]</span></code></pre></div>
</div>
<div id="colony" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Colony</h3>
<p>To compare Colony output with an existing pedigree, use:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="output-check.html#cb19-1" aria-hidden="true" tabindex="-1"></a>BestConfig <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;Colony/file/file.BestConfig&quot;</span>,</span>
<span id="cb19-2"><a href="output-check.html#cb19-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">&quot;&quot;</span>, <span class="at">comment.char=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb19-3"><a href="output-check.html#cb19-3" aria-hidden="true" tabindex="-1"></a>PC <span class="ot">&lt;-</span> <span class="fu">PedCompare</span>(<span class="at">Ped1 =</span> ExistingPedigree,</span>
<span id="cb19-4"><a href="output-check.html#cb19-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Ped2 =</span> BestConfig)</span></code></pre></div>
</div>
</div>
<div id="sec:compR" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Relatedness</h2>
<div id="sec:Rped" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Pedigree relatedness</h3>
<p>Another way to compare two pedigrees is to compare the pedigree-based relatednesses calculated from each. In R, pedigree relatedness can for example be calculated by the R package <code>kinship2</code> – relatedness is defined as twice the kinship coefficient.</p>
<p><code>kinship2</code> requires a pedigree with columns id - dadid - momid - sex, and requires that individuals either have two parents, or zero. The latter can be achieved with <code>sequoia::PedPolish(, FillParents=TRUE)</code>. From <code>sequoia</code> version 2.1, <code>CalcRPed()</code> will reformat the pedigree, call <code>kinship2::kinship()</code>, and return relatedness coefficients as a matrix or dataframe.</p>
<p>The same can be done for a second pedigree, and the two dataframes merged. As the number of pairs <span class="math inline">\(p\)</span> becomes very large even for moderate numbers of individuals <span class="math inline">\(n\)</span> (<span class="math inline">\(p\)</span> = <span class="math inline">\(n \times (n-1)/2\)</span>, so e.g. 2 million pairs for 2 thousand individuals), it is a good idea to use package <code>data.table</code> to assist with merging (merge in seconds vs. many minutes or not at all):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="output-check.html#cb20-1" aria-hidden="true" tabindex="-1"></a>Rped.old <span class="ot">&lt;-</span> <span class="fu">CalcRped</span>(Ped_griffin, <span class="at">OUT=</span><span class="st">&quot;DF&quot;</span>)</span>
<span id="cb20-2"><a href="output-check.html#cb20-2" aria-hidden="true" tabindex="-1"></a>Rped.new <span class="ot">&lt;-</span> <span class="fu">CalcRped</span>(SeqOUT_griffin<span class="sc">$</span>Pedigree, <span class="at">OUT=</span><span class="st">&quot;DF&quot;</span>)</span>
<span id="cb20-3"><a href="output-check.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb20-4"><a href="output-check.html#cb20-4" aria-hidden="true" tabindex="-1"></a>Rped.both <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">data.table</span>(Rped.old, <span class="at">key=</span><span class="fu">c</span>(<span class="st">&quot;IID1&quot;</span>, <span class="st">&quot;IID2&quot;</span>)),</span>
<span id="cb20-5"><a href="output-check.html#cb20-5" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">data.table</span>(Rped.new, <span class="at">key=</span><span class="fu">c</span>(<span class="st">&quot;IID1&quot;</span>, <span class="st">&quot;IID2&quot;</span>)), </span>
<span id="cb20-6"><a href="output-check.html#cb20-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">all=</span><span class="cn">TRUE</span>, <span class="at">suffixes=</span><span class="fu">c</span>(<span class="st">&quot;.old&quot;</span>, <span class="st">&quot;.new&quot;</span>))</span>
<span id="cb20-7"><a href="output-check.html#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="output-check.html#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Rped.both<span class="sc">$</span>R.ped.new, Rped.both<span class="sc">$</span>R.ped.old, <span class="at">use=</span><span class="st">&quot;pairwise.complete&quot;</span>)</span>
<span id="cb20-9"><a href="output-check.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Rped.both<span class="sc">$</span>R.ped.old, Rped.both<span class="sc">$</span>R.ped.new, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">0.3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="output-check.html#cb21-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;figs/Rped_scatter.png&quot;</span>)</span></code></pre></div>
<p><img src="figs/Rped_scatter.png" width="60%" /></p>
</div>
<div id="genomic-relatedness" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Genomic relatedness</h3>
<p>In absence of a previous pedigree, or when it is not obvious whether the previous or newly inferred pedigree is correct, one could compare the pairwise relatedness estimated from the pedigree(s) to a measure of genomic relatedness, estimated directly from the complete SNP data – which may be many more SNPs than used for pedigree reconstruction. Genomic relatedness can be estimated for example using <a href="http://cnsgenomics.com/software/gcta/#MakingaGRM">GCTA</a>. Genomic relatedness will vary around the pedigree-based relatedness even for a perfect pedigree due to Mendelian variance, but outliers suggest pedigree errors.</p>
<p>For example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="output-check.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in output from GCTA</span></span>
<span id="cb22-2"><a href="output-check.html#cb22-2" aria-hidden="true" tabindex="-1"></a>Rel.snp <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;GT.grm.gz&quot;</span>)   </span>
<span id="cb22-3"><a href="output-check.html#cb22-3" aria-hidden="true" tabindex="-1"></a>Rel.id <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;GT.grm.id&quot;</span>, <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>)</span>
<span id="cb22-4"><a href="output-check.html#cb22-4" aria-hidden="true" tabindex="-1"></a>Rel.snp[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">factor</span>(Rel.snp[,<span class="dv">1</span>], <span class="at">labels=</span>Rel.id[,<span class="dv">2</span>]))</span>
<span id="cb22-5"><a href="output-check.html#cb22-5" aria-hidden="true" tabindex="-1"></a>Rel.snp[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">factor</span>(Rel.snp[,<span class="dv">2</span>], <span class="at">labels=</span>Rel.id[,<span class="dv">2</span>]))</span>
<span id="cb22-6"><a href="output-check.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Rel.snp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IID1&quot;</span>, <span class="st">&quot;IID2&quot;</span>, <span class="st">&quot;nSNPS&quot;</span>, <span class="st">&quot;R.GRM&quot;</span>)</span>
<span id="cb22-7"><a href="output-check.html#cb22-7" aria-hidden="true" tabindex="-1"></a>Rel.snp <span class="ot">&lt;-</span> Rel.snp[Rel.snp<span class="sc">$</span>IID1 <span class="sc">!=</span> Rel.snp<span class="sc">$</span>IID2,]  <span class="co"># between-indiv only</span></span>
<span id="cb22-8"><a href="output-check.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-9"><a href="output-check.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># combine with pedigree relatedness</span></span>
<span id="cb22-10"><a href="output-check.html#cb22-10" aria-hidden="true" tabindex="-1"></a>Rel.both <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="fu">data.table</span>(Rel.snp[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)], <span class="at">key=</span><span class="fu">c</span>(<span class="st">&quot;IID1&quot;</span>, <span class="st">&quot;IID2&quot;</span>)),</span>
<span id="cb22-11"><a href="output-check.html#cb22-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">data.table</span>(Rped.both, <span class="at">key=</span><span class="fu">c</span>(<span class="st">&quot;IID1&quot;</span>, <span class="st">&quot;IID2&quot;</span>)), <span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb22-12"><a href="output-check.html#cb22-12" aria-hidden="true" tabindex="-1"></a>Rel.both <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Rel.both)  <span class="co"># turn back into regular dataframe</span></span>
<span id="cb22-13"><a href="output-check.html#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(Rel.snp, Rped.both, Rped.new, Rped.old)   <span class="co"># clean up: remove large dataframes</span></span>
<span id="cb22-14"><a href="output-check.html#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-15"><a href="output-check.html#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(Rel.both[, <span class="fu">c</span>(<span class="st">&quot;R.GRM&quot;</span>,<span class="st">&quot;R.ped.new&quot;</span>, <span class="st">&quot;R.ped.old&quot;</span>)], </span>
<span id="cb22-16"><a href="output-check.html#cb22-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">use=</span><span class="st">&quot;pairwise.complete&quot;</span>), <span class="dv">3</span>)</span>
<span id="cb22-17"><a href="output-check.html#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-18"><a href="output-check.html#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot doesn&#39;t work well with many thousand points</span></span>
<span id="cb22-19"><a href="output-check.html#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># &gt;&gt; use heatmap-like alternative, e.g. hexbinplot</span></span>
<span id="cb22-20"><a href="output-check.html#cb22-20" aria-hidden="true" tabindex="-1"></a>hexbin<span class="sc">::</span><span class="fu">hexbinplot</span>(Rel.both<span class="sc">$</span>R.GRM <span class="sc">~</span> Rel.both<span class="sc">$</span>R.ped.new, </span>
<span id="cb22-21"><a href="output-check.html#cb22-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xbins=</span><span class="dv">100</span>, <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb22-22"><a href="output-check.html#cb22-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>,.<span class="dv">9</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">2</span>, .<span class="dv">9</span>),</span>
<span id="cb22-23"><a href="output-check.html#cb22-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab=</span><span class="st">&quot;Pedigree relatedness&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Genomic relatedness&quot;</span>,</span>
<span id="cb22-24"><a href="output-check.html#cb22-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trans=</span>log10, <span class="at">inv=</span><span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x, </span>
<span id="cb22-25"><a href="output-check.html#cb22-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colorcut=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">14</span>), <span class="at">maxcnt=</span><span class="dv">10</span><span class="sc">^</span><span class="fl">6.5</span>,</span>
<span id="cb22-26"><a href="output-check.html#cb22-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colramp =</span> <span class="cf">function</span>(n) {grDevices<span class="sc">::</span><span class="fu">hcl.colors</span>(n, <span class="at">palette=</span><span class="st">&#39;Berlin&#39;</span>)})</span>
<span id="cb22-27"><a href="output-check.html#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-28"><a href="output-check.html#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># if you want to add e.g. a diagonal line to that plot:</span></span>
<span id="cb22-29"><a href="output-check.html#cb22-29" aria-hidden="true" tabindex="-1"></a>hb <span class="ot">&lt;-</span> hexbin<span class="sc">::</span><span class="fu">hexbin</span>(Rel.both<span class="sc">$</span>R.GRM <span class="sc">~</span> Rel.both<span class="sc">$</span>R.ped.new, </span>
<span id="cb22-30"><a href="output-check.html#cb22-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xbins=</span><span class="dv">100</span>, <span class="at">xbnds=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">05</span>, .<span class="dv">9</span>), <span class="at">ybnds=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">2</span>, .<span class="dv">9</span>),</span>
<span id="cb22-31"><a href="output-check.html#cb22-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="st">&quot;Pedigree relatedness&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Genomic relatedness&quot;</span>)</span>
<span id="cb22-32"><a href="output-check.html#cb22-32" aria-hidden="true" tabindex="-1"></a>hbp <span class="ot">&lt;-</span> hexbin<span class="sc">::</span><span class="fu">plot</span>(hb,</span>
<span id="cb22-33"><a href="output-check.html#cb22-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">trans=</span>log10, <span class="at">inv=</span><span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x,</span>
<span id="cb22-34"><a href="output-check.html#cb22-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colorcut=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">14</span>), <span class="at">maxcnt=</span><span class="dv">10</span><span class="sc">^</span><span class="fl">6.5</span>,</span>
<span id="cb22-35"><a href="output-check.html#cb22-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colramp =</span> <span class="cf">function</span>(n) {grDevices<span class="sc">::</span><span class="fu">hcl.colors</span>(n, <span class="at">palette=</span><span class="st">&#39;Berlin&#39;</span>)}</span>
<span id="cb22-36"><a href="output-check.html#cb22-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-37"><a href="output-check.html#cb22-37" aria-hidden="true" tabindex="-1"></a>hexbin<span class="sc">::</span><span class="fu">hexVP.abline</span>(hbp<span class="sc">$</span>plot.vp, <span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="output-check.html#cb23-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;figs/hexbin.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-18"></span>
<img src="figs/hexbin.png" alt="Relatedness hexbinplot example" width="80%" />
<p class="caption">
Figure 6.4: Relatedness hexbinplot example
</p>
</div>
</div>
</div>
<div id="cluster-families" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Cluster families</h2>
<p>Certain analyses, such as the Mendelian error check in PLINK, are done on a family-by-family basis. <code>FindFamilies()</code> takes a pedigree as input and clusters the individuals in as few families as possible, by repeatedly searching all ancestors and all descendants of each individual and ensuring those all have the same family ID.</p>
<p>This function does not take separate FID and IID columns in the input pedigree, rather these need to be joined together before running <code>FindFamilies()</code> (e.g. with <code>paste()</code>), and then split afterwards using <code>PedStripFID()</code>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="running-sequoia.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hermaphrodites.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
