<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Pedigree-based ageprior | Sequoia - Age ‘Prior’</title>
  <meta name="description" content="5 Pedigree-based ageprior | Sequoia - Age ‘Prior’" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Pedigree-based ageprior | Sequoia - Age ‘Prior’" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/../../sequoia_logo.png" />
  
  <meta name="github-repo" content="JiscaH/sequoia" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Pedigree-based ageprior | Sequoia - Age ‘Prior’" />
  
  
  <meta name="twitter:image" content="/../../sequoia_logo.png" />

<meta name="author" content="Jisca Huisman" />


<meta name="date" content="2021-02-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png" />
  <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
<link rel="prev" href="sec-Default.html"/>
<link rel="next" href="sec-smallCorr.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./../../../index.html"><img src="../../home-solid-silver.svg" height="40" alt="home"/></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> In short</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#age-info-is-useful"><i class="fa fa-check"></i><b>1.1</b> Age Info is Useful</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#implementation"><i class="fa fa-check"></i><b>1.2</b> Implementation</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#passing-the-threshold"><i class="fa fa-check"></i><b>1.2.1</b> Passing the threshold</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#time-units"><i class="fa fa-check"></i><b>1.3</b> Time units</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#runtime-messages"><i class="fa fa-check"></i><b>1.4</b> Runtime Messages</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#changing-the-ageprior"><i class="fa fa-check"></i><b>1.5</b> Changing the ageprior</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="maths.html"><a href="maths.html"><i class="fa fa-check"></i><b>2</b> Maths</a>
<ul>
<li class="chapter" data-level="2.1" data-path="maths.html"><a href="maths.html#ageprior"><i class="fa fa-check"></i><b>2.1</b> AgePrior</a></li>
<li class="chapter" data-level="2.2" data-path="maths.html"><a href="maths.html#sec:unsampled"><i class="fa fa-check"></i><b>2.2</b> Unsampled individuals</a></li>
<li class="chapter" data-level="2.3" data-path="maths.html"><a href="maths.html#genetics-times-age"><i class="fa fa-check"></i><b>2.3</b> Genetics <span class="math inline">\(\times\)</span> Age</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ageprior-matrix-explained.html"><a href="ageprior-matrix-explained.html"><i class="fa fa-check"></i><b>3</b> AgePrior matrix explained</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ageprior-matrix-explained.html"><a href="ageprior-matrix-explained.html#agepriorextra"><i class="fa fa-check"></i><b>3.1</b> <code>AgePriorExtra</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sec-Default.html"><a href="sec-Default.html"><i class="fa fa-check"></i><b>4</b> Default ageprior</a></li>
<li class="chapter" data-level="5" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html"><i class="fa fa-check"></i><b>5</b> Pedigree-based ageprior</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#sec:Discrete"><i class="fa fa-check"></i><b>5.1</b> Discrete generations</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#generation-interval-different-from-1"><i class="fa fa-check"></i><b>5.1.1</b> Generation interval different from 1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#sec:overlap"><i class="fa fa-check"></i><b>5.2</b> Overlapping generations</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#birthyearrange"><i class="fa fa-check"></i><b>5.2.1</b> <code>BirthYearRange</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#sec:MaxAgePO"><i class="fa fa-check"></i><b>5.2.2</b> <code>MaxAgeParent</code></a></li>
<li class="chapter" data-level="5.2.3" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#sec:tblAR"><i class="fa fa-check"></i><b>5.2.3</b> Counts: <code>tblA.R</code></a></li>
<li class="chapter" data-level="5.2.4" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#par-pa.r"><i class="fa fa-check"></i><b>5.2.4</b> P(A|R): <code>PA.R</code></a></li>
<li class="chapter" data-level="5.2.5" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#sec:FSuseHS"><i class="fa fa-check"></i><b>5.2.5</b> Full sibling correction</a></li>
<li class="chapter" data-level="5.2.6" data-path="pedigree-based-ageprior.html"><a href="pedigree-based-ageprior.html#sec:standardise"><i class="fa fa-check"></i><b>5.2.6</b> Ageprior P(A|R)/P(A): <code>LR.RU.A.raw</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sec-smallCorr.html"><a href="sec-smallCorr.html"><i class="fa fa-check"></i><b>6</b> Small sample correction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-smallCorr.html"><a href="sec-smallCorr.html#the-problem"><i class="fa fa-check"></i><b>6.1</b> The problem</a></li>
<li class="chapter" data-level="6.2" data-path="sec-smallCorr.html"><a href="sec-smallCorr.html#sec:Smooth"><i class="fa fa-check"></i><b>6.2</b> Smooth</a></li>
<li class="chapter" data-level="6.3" data-path="sec-smallCorr.html"><a href="sec-smallCorr.html#sec:Flatten"><i class="fa fa-check"></i><b>6.3</b> Flatten</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sec-smallCorr.html"><a href="sec-smallCorr.html#weighing-factor-lambdanw"><i class="fa fa-check"></i><b>6.3.1</b> Weighing factor &amp; <code>lambdaNW</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="sec-smallCorr.html"><a href="sec-smallCorr.html#sample-size-vs.-sampling-probability"><i class="fa fa-check"></i><b>6.3.2</b> Sample size vs. sampling probability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-GP-AU.html"><a href="sec-GP-AU.html"><i class="fa fa-check"></i><b>7</b> Grandparents &amp; Avuncular</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-GP-AU.html"><a href="sec-GP-AU.html#maths-1"><i class="fa fa-check"></i><b>7.1</b> Maths</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sec-GP-AU.html"><a href="sec-GP-AU.html#ageprior-to-probability-to-ageprior"><i class="fa fa-check"></i><b>7.1.1</b> Ageprior to Probability to Ageprior</a></li>
<li class="chapter" data-level="7.1.2" data-path="sec-GP-AU.html"><a href="sec-GP-AU.html#change-from-v1.3-to-v2.0"><i class="fa fa-check"></i><b>7.1.2</b> change from v1.3 to v2.0</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-customAP.html"><a href="sec-customAP.html"><i class="fa fa-check"></i><b>8</b> Customise</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-customAP.html"><a href="sec-customAP.html#via-args.ap"><i class="fa fa-check"></i><b>8.1</b> Via <code>args.AP</code></a></li>
<li class="chapter" data-level="8.2" data-path="sec-customAP.html"><a href="sec-customAP.html#different-input-pedigree"><i class="fa fa-check"></i><b>8.2</b> Different input pedigree</a></li>
<li class="chapter" data-level="8.3" data-path="sec-customAP.html"><a href="sec-customAP.html#other-tweaks"><i class="fa fa-check"></i><b>8.3</b> Other tweaks</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="sec-customAP.html"><a href="sec-customAP.html#age-at-first-reproduction"><i class="fa fa-check"></i><b>8.3.1</b> Age at first reproduction</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sec-customAP.html"><a href="sec-customAP.html#from-age-difference-distribution"><i class="fa fa-check"></i><b>8.4</b> From age-difference distribution</a></li>
<li class="chapter" data-level="8.5" data-path="sec-customAP.html"><a href="sec-customAP.html#specifications"><i class="fa fa-check"></i><b>8.5</b> Specifications</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="./../../vignette_main/book/sec-Background.html">Main Vignette</a></li>
<li><a href="./../../index.html">Other Manuals</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sequoia - Age ‘Prior’</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pedigree-based-ageprior" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Pedigree-based ageprior</h1>
<hr />
<div id="sec:Discrete" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Discrete generations</h2>
<p>When a pedigree is provided as input, <code>MakeAgePrior()</code> always checks whether generations are non-overlapping, i.e. whether all parents have the same the same age (typically 1), and all siblings have an age difference of 0. If these conditions are met, and there are at least 20 pairs each of mother-offspring, father-offspring, maternal half/full siblings, and paternal half/full siblings, it is concluded that generations are discrete. This auto-detection can be turned off by explicitly declaring <code>Discrete=TRUE</code> or <code>Discrete=FALSE</code>. If <code>Discrete=TRUE</code> is declared, a check is still performed, and any violations result in an error. When discrete generations are automatically inferred or explicitly declared, small-sample corrections <code>Smooth</code> and <code>Flatten</code> are always set to <code>FALSE</code>.</p>
<p>When <code>Discrete = TRUE</code> is specified prior to parentage assignment, being full siblings is no longer considered as a potential relationship alternative for candidate parents (age difference of 1), but being an aunt/uncle is (Figure <a href="pedigree-based-ageprior.html#fig:APdiscrete">5.1</a>). When the genetic information is ambiguous (few SNPs and/or high genotyping error rate) this may increase the assignment rate, but it may also increase the number of incorrect assignments.</p>
<p>Similarly, during full pedigree reconstruction, pairs with an age difference of 0 are considered potentially full siblings, half siblings, cousins (not shown in ageprior plot), or unrelated. In contrast, with overlapping generations they are (typically) also considered as potential full avuncular pairs, which are often difficult to distinguish from half-sibling pairs.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="pedigree-based-ageprior.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># running sequoia to also get the extra ageprior columns: </span></span>
<span id="cb12-2"><a href="pedigree-based-ageprior.html#cb12-2" aria-hidden="true" tabindex="-1"></a>Seq_HSg5 <span class="ot">&lt;-</span> <span class="fu">sequoia</span>(SimGeno_example, LH_HSg5, <span class="at">Module=</span><span class="st">&quot;par&quot;</span>,</span>
<span id="cb12-3"><a href="pedigree-based-ageprior.html#cb12-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">args.AP=</span><span class="fu">list</span>(<span class="at">Discrete =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-4"><a href="pedigree-based-ageprior.html#cb12-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">CalcLLR=</span><span class="cn">FALSE</span>, <span class="at">Plot=</span><span class="cn">FALSE</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-5"><a href="pedigree-based-ageprior.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotAgePrior</span>(Seq_HSg5<span class="sc">$</span>AgePriorExtra) </span></code></pre></div>
<div class="figure"><span id="fig:APdiscrete"></span>
<img src="figs/APDiscrete-1.png" alt="Discrete generations" width="576" />
<p class="caption">
Figure 5.1: Discrete generations
</p>
</div>
<div id="generation-interval-different-from-1" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Generation interval different from 1</h3>
<p>When generations do not overlap, it is often most straightforward to use generation number instead of birth year, such that parents and offspring are born 1 time unit apart. This is assumed to be the case when <code>Discrete=TRUE</code> is specified, but can be altered via <code>MaxAgeParent</code> (which in this situation is the <em>only</em> allowed age for parents). For example, pink salmon have a strict two-year life-cycle with odd-year and even-year populations:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="pedigree-based-ageprior.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">MakeAgePrior</span>(<span class="at">Discrete =</span> <span class="cn">TRUE</span>, <span class="at">MaxAgeParent =</span> <span class="dv">2</span>, <span class="at">Plot=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Ageprior: Flat 0/1, discrete generations, MaxAgeParent = 2,2</code></pre>
<pre><code>##   M P FS MS PS
## 0 0 0  1  1  1
## 1 0 0  0  0  0
## 2 1 1  0  0  0
## 3 0 0  0  0  0</code></pre>
</div>
</div>
<div id="sec:overlap" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Overlapping generations</h2>
<p>Estimation of the agepriors from a pedigree and birth years normally requires little to no user input, but it can be useful to understand what goes on ‘under the hood’ in case you wish to customise the ageprior, when things go wrong, or just out of curiosity.</p>
<p>The process is here illustrated using an imaginary population of griffins, were each year exactly 20 baby griffins hatch. From 2001 to 2010, all juveniles are sampled, and parents assigned.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="pedigree-based-ageprior.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(Ped_griffin)      <span class="co"># the pedigree</span></span></code></pre></div>
<pre><code>##              id         dam        sire birthyear
## 195 i195_2010_M i157_2008_F i163_2009_M      2010
## 196 i196_2010_M i148_2008_F i127_2007_M      2010
## 197 i197_2010_F i170_2009_F i127_2007_M      2010
## 198 i198_2010_M i166_2009_F i178_2009_M      2010
## 199 i199_2010_F i165_2009_F i141_2008_M      2010
## 200 i200_2010_F i166_2009_F i142_2008_M      2010</code></pre>
<p>We can calculate the ageprior matrix, and also return all the intermediate steps by specifying <code>Return='all'</code> (we come back to <code>Smooth</code> and <code>Flatten</code> <a href="sec-smallCorr.html#sec:smallCorr">later</a>):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="pedigree-based-ageprior.html#cb18-1" aria-hidden="true" tabindex="-1"></a>AP.griffin <span class="ot">&lt;-</span> <span class="fu">MakeAgePrior</span>(Ped_griffin, <span class="at">Smooth=</span><span class="cn">FALSE</span>, <span class="at">Flatten=</span><span class="cn">FALSE</span>, </span>
<span id="cb18-2"><a href="pedigree-based-ageprior.html#cb18-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Return=</span><span class="st">&quot;all&quot;</span>)   </span></code></pre></div>
<pre><code>## Ageprior: Pedigree-based, overlapping generations, MaxAgeParent = 3,3</code></pre>
<div class="figure"><span id="fig:APall"></span>
<img src="figs/APall-1.png" alt="Ageprior for overlapping generations (griffin example)" width="70%" />
<p class="caption">
Figure 5.2: Ageprior for overlapping generations (griffin example)
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="pedigree-based-ageprior.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(AP.griffin)</span></code></pre></div>
<pre><code>## [1] &quot;BirthYearRange&quot; &quot;MaxAgeParent&quot;   &quot;tblA.R&quot;         &quot;PA.R&quot;          
## [5] &quot;LR.RU.A.raw&quot;    &quot;Weights&quot;        &quot;LR.RU.A&quot;        &quot;Specs.AP&quot;</code></pre>
<!--- We see in the plot that both dams and sires have a maximum age of 3 years, and that for dams (M: Maternal) age 1 is most common (darkest green), while for sires (P:Paternal) age 2 is most common.  --->
<p>The order of elements in the output list is also the order in which they are calculated inside <code>MakeAgePrior()</code>.</p>
<div id="birthyearrange" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> <code>BirthYearRange</code></h3>
<p><code>BirthYearRange</code> is the minimum and maximum birth year in <code>LifeHistData</code> (or in the <code>birthyear</code> column in the pedigree). This determines the maximum age difference between pairs of (sampled) individuals.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="pedigree-based-ageprior.html#cb22-1" aria-hidden="true" tabindex="-1"></a>AP.griffin<span class="sc">$</span>BirthYearRange</span></code></pre></div>
<pre><code>## [1] 2001 2010</code></pre>
</div>
<div id="sec:MaxAgePO" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> <code>MaxAgeParent</code></h3>
<p>The maximum age of female and male parents, <code>MaxAgeParent</code>, is initially set equal to the maximum age difference between any kind of pairs (<code>diff(BirthYearRange)</code>) <span class="math inline">\(+1\)</span> (see <a href="sec-Default.html#sec:Default">Default Ageprior</a>), when not explicitly specified as input. If the pedigree includes at least 20 mother-offspring and/or father-offspring pairs with known age difference, the maximum parental age for that sex is updated to the maximum of the user-specified and pedigree-calculated values.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="pedigree-based-ageprior.html#cb24-1" aria-hidden="true" tabindex="-1"></a>AP.griffin<span class="sc">$</span>MaxAgeParent</span></code></pre></div>
<pre><code>## M P 
## 3 3</code></pre>
<p>For example, if you know that males can live and breed to age 5, but you have only sampled males up to age 3, you can and should adjust the age prior – this will namely also affect the maximum age difference between paternal siblings during the full pedigree reconstruction. This adjustment works via <a href="sec-smallCorr.html#sec:Flatten"><code>Flatten</code></a>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="pedigree-based-ageprior.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify maximum age for fathers, but estimate max mother age from pedigree </span></span>
<span id="cb26-2"><a href="pedigree-based-ageprior.html#cb26-2" aria-hidden="true" tabindex="-1"></a>APX <span class="ot">&lt;-</span> <span class="fu">MakeAgePrior</span>(Ped_griffin, <span class="at">Smooth=</span><span class="cn">FALSE</span>, <span class="at">MaxAgeParent =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">5</span>))</span></code></pre></div>
<pre><code>## Ageprior: Pedigree-based, overlapping generations, flattened, MaxAgeParent = 3,5</code></pre>
<p><img src="figs/IncrMAP-1.png" width="70%" /></p>
</div>
<div id="sec:tblAR" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Counts: <code>tblA.R</code></h3>
<p>The list element <code>tblA.R</code> contains the raw counts of each age difference <span class="math inline">\(A\)</span> per relationship <span class="math inline">\(R\)</span>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="pedigree-based-ageprior.html#cb28-1" aria-hidden="true" tabindex="-1"></a>AP.griffin[[<span class="st">&quot;tblA.R&quot;</span>]]</span></code></pre></div>
<pre><code>##      M  P FS  MS PS    X
## 0    0  0  3  89 59 1900
## 1  105 58  2 103 86 3600
## 2   54 83  0  24 15 3200
## 3    8 22  0   0  0 2800
## 4    0  0  0   0  0 2400
## 5    0  0  0   0  0 2000
## 6    0  0  0   0  0 1600
## 7    0  0  0   0  0 1200
## 8    0  0  0   0  0  800
## 9    0  0  0   0  0  400
## 10   0  0  0   0  0    0
## 11   0  0  0   0  0    0</code></pre>
<p>For this table, the relationship between each pair of individuals according to the pedigree is obtained with <code>GetRelM()</code>, and a matrix with the age differences between all pairs is calculated using <code>outer()</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="pedigree-based-ageprior.html#cb30-1" aria-hidden="true" tabindex="-1"></a>AgeDifM <span class="ot">&lt;-</span> <span class="fu">outer</span>(Ped_griffin<span class="sc">$</span>birthyear, Ped_griffin<span class="sc">$</span>birthyear, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb30-2"><a href="pedigree-based-ageprior.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># closest relationship for each pair:</span></span>
<span id="cb30-3"><a href="pedigree-based-ageprior.html#cb30-3" aria-hidden="true" tabindex="-1"></a>RelM <span class="ot">&lt;-</span> <span class="fu">GetRelM</span>(Ped_griffin, <span class="at">patmat=</span><span class="cn">TRUE</span>, <span class="at">GenBack=</span><span class="dv">1</span>)</span>
<span id="cb30-4"><a href="pedigree-based-ageprior.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">c</span>(AgeDifM), <span class="fu">c</span>(RelM))  <span class="co"># vectorising first speeds up table() a lot</span></span></code></pre></div>
<pre><code>##     
##        FS    M  MHS    O    P  PHS    S    U
##   -9    0    0    0    0    0    0    0  400
##   -8    0    0    0    0    0    0    0  800
##   -7    0    0    0    0    0    0    0 1200
##   -6    0    0    0    0    0    0    0 1600
##   -5    0    0    0    0    0    0    0 2000
##   -4    0    0    0    0    0    0    0 2400
##   -3    0    0    0   30    0    0    0 2770
##   -2    0    0   24  137    0   15    0 3024
##   -1    2    0  101  163    0   83    0 3251
##   0     6    0  172    0    0  112  200 3510
##   1     2  105  101    0   58   83    0 3251
##   2     0   54   24    0   83   15    0 3024
##   3     0    8    0    0   22    0    0 2770
##   4     0    0    0    0    0    0    0 2400
##   5     0    0    0    0    0    0    0 2000
##   6     0    0    0    0    0    0    0 1600
##   7     0    0    0    0    0    0    0 1200
##   8     0    0    0    0    0    0    0  800
##   9     0    0    0    0    0    0    0  400</code></pre>
<p>Some ‘polishing’ of this table is required, as each pair of individuals is included twice:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="pedigree-based-ageprior.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - &#39;MaxT&#39; ensures sufficient, constant number of rows across intermediary tables</span></span>
<span id="cb32-2"><a href="pedigree-based-ageprior.html#cb32-2" aria-hidden="true" tabindex="-1"></a>MaxAgeParent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb32-3"><a href="pedigree-based-ageprior.html#cb32-3" aria-hidden="true" tabindex="-1"></a>MaxAgePO <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(MaxAgeParent), MaxAgeParent, <span class="fu">diff</span>(AP.griffin<span class="sc">$</span>BirthYearRange)<span class="sc">+</span><span class="dv">1</span>)  <span class="co"># in actual code with thorough input checks</span></span>
<span id="cb32-4"><a href="pedigree-based-ageprior.html#cb32-4" aria-hidden="true" tabindex="-1"></a>MaxT <span class="ot">&lt;-</span> <span class="fu">max</span>(MaxAgePO<span class="sc">+</span><span class="dv">1</span>, <span class="fu">diff</span>(AP.griffin<span class="sc">$</span>BirthYearRange))</span>
<span id="cb32-5"><a href="pedigree-based-ageprior.html#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="pedigree-based-ageprior.html#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - factor() ensures levels with 0 count are included</span></span>
<span id="cb32-7"><a href="pedigree-based-ageprior.html#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - drop negative age differences: all pairs are included 2x</span></span>
<span id="cb32-8"><a href="pedigree-based-ageprior.html#cb32-8" aria-hidden="true" tabindex="-1"></a>tblA.R <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">factor</span>(AgeDifM, <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span>MaxT),</span>
<span id="cb32-9"><a href="pedigree-based-ageprior.html#cb32-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">factor</span>(RelM, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;FS&quot;</span>, <span class="st">&quot;MHS&quot;</span>, <span class="st">&quot;PHS&quot;</span>)))</span></code></pre></div>
<p>And a further improvement by using every relationship for each pair, rather than only their closest relationship (a pair may e.g. be both mother-offspring &amp; paternal half-siblings):</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="pedigree-based-ageprior.html#cb33-1" aria-hidden="true" tabindex="-1"></a>RelA <span class="ot">&lt;-</span> <span class="fu">GetRelM</span>(Ped_griffin, <span class="at">patmat=</span><span class="cn">TRUE</span>, <span class="at">GenBack=</span><span class="dv">1</span>, <span class="at">Return=</span><span class="st">&quot;Array&quot;</span>)</span>
<span id="cb33-2"><a href="pedigree-based-ageprior.html#cb33-2" aria-hidden="true" tabindex="-1"></a>tblA.R <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;FS&quot;</span>, <span class="st">&quot;MHS&quot;</span>, <span class="st">&quot;PHS&quot;</span>),</span>
<span id="cb33-3"><a href="pedigree-based-ageprior.html#cb33-3" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(r) <span class="fu">table</span>(<span class="fu">factor</span>(AgeDifM[RelA[,,r]<span class="sc">==</span><span class="dv">1</span>], </span>
<span id="cb33-4"><a href="pedigree-based-ageprior.html#cb33-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span>MaxT)))</span>
<span id="cb33-5"><a href="pedigree-based-ageprior.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tblA.R)</span></code></pre></div>
<pre><code>##     M  P FS MHS PHS
## 0   0  0  6 172 112
## 1 105 58  2 101  84
## 2  54 83  0  24  15
## 3   8 22  0   0   0
## 4   0  0  0   0   0
## 5   0  0  0   0   0</code></pre>
<p>The ageprior is for ‘maternal siblings,’ which includes both maternal half-siblings and full siblings, and similarly for paternal siblings. Lastly, a column with the total count of pairs per age difference is added (i.e. the denominator in the calculation of <span class="math inline">\(\alpha_{A,R}\)</span>. For this reference age-difference distribution all individuals in the pedigree with known birth year in <code>LifeHistData</code> are used.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="pedigree-based-ageprior.html#cb35-1" aria-hidden="true" tabindex="-1"></a>tblA.R <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tblA.R,</span>
<span id="cb35-2"><a href="pedigree-based-ageprior.html#cb35-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;MS&quot;</span> <span class="ot">=</span> tblA.R[,<span class="st">&quot;MHS&quot;</span>] <span class="sc">+</span> tblA.R[,<span class="st">&quot;FS&quot;</span>],</span>
<span id="cb35-3"><a href="pedigree-based-ageprior.html#cb35-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;PS&quot;</span> <span class="ot">=</span> tblA.R[,<span class="st">&quot;PHS&quot;</span>] <span class="sc">+</span> tblA.R[,<span class="st">&quot;FS&quot;</span>])</span>
<span id="cb35-4"><a href="pedigree-based-ageprior.html#cb35-4" aria-hidden="true" tabindex="-1"></a>tblA.R <span class="ot">&lt;-</span> tblA.R[, <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;FS&quot;</span>, <span class="st">&quot;MS&quot;</span>, <span class="st">&quot;PS&quot;</span>)]  <span class="co"># drop MHS &amp; PHS columns</span></span>
<span id="cb35-5"><a href="pedigree-based-ageprior.html#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="pedigree-based-ageprior.html#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="pedigree-based-ageprior.html#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># add column for age diff. across all relationships (except &#39;Self&#39; pairs)</span></span>
<span id="cb35-8"><a href="pedigree-based-ageprior.html#cb35-8" aria-hidden="true" tabindex="-1"></a>tblA.R <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tblA.R,</span>
<span id="cb35-9"><a href="pedigree-based-ageprior.html#cb35-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;X&quot;</span> <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">factor</span>(AgeDifM[<span class="fu">c</span>(RelM)<span class="sc">!=</span><span class="st">&quot;S&quot;</span>], <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span>MaxT))) </span>
<span id="cb35-10"><a href="pedigree-based-ageprior.html#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="pedigree-based-ageprior.html#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># All pairs are included 2x in AgeDifM/RelM/RelA, to fix this:</span></span>
<span id="cb35-12"><a href="pedigree-based-ageprior.html#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co"># - drop the negative age differences  (done with factor() above)</span></span>
<span id="cb35-13"><a href="pedigree-based-ageprior.html#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># - divide counts for row A=0 by 2  (including &#39;X&#39; column)</span></span>
<span id="cb35-14"><a href="pedigree-based-ageprior.html#cb35-14" aria-hidden="true" tabindex="-1"></a>tblA.R[<span class="st">&quot;0&quot;</span>, ] <span class="ot">&lt;-</span> tblA.R[<span class="st">&quot;0&quot;</span>, ] <span class="sc">/</span> <span class="dv">2</span>  </span>
<span id="cb35-15"><a href="pedigree-based-ageprior.html#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="pedigree-based-ageprior.html#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># check that this is really the output from MakeAgePrior():</span></span>
<span id="cb35-17"><a href="pedigree-based-ageprior.html#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(tblA.R <span class="sc">==</span> AP.griffin[[<span class="st">&quot;tblA.R&quot;</span>]])</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="par-pa.r" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> P(A|R): <code>PA.R</code></h3>
<p>The probability of age difference <span class="math inline">\(A\)</span> conditional on relationship <span class="math inline">\(R\)</span> is estimated as the proportion of pairs with relationship <span class="math inline">\(R\)</span> and known age difference, that have age difference <span class="math inline">\(A\)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="pedigree-based-ageprior.html#cb37-1" aria-hidden="true" tabindex="-1"></a>NAK.R <span class="ot">&lt;-</span> <span class="fu">colSums</span>(tblA.R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)  <span class="co"># total count per relationship</span></span>
<span id="cb37-2"><a href="pedigree-based-ageprior.html#cb37-2" aria-hidden="true" tabindex="-1"></a>NAK.R</span></code></pre></div>
<pre><code>##     M     P    FS    MS    PS     X 
##   167   163     5   216   160 19900</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="pedigree-based-ageprior.html#cb39-1" aria-hidden="true" tabindex="-1"></a>PA.R <span class="ot">&lt;-</span> <span class="fu">sweep</span>(tblA.R, <span class="dv">2</span>, <span class="at">STATS=</span>NAK.R, <span class="at">FUN=</span><span class="st">&quot;/&quot;</span>)</span>
<span id="cb39-2"><a href="pedigree-based-ageprior.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(PA.R, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##      M    P  FS   MS   PS    X
## 0 0.00 0.00 0.6 0.41 0.37 0.10
## 1 0.63 0.36 0.4 0.48 0.54 0.18
## 2 0.32 0.51 0.0 0.11 0.09 0.16
## 3 0.05 0.13 0.0 0.00 0.00 0.14
## 4 0.00 0.00 0.0 0.00 0.00 0.12
## 5 0.00 0.00 0.0 0.00 0.00 0.10</code></pre>
<p>Pairs where one or both individuals have an unknown age difference, are excluded from both the numerator and the denominator. It is assumed that the age difference distribution of these pairs of relatives follows the same distribution as for relatives for which the age difference <em>is</em> known (Section <a href="maths.html#sec:unsampled">Unsampled individuals</a>).</p>
</div>
<div id="sec:FSuseHS" class="section level3" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Full sibling correction</h3>
<p>Sometimes full sibling pairs are rare, causing an imprecise estimate of their age-difference distribution. A reasonable assumption is that the distribution for full siblings is broadly similar to “happens to be both maternal and paternal sibling.”<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> If many half-sibling pairs have been sampled, their age distribution is used to improve the estimate of <span class="math inline">\(P(A|FS)\)</span> (this is not optional):</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="pedigree-based-ageprior.html#cb41-1" aria-hidden="true" tabindex="-1"></a>MinPairs.AgeKnown <span class="ot">&lt;-</span> <span class="dv">20</span>   <span class="co"># not user-setable.</span></span>
<span id="cb41-2"><a href="pedigree-based-ageprior.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the product of the distributions if there are many MS &amp; PS,</span></span>
<span id="cb41-3"><a href="pedigree-based-ageprior.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and the average across the two distributions if there are a medium number:</span></span>
<span id="cb41-4"><a href="pedigree-based-ageprior.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (NAK.R[<span class="st">&quot;FS&quot;</span>] <span class="sc">/</span> <span class="fu">min</span>(NAK.R[<span class="fu">c</span>(<span class="st">&quot;MS&quot;</span>, <span class="st">&quot;PS&quot;</span>)]) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> </span>
<span id="cb41-5"><a href="pedigree-based-ageprior.html#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all</span>(NAK.R[<span class="fu">c</span>(<span class="st">&quot;MS&quot;</span>, <span class="st">&quot;PS&quot;</span>)] <span class="sc">&gt;</span> MinPairs.AgeKnown)) {</span>
<span id="cb41-6"><a href="pedigree-based-ageprior.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">all</span>(NAK.R[<span class="fu">c</span>(<span class="st">&quot;MS&quot;</span>, <span class="st">&quot;PS&quot;</span>)] <span class="sc">&gt;</span> <span class="dv">5</span><span class="sc">*</span>MinPairs.AgeKnown)) {</span>
<span id="cb41-7"><a href="pedigree-based-ageprior.html#cb41-7" aria-hidden="true" tabindex="-1"></a>    FS.tmp <span class="ot">&lt;-</span> PA.R[,<span class="st">&quot;MS&quot;</span>] <span class="sc">*</span> PA.R[,<span class="st">&quot;PS&quot;</span>]</span>
<span id="cb41-8"><a href="pedigree-based-ageprior.html#cb41-8" aria-hidden="true" tabindex="-1"></a>    FS.tmp <span class="ot">&lt;-</span> FS.tmp<span class="sc">/</span><span class="fu">sum</span>(FS.tmp)</span>
<span id="cb41-9"><a href="pedigree-based-ageprior.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb41-10"><a href="pedigree-based-ageprior.html#cb41-10" aria-hidden="true" tabindex="-1"></a>    FS.tmp <span class="ot">&lt;-</span> <span class="fu">apply</span>(PA.R[, <span class="fu">c</span>(<span class="st">&quot;MS&quot;</span>, <span class="st">&quot;PS&quot;</span>)], <span class="dv">1</span>, mean)</span>
<span id="cb41-11"><a href="pedigree-based-ageprior.html#cb41-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-12"><a href="pedigree-based-ageprior.html#cb41-12" aria-hidden="true" tabindex="-1"></a>  PA.R[,<span class="st">&quot;FS&quot;</span>] <span class="ot">&lt;-</span> (PA.R[,<span class="st">&quot;FS&quot;</span>] <span class="sc">+</span> FS.tmp)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb41-13"><a href="pedigree-based-ageprior.html#cb41-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-14"><a href="pedigree-based-ageprior.html#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="pedigree-based-ageprior.html#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(PA.R[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ], <span class="dv">2</span>)  <span class="co"># note change in &#39;FS&#39; column</span></span></code></pre></div>
<pre><code>##      M    P   FS   MS   PS    X
## 0 0.00 0.00 0.48 0.41 0.37 0.10
## 1 0.63 0.36 0.51 0.48 0.54 0.18
## 2 0.32 0.51 0.01 0.11 0.09 0.16
## 3 0.05 0.13 0.00 0.00 0.00 0.14
## 4 0.00 0.00 0.00 0.00 0.00 0.12</code></pre>
</div>
<div id="sec:standardise" class="section level3" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> Ageprior P(A|R)/P(A): <code>LR.RU.A.raw</code></h3>
<p>The age-difference based probability ratio <span class="math inline">\(\alpha_{A,R}\)</span> is calculated by dividing <span class="math inline">\(P(A|R)\)</span> (each relationship column) by <span class="math inline">\(P(A)\)</span> (the <code>X</code> column):</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="pedigree-based-ageprior.html#cb43-1" aria-hidden="true" tabindex="-1"></a>LR.RU.A <span class="ot">&lt;-</span> <span class="fu">sweep</span>(PA.R[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">1</span>, <span class="at">STATS=</span>PA.R[,<span class="st">&quot;X&quot;</span>], <span class="at">FUN=</span><span class="st">&quot;/&quot;</span>)</span>
<span id="cb43-2"><a href="pedigree-based-ageprior.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(LR.RU.A, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##      M    P   FS   MS   PS
## 0 0.00 0.00 5.04 4.32 3.86
## 1 3.48 1.97 2.80 2.64 2.97
## 2 2.01 3.17 0.08 0.69 0.58
## 3 0.34 0.96 0.00 0.00 0.00
## 4 0.00 0.00 0.00 0.00 0.00
## 5 0.00 0.00 0.00 0.00 0.00</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="pedigree-based-ageprior.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check that this is identical to output from MakeAgePrior():</span></span>
<span id="cb45-2"><a href="pedigree-based-ageprior.html#cb45-2" aria-hidden="true" tabindex="-1"></a>LR.RU.A[<span class="sc">!</span><span class="fu">is.finite</span>(LR.RU.A)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-3"><a href="pedigree-based-ageprior.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">abs</span>(LR.RU.A  <span class="sc">-</span> AP.griffin[[<span class="st">&quot;LR.RU.A.raw&quot;</span>]]) <span class="sc">&lt;</span> <span class="fl">0.001</span>)  <span class="co"># allow for rounding errors</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>This is the non-flattened, non-smoothed ageprior, stored in list element <code>[["LR.RU.A.raw"]]</code>. Since in this example <code>Smooth=FALSE</code> and <code>Flatten=FALSE</code>, it is identical to list element <code>[["LR.RU.A"]]</code>, which is the default output (<code>Return='LR'</code>).</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Both individuals need to have already at least one parent assigned to be able to genetically distinguish between half-siblings, full avuncular, and grandparent–grand-offspring<a href="pedigree-based-ageprior.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>This is not necessarily the case. For example, in species that produce multiple offspring each year, and breed for multiple years, within-year (within-clutch) siblings are more likely to be full siblings than between-year siblings<a href="pedigree-based-ageprior.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-Default.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-smallCorr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
