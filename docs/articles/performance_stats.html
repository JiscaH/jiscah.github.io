<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sequoia">
<title>Performance stats • sequoia</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Performance stats">
<meta property="og:description" content="sequoia">
<meta property="og:image" content="https://jiscah.github.io/reference/figures/sequoia_hexlogo_s.png">
<meta property="og:image:alt" content="sequoia hexlogo">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@HuismanJisca">
<meta name="twitter:site" content="@HuismanJisca">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sequoia</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href=".././index.html">
    <span class="fas fa fas fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/sequoia.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_main/book/sec-Background.html">Main vignette: User guide</a>
    <a class="dropdown-item" href="../articles/vignette_age/book/index.html">Age prior vignette</a>
    <a class="dropdown-item" href="../articles/sequoia_report.html">Mock report</a>
    <a class="dropdown-item" href="../articles/index.html">Examples &amp; More info on ...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Change log</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/help.html">Help</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/performance_stats.html">Stats</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa fas fa-envelope"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JiscaH/sequoia">
    <span class="fab fa fab fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://ecoevo.social/@HuismanJisca">
    <span class="fab fa fab fa-mastodon"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/HuismanJisca">
    <span class="fab fa fab fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Performance stats</h1>
            
      
      
      <div class="d-none name"><code>performance_stats.Rmd</code></div>
    </div>

    
    
<hr>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The way <code>sequoia</code> is implemented, comparing likelihoods
for many different relationships and making assignments in a sequential
fashion, means that edits to improve performance for one particular type
of dataset may negatively affect performance in other datasets.</p>
<p>Therefore, each new version of <code>sequoia</code> is tested
extensively on both simulated and real data before release on CRAN. This
includes simulated data from the three pedigrees described in <span class="citation">Huisman (<a href="#ref-huisman17" role="doc-biblioref">2017</a>)</span> with a wide range of parameter
combinations, the results of which are available <a href="https://github.com/JiscaH/sequoia_archives/tree/main/performance_tests" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="data-description">Data description<a class="anchor" aria-label="anchor" href="#data-description"></a>
</h2>
<p>The files are in .RData format, which can be opened inside R with
<code>load('path/to/ThisFile.RData')</code>. Each .RData file contains a
12-dimensional array named <code>PCcount</code>, which contains the
amalgamated <code>$Counts</code> outputs from <code><a href="../reference/PedCompare.html">PedCompare()</a></code>
between the true pedigree and the pedigree reconstructed from simulated
genotype data. This is identical to the <code><a href="../reference/EstConf.html">EstConf()</a></code> output
element <code>$PedComp.fwd</code> (forward: comparison relative to the
the first, original pedigree).</p>
<p>The first dimension has length 1, and its dimname indicates the
sequoia version. The second dimension indicates the pedigree:</p>
<ul>
<li>‘FS’ : single generation with 1157 individuals produced by 432
monogamous matings with variable family size (1-11), 0% of parents
genotyped. 1014 individuals have one or more full siblings, 143 are
singletons.</li>
<li>‘HSg5’ : five non-overlapping generations with full siblings and
Half Siblings. Each generation, 24 females mate with 2 males each and 16
male with 3 females each, each mating results in 4 offspring. A random
40% of parents are simulated as non-genotyped.</li>
<li>‘deer’ : Seventeen birth year cohorts from the Rum red deer study
population: overlapping generations, some close inbreeding, and a
tendency for related females to mate with the same male. There are 1998
individuals in the pedigree, of which 1642 with a dam and 1202 with a
sire. A random 40% of parents are simulated as non-genotyped.</li>
</ul>
<p>Dimensions 3-8 relate to <code><a href="../reference/sequoia.html">sequoia()</a></code> input parameters,
with the presumed genotyping error rate <code>Err</code> equalling the
simulated error rate. Dimension 9 is the replicate, and dimensions 10-12
correspond to the <code><a href="../reference/PedCompare.html">PedCompare()</a></code> <code>$Counts</code> output
dimensions.</p>
<p>For versions prior to 1.3, the column names were relabelled to match
the current names.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for dimnames of output:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Ped_HSg5</span>, package<span class="op">=</span><span class="st">"sequoia"</span><span class="op">)</span></span>
<span><span class="va">PC</span> <span class="op">&lt;-</span> <span class="fu">sequoia</span><span class="fu">::</span><span class="fu"><a href="../reference/PedCompare.html">PedCompare</a></span><span class="op">(</span><span class="va">Ped_HSg5</span>, <span class="va">Ped_HSg5</span>, Plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ScoresToCount</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Cnt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">PC</span><span class="op">$</span><span class="va">Counts</span><span class="op">)</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">PC</span><span class="op">$</span><span class="va">Counts</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">Cnt</span><span class="op">[</span>,<span class="st">"Total"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">[</span>,<span class="st">"Total"</span>,<span class="op">]</span></span>
<span>  <span class="va">Cnt</span><span class="op">[</span>,<span class="st">"Match"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">[</span>,<span class="st">"OK"</span>,<span class="op">]</span> <span class="op">+</span> <span class="va">A</span><span class="op">[</span>,<span class="st">"Part"</span>,<span class="op">]</span></span>
<span>  <span class="va">Cnt</span><span class="op">[</span>,<span class="st">"Mismatch"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">[</span>,<span class="st">"Er"</span>,<span class="op">]</span></span>
<span>  <span class="va">Cnt</span><span class="op">[</span>,<span class="st">"P2only"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>   <span class="co">#included in Er</span></span>
<span>  <span class="va">Cnt</span><span class="op">[</span>,<span class="st">"P1only"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">[</span>,<span class="st">"None"</span>,<span class="op">]</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span> <span class="va">Cnt</span> <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-the-data">Load the data<a class="anchor" aria-label="anchor" href="#load-the-data"></a>
</h2>
<p>The data must first be downloaded before you can work with it in R.
Let’s compare the oldest, newest, and an in-between version.</p>
<p><em>click on the <code>Code</code> button on the right to see the R
code</em></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Version</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.7"</span>, <span class="st">"1.3"</span>, <span class="st">"2.3.4"</span><span class="op">)</span>   </span>
<span></span>
<span><span class="co"># make a folder to store the files in</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"sequoia_files"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gitfolder</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/JiscaH/sequoia_archives/main/performance_tests/"</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">Version</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">gitfolder</span>, <span class="st">"sequoia_PCcount_v"</span>, <span class="va">v</span>, <span class="st">".RData"</span><span class="op">)</span>,</span>
<span>                destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sequoia_files/PCcount_v"</span>, <span class="va">v</span>, <span class="st">".RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then combine the datasets from the separate versions into a single
array. This can e.g. done with <code>abind::abind()</code>, or ‘by
hand’:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sequoia_files/PCcount_v"</span>, <span class="va">Version</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">".RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PCC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Version</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">PCcount</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>version<span class="op">=</span><span class="va">Version</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">PCcount</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PCC</span><span class="op">[</span><span class="fl">1</span>,,,,,,,,,,,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">PCcount</span><span class="op">[</span><span class="fl">1</span>,,,,,,,,,,,<span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Version</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">Version</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sequoia_files/PCcount_v"</span>, <span class="va">v</span>, <span class="st">".RData"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">PCC</span><span class="op">[</span><span class="va">v</span>,,,,,,,,,,,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">PCcount</span><span class="op">[</span><span class="fl">1</span>,,,,,,,,,,,<span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">PCcount</span><span class="op">)</span></span></code></pre></div>
<p>An overview of the parameter combinations that were run can for
example be created like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Done</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/adply.html" class="external-link">adply</a></span><span class="op">(</span><span class="va">PCC</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>, <span class="kw">function</span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">A</span><span class="op">[</span>,<span class="st">"1"</span>,<span class="st">"TT"</span>,<span class="st">"Total"</span>,<span class="st">"dam"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<p>The parameter to vary on the x-axis is usually the explanatory
variable we are most interested in. Here we use the number of SNPs,
which also forms a useful proxy for the general ‘informativeness’ of the
SNP data. On the y-axis we have the proportion of non-assignments
(<code>P1only</code>, top row of panels) and the proportion of incorrect
assignments (<code>Mismatch</code> + <code>P2only</code>, bottom row).
Lastly, we show a few different parameter combinations in the different
panel columns.</p>
<p>This set-up and these parameter combinations are just an example of
how this data can be visualised, intended as a starting point for
further exploration.</p>
<p>To make the code more clear, we define (1) a function to get a subset
from the large array, (2) a function to do the actual plotting, and (3)
the parameter values to use, before (4) doing the actual plotting. This
makes it easier to e.g. change the parameter values, which can be done
at just a single place in the code, without having to change anything
else.</p>
<div class="section level4">
<h4 id="a-function-to-get-the-desired-slice-of-the-huge-array">1. A function to get the desired slice of the huge array:<a class="anchor" aria-label="anchor" href="#a-function-to-get-the-desired-slice-of-the-huge-array"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subset.PCC.specs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">PCCIN</span>,   <span class="co"># 12D array</span></span>
<span>                             <span class="va">specs</span><span class="op">)</span>   <span class="co"># 1-row df, names = (subset of) dimnames of PCC</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">dn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">PCCIN</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span>  <span class="va">those</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">specs</span><span class="op">)</span><span class="op">[</span><span class="va">dn</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">those</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">dn</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="va">dn</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">those</span><span class="op">[[</span><span class="va">d</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  <span class="va">those</span><span class="op">[[</span><span class="va">d</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">PCCIN</span><span class="op">)</span><span class="op">[[</span><span class="va">d</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">those</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">those</span>, <span class="va">as.character</span><span class="op">)</span></span>
<span>  <span class="va">OUT</span> <span class="op">&lt;-</span> <span class="va">PCCIN</span><span class="op">[</span><span class="va">those</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">those</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">those</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">those</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>,<span class="va">those</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>,</span>
<span>               <span class="va">those</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>,<span class="va">those</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span>,<span class="va">those</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span>, , , , <span class="op">]</span></span>
<span>  <span class="co"># there almost certainly is a more elegant way of doing this. </span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span> <span class="va">OUT</span> <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plotting-function">2. Plotting function :<a class="anchor" aria-label="anchor" href="#plotting-function"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># required packages:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">plotrix</span><span class="op">)</span>   <span class="co"># for axis.break()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span>   <span class="co"># defines aaply(): as apply(), but consistent output format</span></span>
<span></span>
<span></span>
<span><span class="co"># minimum detectable error rate:</span></span>
<span><span class="co"># 1 / (2*1000 * 20)   # 2.5E-5</span></span>
<span><span class="va">Yzero</span> <span class="op">&lt;-</span> <span class="fl">1e-5</span></span>
<span><span class="va">YAT</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> </span>
<span><span class="va">BRK</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4.8</span>   <span class="co"># break in y-axis</span></span>
<span></span>
<span></span>
<span><span class="va">PlotFun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ARER</span>, <span class="va">COL</span>, <span class="va">All</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">Avg</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">Avg</span><span class="op">)</span>  <span class="va">ARER.avg</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/aaply.html" class="external-link">aaply</a></span><span class="op">(</span><span class="va">ARER</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">mean</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># average over iterations</span></span>
<span>  </span>
<span>  <span class="va">LL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">ARER</span><span class="op">)</span><span class="op">$</span><span class="va">nSnp</span><span class="op">)</span>   <span class="co"># x-axis</span></span>
<span>  <span class="va">Offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ARER</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">ARER</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># set up the plot &amp; axes:</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>       xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">450</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Yzero</span>, <span class="fl">1</span><span class="op">)</span>, log<span class="op">=</span><span class="st">"y"</span>,</span>
<span>       yaxt<span class="op">=</span><span class="st">"n"</span>, ylab<span class="op">=</span><span class="st">""</span>, xlab<span class="op">=</span><span class="st">""</span>, las<span class="op">=</span><span class="fl">1</span>, cex.lab<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="va">YAT</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">YAT</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span>, cex.axis<span class="op">=</span><span class="fl">1.1</span><span class="op">)</span></span>
<span>  <span class="fu">plotrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/axis.break.html" class="external-link">axis.break</a></span><span class="op">(</span><span class="fl">2</span>, breakpos<span class="op">=</span><span class="va">BRK</span>, style <span class="op">=</span> <span class="st">"slash"</span>, brw<span class="op">=</span><span class="fl">0.03</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">YAT</span>, col<span class="op">=</span><span class="st">"lightgrey"</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># plot points &amp; lines:</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">All</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">Version</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">ARER</span><span class="op">[</span><span class="va">v</span>,,<span class="op">]</span></span>
<span>      <span class="va">Y</span><span class="op">[</span><span class="va">Y</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Yzero</span>   <span class="co"># else not plotted if y-axis logarithmic</span></span>
<span>      <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LL</span> <span class="op">+</span> <span class="va">Offset</span><span class="op">[</span><span class="va">v</span><span class="op">]</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">x</span>, factor<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>             col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="va">COL</span><span class="op">[</span><span class="va">v</span><span class="op">]</span>, alpha.f<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">Avg</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="va">Version</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">ARER.avg</span><span class="op">[</span><span class="va">v</span>,<span class="op">]</span></span>
<span>      <span class="va">Y</span><span class="op">[</span><span class="va">Y</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Yzero</span>   <span class="co"># else not plotted if y-axis logarithmic</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LL</span> <span class="op">+</span> <span class="va">Offset</span><span class="op">[</span><span class="va">v</span><span class="op">]</span>, <span class="va">Y</span>, type<span class="op">=</span><span class="st">"b"</span>, col<span class="op">=</span><span class="va">COL</span><span class="op">[</span><span class="va">v</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="specify-parameters-colours">3. Specify parameters &amp; colours:<a class="anchor" aria-label="anchor" href="#specify-parameters-colours"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PlotSpecs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pedigree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FS"</span>, <span class="st">"HSg5"</span>, <span class="st">"deer"</span><span class="op">)</span>,</span>
<span>                        Err <span class="op">=</span> <span class="st">"1e-4"</span>,</span>
<span>                        Complx <span class="op">=</span> <span class="st">"full"</span>,  <span class="co">#c("mono", "full", "full"),</span></span>
<span>                        Tassign <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                        Discrete <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                        UseAge <span class="op">=</span> <span class="st">"yes"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">COL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Version</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, </span>
<span>                           palette<span class="op">=</span><span class="st">"inferno"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">Version</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">Version</span><span class="op">)</span><span class="op">)</span>   <span class="co"># match each color to a particular version</span></span>
<span><span class="co"># NOTE: hcl.colors() doesn't work in old R versions</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="calculate-rates-from-counts-plot">4. Calculate rates from counts &amp; plot<a class="anchor" aria-label="anchor" href="#calculate-rates-from-counts-plot"></a>
</h4>
<p>When the pedigree includes dummy individuals and
sibship-grandparents, the denominator for the assignment and error rate
is not unambiguous.</p>
<p>In the paper and the vignette, the total number of individuals with a
dam/sire is used to calculate the assignment rate, and the total number
of individuals in a pedigree for the error rate (founders can also have
an incorrect parent assigned). These seem the most relevant metrics for
e.g. comparisons to other methods.</p>
<p>Here, to more clearly show the difference between versions, we
calculate assignment rates as a proportion of the maximum number that
could have been assigned by sequoia.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PedN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>FS <span class="op">=</span> <span class="fl">1157</span>, HSg5 <span class="op">=</span> <span class="fl">1000</span>, deer <span class="op">=</span> <span class="fl">1998</span><span class="op">)</span>   <span class="co"># denominators for error rate</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">PlotSpecs</span><span class="op">)</span><span class="op">)</span>, mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.6</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, omi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.6</span>,<span class="fl">1.3</span>,<span class="fl">.1</span><span class="op">)</span>, xpd<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">PlotSpecs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># subset data, using the function defined above</span></span>
<span>  <span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu">subset.PCC.specs</span><span class="op">(</span><span class="va">PCC</span>, <span class="va">PlotSpecs</span><span class="op">[</span><span class="va">n</span>,<span class="op">]</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="va">ccat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GG"</span>,<span class="st">"GD"</span>,<span class="st">"DG"</span>,<span class="st">"DD"</span><span class="op">)</span>   </span>
<span>  </span>
<span>  <span class="co"># calculate assignment &amp; error rates</span></span>
<span>  <span class="va">ARER</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    AR <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/aaply.html" class="external-link">aaply</a></span><span class="op">(</span><span class="va">Data</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">A</span><span class="op">[</span><span class="va">ccat</span>, <span class="st">"P1only"</span>, <span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">A</span><span class="op">[</span><span class="va">ccat</span>, <span class="st">"Total"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="co">#      mean(A["TT", "P1only", ] / A["TT", "Total",])),  # denominator = all </span></span>
<span>    ER <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/aaply.html" class="external-link">aaply</a></span><span class="op">(</span><span class="va">Data</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">A</span><span class="op">[</span><span class="st">"TT"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mismatch"</span>, <span class="st">"P2only"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">PedN</span><span class="op">[</span><span class="va">PlotSpecs</span><span class="op">[</span><span class="va">n</span>,<span class="st">"pedigree"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">YLAB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AR"</span> <span class="op">=</span> <span class="st">"False negatives"</span>,</span>
<span>            <span class="st">"ER"</span> <span class="op">=</span> <span class="st">"Mismatch + \n False positives"</span><span class="op">)</span></span>
<span>  <span class="va">Title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">PlotSpecs</span><span class="op">)</span>, <span class="va">PlotSpecs</span><span class="op">[</span><span class="va">n</span>,<span class="op">]</span>, sep<span class="op">=</span><span class="st">" = "</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># plot using the function defined above, then add margin text &amp; legend</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">z</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AR"</span>, <span class="st">"ER"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">PlotFun</span><span class="op">(</span><span class="va">ARER</span><span class="op">[[</span><span class="va">z</span><span class="op">]</span><span class="op">]</span>, COL <span class="op">=</span> <span class="va">COL</span>, All <span class="op">=</span> <span class="cn">TRUE</span>, Avg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">z</span> <span class="op">==</span> <span class="st">"AR"</span><span class="op">)</span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="va">Title</span>, side<span class="op">=</span><span class="fl">3</span>, line<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">z</span> <span class="op">==</span> <span class="st">"ER"</span><span class="op">)</span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"No. SNPs"</span>, side<span class="op">=</span><span class="fl">1</span>, line<span class="op">=</span><span class="fl">3</span>, cex<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">n</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="va">YLAB</span><span class="op">[[</span><span class="va">z</span><span class="op">]</span><span class="op">]</span>, side<span class="op">=</span><span class="fl">2</span>, line<span class="op">=</span><span class="fl">5</span>, cex<span class="op">=</span><span class="fl">1.1</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">z</span> <span class="op">==</span> <span class="st">"AR"</span> <span class="op">&amp;</span> <span class="va">n</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">COL</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="va">COL</span>, inset<span class="op">=</span><span class="fl">.02</span>,</span>
<span>             title<span class="op">=</span><span class="st">"Version"</span><span class="op">)</span></span>
<span>  <span class="op">}</span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="performance_stats_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h3>
<p>At first glance, the average across iterations seems to suggest that
version 2.3.4 performs worse than version 1.3 for the ‘FS’ and ‘HSg5’
pedigrees. However, the results for the individual runs show that this
difference is not statistically significant and/or due to a single poor
run (middle column, 400 SNPs). For the more complex ‘deer’ pedigree
(right column), version 2.3.4 outperforms version 1.3.</p>
<p>For the ‘FS’ pedigree, the assignment rate was noticeably higher in
the oldest version, but so was the error rate. The difference is largely
due to considering ‘full cousin’ (3rd degree relatives) as a
relationship alternative. See also <a href="./pairLL_classification.html">pairwise likelihoods</a> on how to
recover some of these non-assigned pairs.</p>
<p>The variation between replicates is partly due to variation in which
parents are simulated as genotyped: if several parents in a complicated
pedigree loop are all non-genotyped, assignment errors are more likely
than when in these more complicated regions of the pedigree a high
proportion of parents are genotyped. See <a href="./vignette_main/book/key-points.html#sec:GenoErrors">main
vignette</a> for more information on the difference in assignment rate
between genotyped-genotyped versus genotyped-dummy and dummy-dummy
pairs.</p>
<hr>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-huisman17" class="csl-entry">
Huisman, Jisca. 2017. <span>“Pedigree Reconstruction from
<span>SNP</span> Data: Parentage Assignment, Sibship Clustering and
Beyond.”</span> <em>Molecular Ecology Resources</em> 17 (5): 1009–24.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
