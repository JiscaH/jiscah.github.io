<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pedigrees from SNP data • sequoia</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Pedigrees from SNP data">
<meta property="og:description" content="An R package to reconstruct multi-generational pedigrees, with any proportion of genotyped parents">
<meta property="og:image" content="/reference/figures/sequoia_hexlogo_s.png">
<meta property="og:image:alt" content="sequoia hexlogo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">sequoia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="./index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="articles/Get_started.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/vignette_main/book/sec-Background.html">Main vignette: User guide</a>
    </li>
    <li>
      <a href="articles/vignette_age/book/index.html">Age prior vignette</a>
    </li>
    <li>
      <a href="articles/index.html">Examples</a>
    </li>
    <li>
      <a href="articles/index.html">More info on ...</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Change log</a>
</li>
<li>
  <a href="articles/help.html">Help</a>
</li>
<li>
  <a href="articles/performance_stats.html">Stats</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/HuismanJisca">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="mailto:jisca.huisman@gmail.com">
    <span class="fas fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/JiscaH/sequoia">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="sequoia-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#sequoia-" class="anchor"></a>Sequoia <img src="reference/figures/sequoia_hexlogo.svg" align="right" height="225" style="vertical-align:middle;margin:0px 20px">
</h1></div>
<div id="multi-generational-pedigree-reconstruction-from-snp-data-accounting-for-genotyping-errors-overlapping-or-discrete-generations-with-or-without-inbreeding-any-proportion-of-genotyped-parents-no-lists-of-candidate-parents-needed-just-birth-years" class="section level4">
<h4 class="hasAnchor">
<a href="#multi-generational-pedigree-reconstruction-from-snp-data-accounting-for-genotyping-errors-overlapping-or-discrete-generations-with-or-without-inbreeding-any-proportion-of-genotyped-parents-no-lists-of-candidate-parents-needed-just-birth-years" class="anchor"></a>Multi-generational pedigree reconstruction from SNP data. Accounting for genotyping errors. Overlapping or discrete generations, with or without inbreeding, any proportion of genotyped parents. No lists of candidate parents needed, just birth years.</h4>
<p><br></p>
</div>
<div id="what-it-can-do" class="section level2">
<h2 class="hasAnchor">
<a href="#what-it-can-do" class="anchor"></a>What it can do</h2>
<div id="-parentage-assignment" class="section level4">
<h4 class="hasAnchor">
<a href="#-parentage-assignment" class="anchor"></a><img src="reference/figures/parents.svg" width="100" height="70"> Parentage assignment</h4>
<p>Candidate parent–offspring pairs are short-listed among all genotyped individuals based on the number of SNPs at which they are opposing homozygotes. Parents are assigned based on the likelihood ratio between the pair being parent–offspring versus the most-likely alternative relationship. The pair can be oriented if their relative age is known, or if there is a complementary co-parent. <br></p>
</div>
<div id="-sibship-clustering" class="section level4">
<h4 class="hasAnchor">
<a href="#-sibship-clustering" class="anchor"></a><img src="reference/figures/siblings.svg" width="100" height="80"> Sibship clustering</h4>
<p>When not all parents were genotyped, clusters of half- and full-siblings are identified, and each assigned a dummy parent. Every dummy individual corresponds to a real-world, non-genotyped individual. <br></p>
</div>
<div id="-grandparent-assignment" class="section level4">
<h4 class="hasAnchor">
<a href="#-grandparent-assignment" class="anchor"></a><img src="reference/figures/grandparents.svg" width="100" height="70"> Grandparent assignment</h4>
<p>For each cluster of half-siblings, grandparents are assigned where possible, i.e. parents of the sibship’s dummy-parent. These grandparents may be dummy individuals themselves, so that parent-offspring links may be established between two non-genotyped individuals.</p>
<div>
<p><img src="reference/figures/Dummies_for_dummies.svg" width="300" height="300" alt="pedigree example"></p>
</div>
</div>
</div>
<div id="rationale" class="section level2">
<h2 class="hasAnchor">
<a href="#rationale" class="anchor"></a>Rationale</h2>
<p>Pedigree reconstruction with <code><a href="reference/sequoia.html">sequoia()</a></code> relies on the likelihood ratios between a focal relationship (e.g. parent-offspring, PO) and a myriad of alternative relationships for that pair (full siblings, aunt-niece, …, or unrelated U). This method is inspired by the work of E.A. Thompson, such as this excerpt from her paper <em>‘A Paradox of Genealogical Inference’</em> (1976):</p>
<div>
<p><img src="reference/figures/Thompson_1976_quote1.png" height="150" alt="Thompson 1976 quote"></p>
</div>
<p>In other words, when comparing likelihood ratios LLR(PO/U) <em>between</em> candidate parents, by chance some full siblings may have a higher value than the true parent, even in absence of genotyping errors.</p>
<p>One possible solution is to consider the likelihood of all assignments jointly in an MCMC(-like) approach, but the number of possible pedigree configurations to explore is enormous.</p>
<p>Comparing for each pair of putative relatives many different relationships makes each assignment rather computationally intensive, but this is offset by various filtering steps (based on e.g. the age difference and Mendelian inconsistencies) and using a ‘hill-climbing algorithm’ rather than an MCMC. Imagine it as taking slow, careful steps up the mountain, carefully inspecting the direct surroundings before taking a new step, compared to running around the mountainside more or less at random. If there is a fairly clear path to the likelihood top (i.e. moderately high quality SNP data), <code>sequoia</code> will usually do fine. If there is not, an MCMC-based approach may be preferable.</p>
</div>
<div id="package-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#package-overview" class="anchor"></a>Package overview</h2>
<p>Beside the main function for pedigree reconstruction (<code><a href="reference/sequoia.html">sequoia()</a></code>) the R package contains various other functions, amongst others to check agreement between an existing pedigree and the genotype data, or with a newly inferred pedigree.</p>
<p><a href="./reference/figures/flowchart.svg"> <img src="reference/figures/flowchart.svg" height="300" alt="flowchart" style="vertical-align:middle;margin:0px 20px"></a> <br><br><a href="reference/figures/flowchart_no_bg.pdf">print-friendly version</a></p>
<!--
![](man/figures/flowchart.svg) 
<br>
 --->
<p><br><br></p>
<p>For detailed information, please see the vignettes (rendered using <a href="https://bookdown.org/yihui/bookdown/">bookdown</a>):</p>
<p><a href="./articles/vignette_main/book/sec-Background.html"> <img src="reference/figures/sequoia_hexlogo_vignette_main.svg" height="150" alt="main vignette" style="vertical-align:middle;margin:0px 20px"></a> <a href="./articles/vignette_age/book/index.html"> <img src="reference/figures/sequoia_hexlogo_vignette_age.svg" height="150" alt="age vignette" style="vertical-align:middle;margin:0px 20px"></a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=sequoia">https://​cloud.r-project.org/​package=sequoia</a>
</li>
<li>Browse source code at <br><a href="https://github.com/JiscaH/sequoia">https://​github.com/​JiscaH/​sequoia</a>
</li>
<li>Report a bug at <br><a href="https://github.com/JiscaH/sequoia/issues">https://​github.com/​JiscaH/​sequoia/​issues</a>
</li>
<li>Download old versions at <br><a href="https://github.com/JiscaH/sequoia_archives">https://​github.com/​JiscaH/​sequoia_archives</a>
</li>
<li>Download non-R version at <br><a href="https://github.com/JiscaH/sequoia_notR">https://​github.com/​JiscaH/​sequoia_notR</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing sequoia</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jisca Huisman <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
