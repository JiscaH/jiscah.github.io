<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Running sequoia() | Sequoia User Guide</title>
  <meta name="description" content="5 Running sequoia() | Sequoia User Guide" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Running sequoia() | Sequoia User Guide" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/../../sequoia_logo.png" />
  
  <meta name="github-repo" content="JiscaH/sequoia" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Running sequoia() | Sequoia User Guide" />
  
  
  <meta name="twitter:image" content="/../../sequoia_logo.png" />

<meta name="author" content="Jisca Huisman" />


<meta name="date" content="2021-05-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png" />
  <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
<link rel="prev" href="sequoia-input.html"/>
<link rel="next" href="output-check.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./../../../index.html"><img src="../../home-solid-silver.svg" height="40" alt="home"/></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="sec-Background.html"><a href="sec-Background.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="key-points.html"><a href="key-points.html"><i class="fa fa-check"></i><b>2</b> Key Points</a>
<ul>
<li class="chapter" data-level="2.1" data-path="key-points.html"><a href="key-points.html#sec:MendelErrors"><i class="fa fa-check"></i><b>2.1</b> Mendelian Errors</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="key-points.html"><a href="key-points.html#parent-pairs"><i class="fa fa-check"></i><b>2.1.1</b> Parent-pairs</a></li>
<li class="chapter" data-level="2.1.2" data-path="key-points.html"><a href="key-points.html#maximum-mismatches"><i class="fa fa-check"></i><b>2.1.2</b> Maximum mismatches</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="key-points.html"><a href="key-points.html#likelihoods"><i class="fa fa-check"></i><b>2.2</b> Likelihoods</a></li>
<li class="chapter" data-level="2.3" data-path="key-points.html"><a href="key-points.html#sec:GenoErrors"><i class="fa fa-check"></i><b>2.3</b> Genotyping errors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="key-points.html"><a href="key-points.html#effect"><i class="fa fa-check"></i><b>2.3.1</b> Effect</a></li>
<li class="chapter" data-level="2.3.2" data-path="key-points.html"><a href="key-points.html#assumed-genotyping-error-rate-err"><i class="fa fa-check"></i><b>2.3.2</b> Assumed genotyping error rate <code>Err</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="key-points.html"><a href="key-points.html#performance-with-high-genotyping-error-rates"><i class="fa fa-check"></i><b>2.3.3</b> Performance with high genotyping error rates</a></li>
<li class="chapter" data-level="2.3.4" data-path="key-points.html"><a href="key-points.html#effect-on-runtime"><i class="fa fa-check"></i><b>2.3.4</b> Effect on runtime</a></li>
<li class="chapter" data-level="2.3.5" data-path="key-points.html"><a href="key-points.html#error-matrix"><i class="fa fa-check"></i><b>2.3.5</b> Error matrix</a></li>
<li class="chapter" data-level="2.3.6" data-path="key-points.html"><a href="key-points.html#estimate"><i class="fa fa-check"></i><b>2.3.6</b> Estimate</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="key-points.html"><a href="key-points.html#sec:BY-AP"><i class="fa fa-check"></i><b>2.4</b> Birth years &amp; Ageprior</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="key-points.html"><a href="key-points.html#definition-interpretation"><i class="fa fa-check"></i><b>2.4.1</b> Definition &amp; interpretation</a></li>
<li class="chapter" data-level="2.4.2" data-path="key-points.html"><a href="key-points.html#implementation"><i class="fa fa-check"></i><b>2.4.2</b> Implementation</a></li>
<li class="chapter" data-level="2.4.3" data-path="key-points.html"><a href="key-points.html#smooth-flatten"><i class="fa fa-check"></i><b>2.4.3</b> Smooth &amp; Flatten</a></li>
<li class="chapter" data-level="2.4.4" data-path="key-points.html"><a href="key-points.html#age-based-non-assignment"><i class="fa fa-check"></i><b>2.4.4</b> Age-based non-assignment</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="key-points.html"><a href="key-points.html#parent-llr"><i class="fa fa-check"></i><b>2.5</b> Parent LLR</a></li>
<li class="chapter" data-level="2.6" data-path="key-points.html"><a href="key-points.html#sec:EstConf"><i class="fa fa-check"></i><b>2.6</b> Confidence</a></li>
<li class="chapter" data-level="2.7" data-path="key-points.html"><a href="key-points.html#sec:lowAR"><i class="fa fa-check"></i><b>2.7</b> Low assignment rate</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="key-points.html"><a href="key-points.html#causes"><i class="fa fa-check"></i><b>2.7.1</b> Causes</a></li>
<li class="chapter" data-level="2.7.2" data-path="key-points.html"><a href="key-points.html#remedies"><i class="fa fa-check"></i><b>2.7.2</b> Remedies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="function-overview.html"><a href="function-overview.html"><i class="fa fa-check"></i><b>3</b> Function overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="function-overview.html"><a href="function-overview.html#input"><i class="fa fa-check"></i><b>3.1</b> Input</a></li>
<li class="chapter" data-level="3.2" data-path="function-overview.html"><a href="function-overview.html#simulate"><i class="fa fa-check"></i><b>3.2</b> Simulate</a></li>
<li class="chapter" data-level="3.3" data-path="function-overview.html"><a href="function-overview.html#ageprior"><i class="fa fa-check"></i><b>3.3</b> Ageprior</a></li>
<li class="chapter" data-level="3.4" data-path="function-overview.html"><a href="function-overview.html#pedigree-reconstruction"><i class="fa fa-check"></i><b>3.4</b> Pedigree reconstruction</a></li>
<li class="chapter" data-level="3.5" data-path="function-overview.html"><a href="function-overview.html#pedigree-check"><i class="fa fa-check"></i><b>3.5</b> Pedigree check</a></li>
<li class="chapter" data-level="3.6" data-path="function-overview.html"><a href="function-overview.html#pairwise-relationships"><i class="fa fa-check"></i><b>3.6</b> Pairwise relationships</a></li>
<li class="chapter" data-level="3.7" data-path="function-overview.html"><a href="function-overview.html#miscellaneous"><i class="fa fa-check"></i><b>3.7</b> Miscellaneous</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sequoia-input.html"><a href="sequoia-input.html"><i class="fa fa-check"></i><b>4</b> <code>sequoia()</code> input</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:GenoFormat"><i class="fa fa-check"></i><b>4.1</b> Genotypes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sequoia-input.html"><a href="sequoia-input.html#subset-snps"><i class="fa fa-check"></i><b>4.1.1</b> Subset SNPs</a></li>
<li class="chapter" data-level="4.1.2" data-path="sequoia-input.html"><a href="sequoia-input.html#plink"><i class="fa fa-check"></i><b>4.1.2</b> PLINK</a></li>
<li class="chapter" data-level="4.1.3" data-path="sequoia-input.html"><a href="sequoia-input.html#low-call-rate"><i class="fa fa-check"></i><b>4.1.3</b> Low call rate</a></li>
<li class="chapter" data-level="4.1.4" data-path="sequoia-input.html"><a href="sequoia-input.html#very-large-datasets"><i class="fa fa-check"></i><b>4.1.4</b> Very large datasets</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sequoia-input.html"><a href="sequoia-input.html#birth-years-sex"><i class="fa fa-check"></i><b>4.2</b> Birth years &amp; sex</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sequoia-input.html"><a href="sequoia-input.html#lifehistdata"><i class="fa fa-check"></i><b>4.2.1</b> LifeHistData</a></li>
<li class="chapter" data-level="4.2.2" data-path="sequoia-input.html"><a href="sequoia-input.html#unknown-birth-years"><i class="fa fa-check"></i><b>4.2.2</b> Unknown birth years</a></li>
<li class="chapter" data-level="4.2.3" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:custom-AP"><i class="fa fa-check"></i><b>4.2.3</b> <code>args.AP</code> (Customising the ageprior)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sequoia-input.html"><a href="sequoia-input.html#tfilter-tassign"><i class="fa fa-check"></i><b>4.3</b> <code>Tfilter</code> &amp; <code>Tassign</code></a></li>
<li class="chapter" data-level="4.4" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:Complx"><i class="fa fa-check"></i><b>4.4</b> <code>Complex</code></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:WeirdRels"><i class="fa fa-check"></i><b>4.4.1</b> Unusual relationships</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sequoia-input.html"><a href="sequoia-input.html#herm"><i class="fa fa-check"></i><b>4.5</b> <code>Herm</code></a></li>
<li class="chapter" data-level="4.6" data-path="sequoia-input.html"><a href="sequoia-input.html#useage"><i class="fa fa-check"></i><b>4.6</b> <code>UseAge</code></a></li>
<li class="chapter" data-level="4.7" data-path="sequoia-input.html"><a href="sequoia-input.html#sec:reuse"><i class="fa fa-check"></i><b>4.7</b> <code>SeqList</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="running-sequoia.html"><a href="running-sequoia.html"><i class="fa fa-check"></i><b>5</b> Running <code>sequoia()</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="running-sequoia.html"><a href="running-sequoia.html#module-maxsibiter"><i class="fa fa-check"></i><b>5.1</b> <code>Module</code> (<code>MaxSibIter</code>)</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="running-sequoia.html"><a href="running-sequoia.html#sec:MaxSibIter"><i class="fa fa-check"></i><b>5.1.1</b> <code>MaxSibIter</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="running-sequoia.html"><a href="running-sequoia.html#input-check"><i class="fa fa-check"></i><b>5.2</b> Input check</a></li>
<li class="chapter" data-level="5.3" data-path="running-sequoia.html"><a href="running-sequoia.html#check-for-duplicates"><i class="fa fa-check"></i><b>5.3</b> Check for duplicates</a></li>
<li class="chapter" data-level="5.4" data-path="running-sequoia.html"><a href="running-sequoia.html#parentage-assignment"><i class="fa fa-check"></i><b>5.4</b> Parentage assignment</a></li>
<li class="chapter" data-level="5.5" data-path="running-sequoia.html"><a href="running-sequoia.html#ageprior-1"><i class="fa fa-check"></i><b>5.5</b> AgePrior</a></li>
<li class="chapter" data-level="5.6" data-path="running-sequoia.html"><a href="running-sequoia.html#full-reconstruction"><i class="fa fa-check"></i><b>5.6</b> Full reconstruction</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="running-sequoia.html"><a href="running-sequoia.html#dummy-individuals"><i class="fa fa-check"></i><b>5.6.1</b> Dummy Individuals</a></li>
<li class="chapter" data-level="5.6.2" data-path="running-sequoia.html"><a href="running-sequoia.html#total-likelihood"><i class="fa fa-check"></i><b>5.6.2</b> Total likelihood</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="running-sequoia.html"><a href="running-sequoia.html#save-output"><i class="fa fa-check"></i><b>5.7</b> Save output</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="output-check.html"><a href="output-check.html"><i class="fa fa-check"></i><b>6</b> Output check</a>
<ul>
<li class="chapter" data-level="6.1" data-path="output-check.html"><a href="output-check.html#pedigree-stats-plots"><i class="fa fa-check"></i><b>6.1</b> Pedigree stats &amp; plots</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="output-check.html"><a href="output-check.html#negative-llrs"><i class="fa fa-check"></i><b>6.1.1</b> Negative LLR’s</a></li>
<li class="chapter" data-level="6.1.2" data-path="output-check.html"><a href="output-check.html#dyad-plot"><i class="fa fa-check"></i><b>6.1.2</b> Dyad plot</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="output-check.html"><a href="output-check.html#sec:compPed"><i class="fa fa-check"></i><b>6.2</b> Compare pedigrees</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="output-check.html"><a href="output-check.html#dummy-matching"><i class="fa fa-check"></i><b>6.2.1</b> Dummy matching</a></li>
<li class="chapter" data-level="6.2.2" data-path="output-check.html"><a href="output-check.html#example"><i class="fa fa-check"></i><b>6.2.2</b> Example</a></li>
<li class="chapter" data-level="6.2.3" data-path="output-check.html"><a href="output-check.html#colony"><i class="fa fa-check"></i><b>6.2.3</b> Colony</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="output-check.html"><a href="output-check.html#sec:compR"><i class="fa fa-check"></i><b>6.3</b> Relatedness</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="output-check.html"><a href="output-check.html#sec:Rped"><i class="fa fa-check"></i><b>6.3.1</b> Pedigree relatedness</a></li>
<li class="chapter" data-level="6.3.2" data-path="output-check.html"><a href="output-check.html#genomic-relatedness"><i class="fa fa-check"></i><b>6.3.2</b> Genomic relatedness</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="output-check.html"><a href="output-check.html#cluster-families"><i class="fa fa-check"></i><b>6.4</b> Cluster families</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hermaphrodites.html"><a href="hermaphrodites.html"><i class="fa fa-check"></i><b>7</b> Hermaphrodites</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hermaphrodites.html"><a href="hermaphrodites.html#herm-a-pedigree-prior"><i class="fa fa-check"></i><b>7.1</b> Herm ‘A’: Pedigree prior</a></li>
<li class="chapter" data-level="7.2" data-path="hermaphrodites.html"><a href="hermaphrodites.html#herm-b-ignore-sex-role"><i class="fa fa-check"></i><b>7.2</b> Herm ‘B’: Ignore sex role</a></li>
<li class="chapter" data-level="7.3" data-path="hermaphrodites.html"><a href="hermaphrodites.html#hermaphrodite-dummies"><i class="fa fa-check"></i><b>7.3</b> Hermaphrodite dummies</a></li>
<li class="chapter" data-level="7.4" data-path="hermaphrodites.html"><a href="hermaphrodites.html#assignment-errors"><i class="fa fa-check"></i><b>7.4</b> Assignment errors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>8</b> FAQ</a>
<ul>
<li class="chapter" data-level="8.1" data-path="faq.html"><a href="faq.html#error-aboutdue-to-input-data"><i class="fa fa-check"></i><b>8.1</b> Error about/due to input data</a></li>
<li class="chapter" data-level="8.2" data-path="faq.html"><a href="faq.html#sec:FAQlowAR"><i class="fa fa-check"></i><b>8.2</b> Low assignment rate</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="faq.html"><a href="faq.html#not-enough-snps"><i class="fa fa-check"></i><b>8.2.1</b> Not enough SNPs</a></li>
<li class="chapter" data-level="8.2.2" data-path="faq.html"><a href="faq.html#genotyping-errors"><i class="fa fa-check"></i><b>8.2.2</b> Genotyping errors</a></li>
<li class="chapter" data-level="8.2.3" data-path="faq.html"><a href="faq.html#lacking-sex-information"><i class="fa fa-check"></i><b>8.2.3</b> Lacking sex information</a></li>
<li class="chapter" data-level="8.2.4" data-path="faq.html"><a href="faq.html#insufficient-age-information"><i class="fa fa-check"></i><b>8.2.4</b> Insufficient age information</a></li>
<li class="chapter" data-level="8.2.5" data-path="faq.html"><a href="faq.html#uninformative-age-prior"><i class="fa fa-check"></i><b>8.2.5</b> Uninformative age prior</a></li>
<li class="chapter" data-level="8.2.6" data-path="faq.html"><a href="faq.html#mating-system"><i class="fa fa-check"></i><b>8.2.6</b> Mating system</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="faq.html"><a href="faq.html#death-year"><i class="fa fa-check"></i><b>8.3</b> Death year</a></li>
<li class="chapter" data-level="8.4" data-path="faq.html"><a href="faq.html#accuracy"><i class="fa fa-check"></i><b>8.4</b> Accuracy</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="faq.html"><a href="faq.html#field-pedigree"><i class="fa fa-check"></i><b>8.4.1</b> Field pedigree</a></li>
<li class="chapter" data-level="8.4.2" data-path="faq.html"><a href="faq.html#genomic-relatedness-1"><i class="fa fa-check"></i><b>8.4.2</b> Genomic relatedness</a></li>
<li class="chapter" data-level="8.4.3" data-path="faq.html"><a href="faq.html#data-simulation"><i class="fa fa-check"></i><b>8.4.3</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="faq.html"><a href="faq.html#add-new-individuals"><i class="fa fa-check"></i><b>8.5</b> Add new individuals</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="./../../vignette_age/_book/index.html">Ageprior Vignette</a></li>
<li><a href="./../../index.html">Other Manuals</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sequoia User Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="running-sequoia" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Running <code>sequoia()</code></h1>
<hr />
<div id="module-maxsibiter" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> <code>Module</code> (<code>MaxSibIter</code>)</h2>
<p>Most datasets initially contain imperfections. Pedigree reconstruction can be a useful tool in quality control, to find outliers with many Mendelian errors among e.g. known mother–offspring pairs (sample mislabeling?) or among SNPs (poor quality SNPs to be excluded).</p>
<p>To speed up iterative quality control, it is possible to run <code>sequoia()</code> only up to a certain point, use the output thus far to, as necessary, exclude SNPs, exclude/relabel samples, or adjust input parameters, and re-run again from the start or resume from the last point.</p>
<p>There are three possible intermediate stopping points, plus the final end point, each named after the last ‘<code>Module</code>’ that is run:</p>
<ol style="list-style-type: decimal">
<li><strong><code>'pre'</code></strong>: Input check<br />
check that the genotype data, life history data and input parameters are in a valid format, create <code>'Specs'</code> element of output list</li>
<li><strong><code>'dup'</code></strong>: check for duplicates<br />
Check for (nearly) identical genotypes, and for duplicated IDs in the genotype and life history data</li>
<li><strong><code>'par'</code></strong>: parentage assignment<br />
Assign genotyped parents to genotyped individuals. Includes call to <code>MakeAgePrior()</code>
to estimate <code>AgePriors</code> based on the just-assigned parents.</li>
<li><strong><code>'ped'</code></strong>: full pedigree reconstruction<br />
Cluster half- and full-siblings and assign each cluster a dummy-parent; assign grandparents to sibships and singletons.</li>
</ol>
<div id="sec:MaxSibIter" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> <code>MaxSibIter</code></h3>
<p>Up to sequoia version 2.0, <code>MaxSibIter</code> was used to switch between these options, with numeric values</p>
<ul>
<li><span class="math inline">\(-9\)</span> only input check<br />
</li>
<li><span class="math inline">\(-1\)</span> also check for duplicates<br />
</li>
<li><span class="math inline">\(0\)</span> also do parentage assignment<br />
</li>
<li><span class="math inline">\(x&gt;0\)</span> also do at most <span class="math inline">\(x\)</span> iterations of full pedigree reconstruction</li>
</ul>
<p>The maximum number of iterations was always only intended as a safety net in case the total likelihood did not stabilise, but this has not been an issue since sequoia version 1.0 (as far as I am aware). Even for large, complex datasets (several thousand individuals with considerable close inbreeding) the total likelihood plateaus in 10–15 iterations. From version 2.1 onward, <code>MaxSibIter</code><span class="math inline">\(=42\)</span>; if this number of iterations is reached it is a strong sign of problems with the data, e.g. that the SNPs are not informative enough to reconstruct the pedigree.</p>
</div>
</div>
<div id="input-check" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Input check</h2>
<p>SNP datasets are typically too large to easily spot any problems by simply looking at the data in a spreadsheet. There are many tools available to deal with genotype data and do proper quality control; the function <code>CheckGeno()</code> merely checks that the data are in the <a href="sec:GenoFormat">correct format</a> for <code>sequoia</code>, and that there are no SNPs or individuals with excessively many missing values.</p>
<p>The function <code>SnpStats()</code> can be used to count the number of Mendelian errors per SNP. It is not automatically called by <code>sequoia()</code>, but excluding SNPs with exceptionally high genotyping error rates is recommended to improve accuracy of the inferred pedigree.</p>
</div>
<div id="check-for-duplicates" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Check for duplicates</h2>
<p>The data may contain positive controls, as well as other intentional and unintentional duplicated samples, with or without life-history information. <code>sequoia()</code> searches the data for (near) identical genotypes, allowing for <code>MaxMismatchDUP</code> mismatches between the genotypes, which may or may not have the same individual ID. The threshold value depends on the presumed genotyping error rate, allele frequencies and number of SNPs, and is calculated by <code>CalcMaxMismatch()</code>.</p>
<p>Not all pairs flagged as potential duplicate genotypes are necessarily actual duplicates: inbred individuals may be nearly indistinguishable from their parent(s), especially when the number of SNPs is limited.</p>
<p>This check will also return a vector of individuals included in the genotype data, but not in the life history data (<code>NoLH</code>). This is merely a service to the user; individuals without life history information can often be successfully included in the pedigree.</p>
</div>
<div id="parentage-assignment" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Parentage assignment</h2>
<p>The number of pairs to be checked if they are parent and offspring is very large for even moderate numbers of individuals, e.g. 5,000 pairs for 100 individuals, and 2 million for 2,000 individuals. To speed up computation, three ‘sieves’ are applied sequentially to find candidate parent-offspring pairs, with decreasing ‘mesh size’</p>
<ul>
<li>The number of SNPs at which the pair are opposing homozygotes must be less than <code>MaxMismatchOH</code>;</li>
<li>The log10-likelihood ratio (LLR) between being parent and offspring versus unrelated, not conditioning on any already assigned parents, must be equal to or greater than <code>Tfilter</code>;</li>
<li>The LLR between the pair being parent and offspring versus being otherwise related, calculated conditional on all already assigned relatives, must be equal to or greater than <code>Tassign</code>. This step filters out siblings, grandparents and aunts/uncles.</li>
</ul>
<p>The older of the pair is assigned as parent of the younger. If it is unclear which is the older, or if it is unclear whether the parent is the mother or the father, no assignment is made, but these pairs can be found with <code>GetMaybeRel()</code> (see section <a href="#sec:maybepar">Likely relatives</a>). If there are multiple candidate parents of one or both (or unknown) sex(es), the parent pair or single parent resulting in the highest likelihood is assigned.</p>
<p>The heuristic sequential filtering approach makes parentage assignment quick, and usually takes only a few minutes, especially when setting <code>CalcLLR=FALSE</code> (do not re-calculate LLR parent-offspring vs next-most-likely relationship for all assigned parents, based on the final pedigree).</p>
</div>
<div id="ageprior-1" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> AgePrior</h2>
<p>The assigned parents are used to update the ageprior, before returning the results to the user of continuing with full pedigree reconstruction. Any arguments to <code>MakeAgePrior()</code> can be passed via <a href="sequoia-input.html#sec:custom-AP"><code>args.AP</code></a>. For example, you can specify the maximum age of dams and sires:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="running-sequoia.html#cb11-1" aria-hidden="true" tabindex="-1"></a>SeqOUT.B <span class="ot">&lt;-</span> <span class="fu">sequoia</span>(<span class="at">GenoM =</span> SimGeno_example, <span class="at">Err =</span> <span class="fl">0.005</span>,</span>
<span id="cb11-2"><a href="running-sequoia.html#cb11-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">LifeHistData =</span> LH_HSg5, <span class="at">Module=</span><span class="st">&quot;par&quot;</span>, <span class="at">Plot=</span><span class="cn">FALSE</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>,</span>
<span id="cb11-3"><a href="running-sequoia.html#cb11-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">args.AP =</span> <span class="fu">list</span>(<span class="at">MaxAgeParent =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">Smooth=</span><span class="cn">FALSE</span>))</span>
<span id="cb11-4"><a href="running-sequoia.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotAgePrior</span>(SeqOUT.B<span class="sc">$</span>AgePriors)</span></code></pre></div>
<p><img src="D:/figsAP-2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This way, even if sampled parents are all age 1, siblings sharing an unsampled parent may still have an age difference of 1 or 2 years, and grandparent – grand-offspring pairs may have an age difference of 2-6 years.</p>
</div>
<div id="full-reconstruction" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Full reconstruction</h2>
<p>During full pedigree reconstruction, assignment of all first and second degree links between all individuals is attempted, using the following steps within each iteration</p>
<ul>
<li>Find pairs of likely full- and half-siblings, using filtering steps with decreasing ‘mesh size’ similar to parentage assignment</li>
<li>Cluster potential sibling pairs into sibships</li>
<li>Find and assign grandparent – grand-offspring pairs (iteration 3+)</li>
<li>Merge existing sibships</li>
<li>Replace dummy parents by genotyped individuals</li>
<li>For individuals without parent(s), find candidate real and dummy parents, and assign parent(-pairs)</li>
<li>For sibships without grandparent(s), find candidate real and dummy grandparents, and assign grandparent(-pairs) (iteration 2+)</li>
</ul>
<p>The order of these steps, and the skipping of some steps in the first iteration(s), has been established by trial &amp; error to minimise false positive assignments while maximising correct assignments across a wide range of datasets. When running <code>sequoia()</code>, you can keep track of the progress through the various steps by setting <code>quiet = 'verbose'</code>.</p>
<p>Full pedigree reconstruction may take from a few seconds to several hours, depending on the number of individuals without an already assigned parent, the proportion of individuals with unknown sex or birth year, the number of sibships that is being clustered and their degree of interconnection, and the number of SNPs and their error rate. Generally computation is faster if the data is more complete and more accurate.</p>
<div id="dummy-individuals" class="section level3" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Dummy Individuals</h3>
<p>The ‘dummy’ parent assigned to each cluster of half-siblings is denoted by a 4-digit number with prefix <code>F</code> for females (<code>F0001</code>, <code>F0002</code>, …) and <code>M</code> for males (<code>M0001</code>, <code>M0002</code>, …). In the output, dummy individuals are appended at the bottom of the pedigree with their assigned parents, i.e. the sibship’s grandparents. In addition, all information for each dummy individual is given in dataframe <code>DummyIDs</code>, including its parents (again), its offspring, and the estimated birth year, as a point estimate (<code>BY.est</code>) and lower and upper bound of the 95% probability interval. This information is intended to make it easier to match dummy IDs to real IDs of observed but non-genotyped individuals (see also <a href="output-check.html#sec:compPed">Compare pedigrees</a>).</p>
</div>
<div id="total-likelihood" class="section level3" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Total likelihood</h3>
<p>The total likelihood provides a measure of how well the observed genotype data is explained by the currently inferred pedigree, the allele frequencies of the SNPs, the presumed genotyping error rate, and the assumption that founder genotypes were drawn from a genepool in Hardy-Weinberg equilibrium. It is always a negative number, and closer to zero indicates a better fit. When an asymptote is reached, typically in 5–10 iterations, either the algorithm is concluded (the default) or dependency on the age prior is increased (if <code>UseAge = 'extra'</code>) and the algorithm continues until a new asymptote is reached.</p>
<p>If you set <code>MaxSibIter</code> and there is a large change in value between the second-last and last likelihood of output element <code>TotLikSib</code>, consider running the algorithm for more iterations (increase <a href="running-sequoia.html#sec:MaxSibIter"><code>MaxSibIter</code></a>).</p>
</div>
</div>
<div id="save-output" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Save output</h2>
<p>There are various ways in which the output can be stored. This includes saving the seqoia list object, and optionally various other objects, in an <code>.RData</code> compressed file</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="running-sequoia.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(SeqList, LHdata, Geno, <span class="at">file=</span><span class="st">&quot;Sequoia_output_date.RData&quot;</span>)</span></code></pre></div>
<p>which can be read back into R at a later point</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="running-sequoia.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;Sequoia_output_date.RData&quot;</span>)</span>
<span id="cb13-2"><a href="running-sequoia.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;SeqList&#39; and &#39;LHdata&#39; will appear in R environment</span></span></code></pre></div>
<p>The advantage is that all data is stored and can easily be manipulated when recalled. The disadvantage is that the file is not human-readable, and (to my knowledge) can only be opened by R.</p>
<p>Alternatively, the various dataframes and list elements can each be written to a text file in a designated folder. This can be done using <code>write.table</code> or <code>write.csv</code>, or using the wrapper <code>writeSeq()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="running-sequoia.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeSeq</span>(SeqList, <span class="at">GenoM =</span> Geno, <span class="at">folder=</span><span class="fu">paste</span>(<span class="st">&quot;Sequoia_OUT&quot;</span>, <span class="fu">Sys.Date</span>()))</span></code></pre></div>
<p>The same function can also write the dataframes and list elements to an excel file (.xls or .xlsx), each to a separate sheet, using package <code>xlsx</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="running-sequoia.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeSeq</span>(SeqList, <span class="at">OutFormat=</span><span class="st">&quot;xls&quot;</span>, <span class="at">file=</span><span class="st">&quot;Sequoia_OUT.xlsx&quot;</span>)</span></code></pre></div>
<p>Note that ‘GenoM’ is ignored, as a very large genotype matrix may result in a file that is too large for excel to open. If you have a genotype matrix of modest size, you can add it to the same excel file:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="running-sequoia.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span>
<span id="cb16-2"><a href="running-sequoia.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(Geno, <span class="at">file =</span> <span class="st">&quot;Sequoia_OUT.xlsx&quot;</span>, <span class="at">sheetName=</span><span class="st">&quot;Genotypes&quot;</span>,</span>
<span id="cb16-3"><a href="running-sequoia.html#cb16-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names=</span><span class="cn">FALSE</span>, <span class="at">row.names=</span><span class="cn">TRUE</span>, <span class="at">append=</span><span class="cn">TRUE</span>, <span class="at">showNA=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>The option <code>append=TRUE</code> ensures that the sheet is appended to the file, rather than the file entirely overwritten.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sequoia-input.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="output-check.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
