# Sequoia  <img src="man/figures/sequoia_hexlogo.svg" align="right" height=250 style="vertical-align:middle;margin:0px 20px" /> 


#### Multi-generational pedigree reconstruction from SNP data. Accounting for genotyping errors. Overlapping or discrete generations, with or without inbreeding, any proportion of genotyped parents. No lists of candidate parents needed, just birth years.


<br> 

## What it can do

#### <img src="man/figures/parents.svg" width="100" height="70" /> Parentage assignment 
Candidate parent--offspring pairs are short-listed among all genotyped individuals based on the number of SNPs at which they are opposing homozygotes. Parents are assigned based on the likelihood ratio between the pair being parent--offspring versus the most-likely alternative relationship (see [key points](./articles/key_points.html#parent-llr)). The pair can be oriented if their relative age is known, or if there is a complementary co-parent.
<br>


#### <img src="man/figures/siblings.svg" width="100" height="80" /> Sibship clustering
When not all parents were genotyped, clusters of half- and full-siblings are identified, and each assigned a dummy parent. Every dummy individual corresponds to a real-world, non-genotyped individual.
<br>

#### <img src="man/figures/grandparents.svg" width="100" height="70" /> Grandparent assignment
For each cluster of half-siblings, grandparents are assigned where possible, i.e. parents of the sibship's dummy-parent. These grandparents may be dummy individuals themselves, so that parent-offspring links may be established between two non-genotyped individuals (provided each has genotyped offspring). 


<div>
<img src="man/figures/Dummies_for_dummies.svg" width="300" height="300" alt="pedigree example" />
</div>



## Package overview
Beside the main function for pedigree reconstruction (`sequoia()`), the R package also contains various functions to ensure the input data is in a suitable form, and to inspect the pedigree output (e.g. by comparing it to an older pedigree).

<a href="./reference/figures/flowchart.svg">
 <img src="man/figures/flowchart.svg" height="300" alt="flowchart" style="vertical-align:middle;margin:0px 20px" />
</a>
<br>
<br>
[print-friendly version](reference/figures/flowchart_no_bg.pdf)

<!--
![](man/figures/flowchart.svg) 
<br>
 --->

<br>
<br>

For detailed information, please see the vignettes (rendered using [bookdown](https://bookdown.org/yihui/bookdown/)):

<a href="./articles/vignette_main/_book/sec-Background.html">
 <img src="man/figures/sequoia_hexlogo_vignette_main.svg" height="150" alt="main vignette" style="vertical-align:middle;margin:0px 20px" />
</a>
<a href="./articles/vignette_age/_book/index.html">
 <img src="man/figures/sequoia_hexlogo_vignette_age.svg" height="150" alt="age vignette" style="vertical-align:middle;margin:0px 20px"/>
</a>
