<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate Genotypes — SimGeno • sequoia</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate Genotypes — SimGeno" />
<meta property="og:description" content="Simulate SNP genotype data from a pedigree, with optional
  missingess and errors." />
<meta property="og:image" content="/reference/figures/sequoia_hexlogo_s.png" />
<meta property="og:image:alt" content="sequoia hexlogo" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sequoia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Get_started.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manuals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/vignette_main/_book/sec-Background.html">Main vignette: User guide</a>
    </li>
    <li>
      <a href="../articles/vignette_age/_book/index.html">Age prior vignette</a>
    </li>
    <li>
      <a href="../articles/index.html">Examples</a>
    </li>
    <li>
      <a href="../articles/index.html">More info on ...</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a href="../articles/help.html">Help</a>
</li>
<li>
  <a href="../articles/_performance_stats.html">Stats</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/HuismanJisca">
    <span class="fab fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:jisca.huisman@gmail.com">
    <span class="fas fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/JiscaH/sequoia">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/jisca-huisman-a4751153/">
    <span class="fab fa-linkedin-in"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate Genotypes</h1>
    
    <div class="hidden name"><code>SimGeno.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate SNP genotype data from a pedigree, with optional
  missingess and errors.</p>
    </div>

    <pre class="usage"><span class='fu'>SimGeno</span><span class='op'>(</span>
  <span class='va'>Pedigree</span>,
  nSnp <span class='op'>=</span> <span class='fl'>400</span>,
  ParMis <span class='op'>=</span> <span class='fl'>0.4</span>,
  MAF <span class='op'>=</span> <span class='fl'>0.3</span>,
  CallRate <span class='op'>=</span> <span class='fl'>0.99</span>,
  SnpError <span class='op'>=</span> <span class='fl'>5e-04</span>,
  ErrorFM <span class='op'>=</span> <span class='st'>"version2.0"</span>,
  ReturnStats <span class='op'>=</span> <span class='cn'>FALSE</span>,
  OutFile <span class='op'>=</span> <span class='cn'>NA</span>,
  Inherit <span class='op'>=</span> <span class='st'>"autosomal"</span>,
  InheritFile <span class='op'>=</span> <span class='cn'>NA</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Pedigree</th>
      <td><p>dataframe, pedigree with the first three columns being id -
dam - sire. Column names are ignored, as are additional columns, with the
exception of a 'Sex' column when Inherit is not 'autosomal'.</p></td>
    </tr>
    <tr>
      <th>nSnp</th>
      <td><p>number of SNPs to simulate.</p></td>
    </tr>
    <tr>
      <th>ParMis</th>
      <td><p>single number or vector length two with proportion of parents
with fully missing genotype. Ignored if CallRate is a named vector.</p></td>
    </tr>
    <tr>
      <th>MAF</th>
      <td><p>minimum minor allele frequency, and allele frequencies will be
sampled uniformly between this minimum and 0.5, OR a vector with minor
allele frequency at each locus. In both cases, this is the MAF among
pedigree founders, the MAF in the sample will deviate due to drift.</p></td>
    </tr>
    <tr>
      <th>CallRate</th>
      <td><p>either a single number for the mean call rate (genotyping
success), OR a vector with the call rate at each SNP, OR a named vector
with the call rate for each individual. In the third case, ParMis is
ignored, and individuals in the pedigree (as id or parent) not included in
this vector are presumed non-genotyped.</p></td>
    </tr>
    <tr>
      <th>SnpError</th>
      <td><p>mean per-locus genotyping error rate across SNPs, and a
beta-distribution will be used to simulate the number of missing cases per
SNP, OR a vector with the genotyping error for each SNP.</p></td>
    </tr>
    <tr>
      <th>ErrorFM</th>
      <td><p>function taking the error rate (scalar) as argument and
returning a 3x3 matrix with probabilities that actual genotype i (rows) is
observed as genotype j (columns). Inbuilt ones are as used in sequoia
'version2.0', 'version1.3', or 'version1.1'. See details.</p></td>
    </tr>
    <tr>
      <th>ReturnStats</th>
      <td><p>in addition to the genotype matrix, return the input
parameters and mean &amp; quantiles of MAF, error rate and call rates.</p></td>
    </tr>
    <tr>
      <th>OutFile</th>
      <td><p>file name for simulated genotypes. If NA (default), return
results within R.</p></td>
    </tr>
    <tr>
      <th>Inherit</th>
      <td><p>inheritance pattern, scalar or vector of length nSnp,
Defaults to 'autosomal'. An excel file included in the package has
inheritance patterns for the X and Y chromosome and mtDNA, and allows
custom inheritance patterns. Note that these are experimental, and NOT
currently supported by the pedigree reconstruction with
<code><a href='sequoia.html'>sequoia</a></code> !</p></td>
    </tr>
    <tr>
      <th>InheritFile</th>
      <td><p>file name of file with inheritance patterns, with
extension csv, txt, xls or xlsx (the latter two require library xlsx).</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>suppress messages.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>ReturnStats=FALSE</code> (the default), a matrix with genotype
  data in sequoia's input format, encoded as 0/1/2/-9.</p>
<p>If <code>ReturnStats=TRUE</code>, a named list with three elements: list
  'ParamsIN', matrix 'SGeno', and list 'StatsOUT':</p>
<dt>AF</dt><dd><p>Frequency in 'observed' genotypes of '1' allele</p></dd>
  <dt>AF.act</dt><dd><p>Allele frequency in 'actual' (without genotyping errors &amp;
    missingness)</p></dd>
  <dt>SnpError</dt><dd><p>Error rate per SNP (actual /= observed AND observed /=
    missing)</p></dd>
  <dt>SnpCallRate</dt><dd><p>Non-missing per SNP</p></dd>
  <dt>IndivError</dt><dd><p>Error rate per individual</p></dd>
  <dt>IndivCallRate</dt><dd><p>Non-missing per individual</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Please ensure the pedigree is a valid pedigree, for example by first
  running <code><a href='PedPolish.html'>PedPolish</a></code>. For founders, i.e. individuals with no
  known parents, genotypes are drawn according to the provided MAF and
  assuming Hardy-Weinberg equilibrium. Offspring genotypes are generated
  following Mendelian inheritance, assuming all loci are completely
  independent. Individuals with one known parent are allowed: at each locus,
  one allele is inherited from the known parent, and the other drawn from the
  genepool according to the provided MAF.</p>
<p>Genotyping errors are generated following a user-definable 3x3 matrix with
  probabilities that actual genotype \(i\) (rows) is observed as genotype
  \(j\) (columns). This is specified as <code>ErrorFM</code>, which is a function
  of <code>SnpError</code>. By default (<code>ErrorFM</code> = "version2.0"),
  <code>SnpError</code> is interpreted as a locus-level error rate (rather than
  allele-level), and equals the probability that a homozygote is observed as
  heterozygote, and the probability that a heterozygote is observed as either
  homozygote (i.e., the probability that it is observed as AA = probability
  that observed as aa = <code>SnpError</code>/2). The probability that one
  homozygote is observed as the other is (<code>SnpError</code>/2\()^2\).</p>
<p>Note that this differs from versions up to 1.1.1, where a proportion of
  <code>SnpError</code>*3/2 of genotypes were replaced with random genotypes. This
  corresponds to <code>ErrorFM</code> = "Version111".</p>
<p>Error rates differ between SNPs, but the same error pattern is used across
  all SNPs, even when inheritance patterns vary. When two or more different
  error patterns are required, SimGeno should be run on the different SNP
  subsets separately, and results combined.</p>
<p>Variation in call rates is assumed to follow a highly skewed (beta)
  distribution, with many samples having call rates close to 1, and a
  narrowing tail of lower call rates. The first shape parameter defaults to 1
  (but see <code><a href='MkGenoErrors.html'>MkGenoErrors</a></code>), and the second shape parameter is
  defined via the mean as <code>CallRate</code>. For 99.9% of SNPs to have a call
  rate of 0.8 (0.9; 0.95) or higher, use a mean call rate of 0.969 (0.985;
  0.993).</p>
<p>Variation in call rate between samples can be specified by providing a
  named vector to <code>CallRate</code>, which supersedes PropLQ in versions up to
  1.1.1. Otherwise, variation in call rate and error rate between samples
  occurs only as side-effect of the random nature of which individuals are
  hit by per-SNP errors and drop-outs. Finer control is possible by first
  generating an error-free genotype matrix, and then calling
  <code><a href='MkGenoErrors.html'>MkGenoErrors</a></code> directly on subsets of the matrix.</p>
    <h2 class="hasAnchor" id="disclaimer"><a class="anchor" href="#disclaimer"></a>Disclaimer</h2>

    <p>This simulation is highly simplistic and assumes that
  all SNPs segregate completely independently, that the SNPs are in
  Hardy-Weinberg equilibrium in the pedigree founders. It assumes that
  genotyping errors are not due to heritable mutations of the SNPs, and that
  missingness is random and not e.g. due to heritable mutations of SNP
  flanking regions. Results based on this simulated data will provide an
  minimum estimate of the number of SNPs required, and an optimistic estimate
  of pedigree reconstruction performance.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The wrapper <code><a href='EstConf.html'>EstConf</a></code> for repeated simulation and
  pedigree reconstruction; <code><a href='MkGenoErrors.html'>MkGenoErrors</a></code> for fine control over
  the distribution of genotyping errors in simulated data.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jisca Huisman, <a href='mailto:jisca.huisman@gmail.com'>jisca.huisman@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>Ped_HSg5</span><span class='op'>)</span>
<span class='va'>GenoM</span> <span class='op'>&lt;-</span> <span class='fu'>SimGeno</span><span class='op'>(</span>Pedigree <span class='op'>=</span> <span class='va'>Ped_HSg5</span>, nSnp <span class='op'>=</span> <span class='fl'>100</span>, ParMis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.7</span><span class='op'>)</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># Alternative genotyping error model</span>
<span class='va'>EFM</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>E</span><span class='op'>)</span> <span class='op'>{</span>   <span class='co'># Whalen, Gorjanc &amp; Hickey 2018</span>
 <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>E</span><span class='op'>*</span><span class='fl'>3</span><span class='op'>/</span><span class='fl'>4</span>, <span class='va'>E</span><span class='op'>/</span><span class='fl'>4</span>, <span class='va'>E</span><span class='op'>/</span><span class='fl'>4</span>,
          <span class='va'>E</span><span class='op'>/</span><span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>-</span><span class='va'>E</span><span class='op'>/</span><span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>-</span><span class='va'>E</span><span class='op'>/</span><span class='fl'>4</span>, <span class='va'>E</span><span class='op'>/</span><span class='fl'>4</span>,
          <span class='va'>E</span><span class='op'>/</span><span class='fl'>4</span>, <span class='va'>E</span><span class='op'>/</span><span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>-</span><span class='va'>E</span><span class='op'>*</span><span class='fl'>3</span><span class='op'>/</span><span class='fl'>4</span><span class='op'>)</span>,
          <span class='fl'>3</span>,<span class='fl'>3</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>  <span class='op'>}</span>
<span class='fu'>EFM</span><span class='op'>(</span><span class='fl'>0.01</span><span class='op'>)</span>
<span class='va'>GenoM</span> <span class='op'>&lt;-</span> <span class='fu'>SimGeno</span><span class='op'>(</span>Pedigree <span class='op'>=</span> <span class='va'>Ped_HSg5</span>, nSnp <span class='op'>=</span> <span class='fl'>100</span>, ParMis <span class='op'>=</span> <span class='fl'>0.2</span>,
 SnpError <span class='op'>=</span> <span class='fl'>5e-3</span>, ErrorFM <span class='op'>=</span> <span class='va'>EFM</span><span class='op'>)</span>

<span class='co'># combination of high &amp; low quality SNPs</span>
<span class='va'>Geno.HQ</span> <span class='op'>&lt;-</span> <span class='fu'>SimGeno</span><span class='op'>(</span><span class='va'>Ped_HSg5</span>, nSnp<span class='op'>=</span><span class='fl'>50</span>, MAF<span class='op'>=</span><span class='fl'>0.3</span>, CallRate<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>0.7</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Geno.LQ</span> <span class='op'>&lt;-</span> <span class='fu'>SimGeno</span><span class='op'>(</span><span class='va'>Ped_HSg5</span>, nSnp<span class='op'>=</span><span class='fl'>20</span>, MAF<span class='op'>=</span><span class='fl'>0.1</span>, CallRate<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>0.1</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Geno.HQLQ</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span><span class='op'>(</span><span class='va'>Geno.HQ</span>, <span class='va'>Geno.LQ</span>, by<span class='op'>=</span><span class='st'>"row.names"</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jisca Huisman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


