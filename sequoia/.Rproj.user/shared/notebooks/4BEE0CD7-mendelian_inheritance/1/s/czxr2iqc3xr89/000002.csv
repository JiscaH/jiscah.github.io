"0","# example values"
"0","q <- 0.4   # allele frequency"
"0","E <- 0.01  # genotyping error rate"
"0",""
"0","# 1. probabilities of actual genotypes under HWE (0, 1 or 2 copies of reference allele)"
"0","AHWE <- c((1-q)^2, 2*q*(1-q), q^2)"
"0",""
"0","# 2 + 4. probability of observed genotype (columns) conditional on actual genotype (rows) "
"0","ErrM <- sequoia::ErrToM(Err = E, flavour=""version2.0"", Return=""matrix"")"
"0","ErrM"
"1","     "
"1"," obs-0|act"
"1"," obs-1|act"
"1"," obs-2|act"
"1","
act-0"
"1","  0.990025"
"1","   0.00995"
"1","  0.000025"
"1","
act-1"
"1","  0.005000"
"1","   0.99000"
"1","  0.005000"
"1","
act-2"
"1","  0.000025"
"1","   0.00995"
"1","  0.990025"
"1","
"
"0","# 3. probability that offspring actual genotype is 0/1/2 (rows) given "
"0","#    parent actual genotype is 0/1/2 (columns). "
"0","# (Transposed relative to Table 3)"
"0","AKAP <- matrix(c(1-q, (1-q)/2, 0,"
"0","                 q,   1/2,     1-q,"
"0","                 0,   q/2,     q), "
"0","                 nrow=3, byrow=TRUE)"
"0","                 "
"0","# joined probability actual genotypes: (1. x 3.)"
"0","P.AA <- sweep(AKAP, 2, AHWE, ""*"")"
"0","dimnames(P.AA) <- list(0:2, 0:2)"
"0","P.AA"
"1"," "
"1","     0"
"1","     1"
"1","     2"
"1","
0"
"1"," 0.216"
"1"," 0.144"
"1"," 0.000"
"1","
1"
"1"," 0.144"
"1"," 0.240"
"1"," 0.096"
"1","
2"
"1"," 0.000"
"1"," 0.096"
"1"," 0.064"
"1","
"
"0","# joined probability observed genotypes: (2. x (1. x 3.) x 4.)"
"0","P.OO <- t(ErrM) %*% P.AA %*% ErrM"
"0","dimnames(P.OO) <- list(0:2, 0:2)"
"0","round(P.OO, 4)"
"1"," "
"1","      0"
"1","      1"
"1","      2"
"1","
0"
"1"," 0.2131"
"1"," 0.1445"
"1"," 0.0012"
"1","
1"
"1"," 0.1445"
"1"," 0.2400"
"1"," 0.0959"
"1","
2"
"1"," 0.0012"
"1"," 0.0959"
"1"," 0.0637"
"1","
"
"0","P.Mismatch <- P.OO[1,3] + P.OO[3,1]"
"0","P.Mismatch"
"1","[1]"
"1"," 0.00240198"
"1","
"
