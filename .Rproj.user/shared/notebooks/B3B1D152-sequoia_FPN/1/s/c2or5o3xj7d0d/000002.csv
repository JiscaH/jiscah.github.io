"0","# vector with discrete values of R, the proportion of referenced individuals "
"0","RR <- seq(0, 1, by=0.005)"
"0","# threshold probability to have zero referenced individuals in the product sample"
"0","AA <- 10^-c(1:4)"
"0",""
"0","# function to calculate "
"0","# Y: the probability to have zero referenced individuals in the sample, "
"0","#    given a proportion R, for a large range of sample sizes N"
"0","# and from this the minimum N at which Y <= alpha"
"0","Calc.N.required <- function(R, alpha, MaxN=1000) {"
"0","  Y <- dbinom(x=0, seq.int(1,MaxN), prob=R)"
"0","  ifelse(any(Y <= alpha), min(which(Y <= alpha)), NA)"
"0","}"
"0",""
"0","# run this function for a large number of combinations of R and alpha"
"0","N.required <- matrix(NA, length(RR), length(AA),"
"0","                     dimnames = list(RR, AA))"
"0","for (i in 1:4) {"
"0","  N.required[, i] <- sapply(RR, Calc.N.required, alpha=AA[i])"
"0","}"
