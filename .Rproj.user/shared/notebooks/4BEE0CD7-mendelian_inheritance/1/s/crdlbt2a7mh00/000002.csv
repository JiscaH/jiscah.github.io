"0","# define function to count no. opposing homozygous loci in two vectors x and y"
"0","CountOH <- function(x, y)  sum((x==2 & y==0) | (x==0 & y==2))"
"0",""
"0","# apply this function all possible pairs "
"0","N <- nrow(Geno.highQ)  # no. individuals"
"0","OH.highQ <- matrix(NA, N, N)  # matrix for output"
"0","OH.lowQ <- matrix(NA, N, N)"
"0","# do upper triangle of matrix only, excluding diagonal (self)"
"0","for (i in seq(1, N-1)) {"
"0","  for (j in seq(i+1, N)) {"
"0","    OH.highQ[i,j] <- CountOH(Geno.highQ[i,], Geno.highQ[j,])"
"0","    OH.lowQ[i,j] <- CountOH(Geno.lowQ[i,], Geno.lowQ[j,])"
"0","  }"
"0","}"
"0",""
"0","# plot histograms"
"0","par(mfcol=c(1,2), mai=c(.9,.9,.5,.6))"
"0","hist(OH.highQ, breaks=50, xlab=""No. SNPs opposing homozygous"","
"0","     main=""High quality:\n 500 SNPs, error rate 0.01%"")"
